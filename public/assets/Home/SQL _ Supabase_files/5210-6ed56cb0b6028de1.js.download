!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7460dad6-b745-4690-8978-6b6e5963249c",e._sentryDebugIdIdentifier="sentry-dbid-7460dad6-b745-4690-8978-6b6e5963249c")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5210],{27850:function(e,t,n){n.d(t,{NK:function(){return m},Tf:function(){return f},Yb:function(){return u},cc:function(){return c},rg:function(){return d},x4:function(){return p}});var r=n(12832),a=n(6494),l=n.n(a),o=n(89199),s=n(94092),i=n(56813);function c(e){let{editable:t}=e;return t?e:{...e,onAddColumn:void 0,onAddRow:void 0,onEditColumn:void 0,onDeleteColumn:void 0,onEditRow:void 0}}function d(e,t){return Array.isArray(t)?l()(t.map(t=>{let[n,r]=t.split(":");if(n&&r)return{table:e,column:n,ascending:"asc"===r}})):[]}function u(e){return Array.isArray(e)?e.map(e=>{let[t,n,...r]=e.split(":"),a=r.join(":"),l=s.o.find(e=>e.abbrev===n);if(t&&n&&l)return{column:t,operator:l.value,value:a||""}}).filter(e=>void 0!==e):[]}function m(e){let t=e.columns,n=(0,o.N3)(e)?e.primary_keys:[],r=(0,o.N3)(e)?e.relationships:[],a=t.map(e=>{let t={position:e.ordinal_position,name:e.name,defaultValue:e.default_value,dataType:e.data_type,format:e.format,isPrimaryKey:!1,isIdentity:e.is_identity,isGeneratable:"BY DEFAULT"==e.identity_generation,isNullable:e.is_nullable,isUpdatable:e.is_updatable,enum:e.enums,comment:e.comment,foreignKey:{targetTableSchema:null,targetTableName:null,targetColumnName:null,deletionAction:void 0,updateAction:void 0}},a=n.find(t=>t.name==e.name);t.isPrimaryKey=!!a;let l=r.find(t=>t.source_schema===e.schema&&t.source_table_name===e.table&&t.source_column_name===e.name);return l&&(t.foreignKey.targetTableSchema=l.target_table_schema,t.foreignKey.targetTableName=l.target_table_name,t.foreignKey.targetColumnName=l.target_column_name,t.foreignKey.deletionAction=l.deletion_action,t.foreignKey.updateAction=l.update_action),t});return{id:e.id,name:e.name,comment:e.comment,schema:e.schema,columns:a,estimateRowCount:(0,o.N3)(e)?e.live_rows_estimate:0}}let f=(0,r.Z)(function(e,t,n,r){let a;if(!e.table)return;let l={gridColumns:e.gridColumns,...void 0!==n&&{sorts:n},...void 0!==r&&{filters:r}},o=p(i.E_,t),s=localStorage.getItem(o),{name:c,schema:d}=e.table,u=d&&"public"!=d?"".concat(d,".").concat(c):c;a=s?{...a=JSON.parse(s),[u]:l}:{[u]:l},localStorage.setItem(o,JSON.stringify(a))},500);function p(e,t){return"".concat(e,"_").concat(t)}},94092:function(e,t,n){n.d(t,{o:function(){return r}});let r=[{value:"=",label:"equals",preLabel:"[ = ]",abbrev:"eq"},{value:"<>",label:"not equal",preLabel:"[ <> ]",abbrev:"neq"},{value:">",label:"greater than",preLabel:"[ > ]",abbrev:"gt"},{value:"<",label:"less than",preLabel:"[ < ]",abbrev:"lt"},{value:">=",label:"greater than or equal",preLabel:"[ >= ]",abbrev:"gte"},{value:"<=",label:"less than or equal",preLabel:"[ <= ]",abbrev:"lte"},{value:"~~",label:"like operator",preLabel:"[ ~~ ]",abbrev:"like"},{value:"~~*",label:"ilike operator",preLabel:"[ ~~* ]",abbrev:"ilike"},{value:"in",label:"one of a list of values",preLabel:"[ in ]",abbrev:"in"},{value:"is",label:"checking for (null,not null,true,false)",preLabel:"[ is ]",abbrev:"is"}]},18669:function(e,t,n){n.d(t,{f:function(){return j}});var r=n(97458),a=n(58724),l=n.n(a),o=n(85466),s=n.n(o),i=n(26056),c=n(98601),d=n(52983),u=n(27850),m=n(53365),f=n(42026),p=n(90839),h=n(71042),x=n(98686),g=n(17751),y=n(37555),v=n(30739),b=(0,d.memo)(e=>{let{table:t,index:n,columnName:a,sort:l,onDelete:o,onToggle:s,onDrag:i}=e,c=t.columns.find(e=>e.name===a),u=(0,d.useRef)(null),[{isDragging:m},f]=(0,g.c)({type:"sort-row",item:()=>({key:a,index:n}),collect:e=>({isDragging:e.isDragging()})}),[{handlerId:b},j]=(0,y.L)({accept:"sort-row",collect:e=>({handlerId:e.getHandlerId()}),hover(e,t){var r;if(!u.current)return;let a=e.index;if(a===n)return;let l=null===(r=u.current)||void 0===r?void 0:r.getBoundingClientRect(),o=(l.bottom-l.top)/2,s=t.getClientOffset().y-l.top;a<n&&s<o||a>n&&s>o||(_(a,n),e.index=n)}}),_=(e,t)=>{e!=t&&i(e,t)};return(f(j(u)),c)?(0,r.jsxs)("div",{className:"flex items-center gap-3 px-3",ref:u,style:{opacity:m?0:1},"data-handler-id":b,"data-sentry-component":"SortRow","data-sentry-source-file":"SortRow.tsx",children:[(0,r.jsx)("span",{className:"transition-color text-foreground-lighter hover:text-foreground-light",children:(0,r.jsx)(h.Z,{strokeWidth:2,size:16,"data-sentry-element":"Menu","data-sentry-source-file":"SortRow.tsx"})}),(0,r.jsx)("div",{className:"grow",children:(0,r.jsxs)("span",{className:"flex grow items-center gap-1 truncate text-sm text-foreground",children:[(0,r.jsx)("span",{className:"text-xs text-foreground-lighter",children:n>0?"then by":"sort by"}),c.name]})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("label",{className:"text-xs text-foreground-lighter",children:"ascending:"}),(0,r.jsx)(v.Z,{size:"tiny",layout:"flex",defaultChecked:l.ascending,onChange:e=>s(a,e),"data-sentry-element":"Toggle","data-sentry-source-file":"SortRow.tsx"})]}),(0,r.jsx)(p.z,{icon:(0,r.jsx)(x.Z,{strokeWidth:1.5}),size:"tiny",type:"text",onClick:()=>o(a),"data-sentry-element":"Button","data-sentry-source-file":"SortRow.tsx"})]}):null}),j=e=>{let{table:t,sorts:n,setParams:a}=e,[l,o]=(0,d.useState)(!1),s=(n||[]).length>0?"Sorted by ".concat(n.length," rule").concat(n.length>1?"s":""):"Sort";return(0,r.jsxs)(f.J2,{modal:!1,open:l,onOpenChange:o,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"SortPopover","data-sentry-source-file":"SortPopover.tsx",children:[(0,r.jsx)(f.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"SortPopover.tsx",children:(0,r.jsx)(p.z,{type:(n||[]).length>0?"link":"text",icon:(0,r.jsx)(i.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"SortPopover.tsx",children:s})}),(0,r.jsx)(f.yk,{className:"p-0 w-96",side:"bottom",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"SortPopover.tsx",children:(0,r.jsx)(_,{table:t,sorts:n,onApplySorts:e=>{a(t=>({...t,sort:e.map(e=>"".concat(e.column,":").concat(e.ascending?"asc":"desc"))}))},"data-sentry-element":"SortOverlay","data-sentry-source-file":"SortPopover.tsx"})})]})};let _=e=>{let{table:t,sorts:n,onApplySorts:a}=e,o=(0,d.useMemo)(()=>(0,u.rg)(t.name,null!=n?n:[]),[t.name,n]),[i,h]=(0,d.useState)(o),x=t.columns.filter(e=>"json"!==e.dataType&&"jsonb"!==e.dataType&&!i.find(t=>t.column==e.name)),g=(null==x?void 0:x.map(e=>({value:e.name,label:e.name})))||[],y=(0,d.useCallback)(e=>{h(t=>t.filter(t=>t.column!==e))},[]),v=(0,d.useCallback)((e,t)=>{h(n=>{let r=n.findIndex(t=>t.column===e);return l()(n,{[r]:{$merge:{ascending:t}}})})},[]),j=(0,d.useCallback)((e,t)=>{h(n=>l()(n,{$splice:[[e,1],[t,0,n[e]]]}))},[]);return(0,r.jsxs)("div",{className:"space-y-2 py-2","data-sentry-component":"SortOverlay","data-sentry-source-file":"SortPopover.tsx",children:[i.map((e,n)=>(0,r.jsx)(b,{table:t,index:n,columnName:e.column,sort:e,onDelete:y,onToggle:v,onDrag:j},e.column)),0===i.length&&(0,r.jsxs)("div",{className:"space-y-1 px-3",children:[(0,r.jsx)("h5",{className:"text-sm text-foreground-light",children:"No sorts applied to this view"}),(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Add a column below to sort the view"})]}),(0,r.jsx)(f.Fm,{"data-sentry-element":"PopoverSeparator_Shadcn_","data-sentry-source-file":"SortPopover.tsx"}),(0,r.jsxs)("div",{className:"px-3 flex flex-row justify-between",children:[x&&x.length>0?(0,r.jsx)(m.F,{options:g,onSelect:function(e){h([...i,{table:t.name,column:e,ascending:!0}])},side:"bottom",align:"start",children:(0,r.jsx)(p.z,{asChild:!0,type:"text",iconRight:(0,r.jsx)(c.Z,{size:"14",className:"text-foreground-light"}),className:"sb-grid-dropdown__item-trigger","data-testid":"table-editor-pick-column-to-sort-button",children:(0,r.jsxs)("span",{children:["Pick ",i.length>1?"another":"a"," column to sort by"]})})}):(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"All columns have been added"}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(p.z,{disabled:s()(i,o),type:"default",onClick:()=>a(i),"data-sentry-element":"Button","data-sentry-source-file":"SortPopover.tsx",children:"Apply sorting"})})]})]})}},8836:function(e,t,n){n.d(t,{ov:function(){return p},ep:function(){return j},q4:function(){return b}});var r=n(97458),a=n(3977),l=n(61379),o=n(11024),s=n(74304),i=n(98601),c=n(40577),d=n(14500),u=n(11221),m=n(90839),f=n(98495),p=e=>{let{column:t,isEncrypted:n}=e,p=(0,f.Qq)(),h=(0,f.I0)(),{onEditColumn:x,onDeleteColumn:g}=p,y=t.key;function v(){x&&x(y)}function b(){g&&g(y)}return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(d.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"ColumnMenu.tsx",children:[(0,r.jsx)(d.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"ColumnMenu.tsx",children:(0,r.jsx)(m.z,{className:"opacity-50 flex",type:"text",style:{padding:"3px"},icon:(0,r.jsx)(i.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"ColumnMenu.tsx"})}),(0,r.jsx)(d.AW,{align:"end",side:"bottom","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"ColumnMenu.tsx",children:(0,r.jsxs)(r.Fragment,{children:[p.editable&&void 0!==v&&(0,r.jsxs)(c.u,{children:[(0,r.jsx)(c.aJ,{asChild:!0,className:"".concat(n?"opacity-50":""),children:(0,r.jsxs)(d.Xi,{className:"space-x-2",onClick:v,disabled:n,children:[(0,r.jsx)(a.Z,{size:14}),(0,r.jsx)("p",{children:"Edit column"})]})}),n&&(0,r.jsx)(c._v,{side:"bottom",children:"Encrypted columns cannot be edited"})]}),(0,r.jsx)(d.Xi,{className:"space-x-2",onClick:t.frozen?function(){h({type:"UNFREEZE_COLUMN",payload:{columnKey:y}})}:function(){h({type:"FREEZE_COLUMN",payload:{columnKey:y}})},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"ColumnMenu.tsx",children:t.frozen?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{size:14}),(0,r.jsx)("p",{children:"Unfreeze column"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{size:14}),(0,r.jsx)("p",{children:"Freeze column"})]})}),p.editable&&void 0!==b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{}),(0,r.jsxs)(d.Xi,{className:"space-x-2",onClick:b,children:[(0,r.jsx)(s.Z,{size:14,stroke:"red"}),(0,r.jsx)("p",{children:"Delete column"})]})]})]})})]})})},h=n(57304),x=n(52983),g=n(70717),y=n(96226),v=n(54775),b=e=>{let{rows:t}=e,n=(0,f.Qq)(),l=(0,y._2)();function o(e){let{data:t}=e;return"edit"===t?void 0==n.onEditRow:"delete"===t&&!n.editable}let i=(0,x.useCallback)(e=>{var r;let{props:a}=e;if(!n.selectedCellPosition||!a)return;let{rowIdx:l}=a,o=t[l][n.gridColumns[null===(r=n.selectedCellPosition)||void 0===r?void 0:r.idx].key],s=(0,v.Lw)(o);(0,v.vQ)(s)},[t,n.gridColumns,n.selectedCellPosition]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(g.v2,{id:j,animation:!1,"data-sentry-element":"Menu","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsxs)(g.ck,{onClick:i,"data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsx)(h.Z,{size:14,"data-sentry-element":"Clipboard","data-sentry-source-file":"RowContextMenu.tsx"}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Copy cell content"})]}),(0,r.jsxs)(g.ck,{onClick:function(e){let{props:r}=e,{rowIdx:a}=r,l=t[a];n.onEditRow&&n.onEditRow(l)},hidden:o,data:"edit","data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsx)(a.Z,{size:14,"data-sentry-element":"Edit","data-sentry-source-file":"RowContextMenu.tsx"}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Edit row"})]}),n.editable&&(0,r.jsx)(g.Z0,{}),(0,r.jsxs)(g.ck,{onClick:function(e){let{props:n}=e,{rowIdx:r}=n,a=t[r];a&&l.onDeleteRows([a])},hidden:o,data:"delete","data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsx)(s.Z,{size:14,stroke:"red","data-sentry-element":"Trash","data-sentry-source-file":"RowContextMenu.tsx"}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Delete row"})]})]})})};let j="row-context-menu-id"},56813:function(e,t,n){n.d(t,{E_:function(){return a},Vz:function(){return l},W:function(){return s},ZR:function(){return o},mr:function(){return r},uZ:function(){return i}});let r=100,a="supabase_grid",l=-1,o=-2,s="supabase-grid-select-row",i="supabase-grid-add-column"},65051:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(98219),a=n(89140);function l(e,t){return 0===t.length?e:e+=" where ".concat(t.map(e=>{switch(e.operator){case"in":let t;return t=Array.isArray(e.value)?e.value.map(e=>o(e)):String(e.value).split(",").map(e=>o(e)),"".concat((0,a.yR)(e.column)," ").concat(e.operator," (").concat(t.join(","),")");case"is":return function(e){let t=String(e.value);switch(t){case"null":case"false":case"true":case"not null":return"".concat((0,a.yR)(e.column)," ").concat(e.operator," ").concat(t);default:return"".concat((0,a.yR)(e.column)," ").concat(e.operator," ").concat(o(e.value))}}(e);default:return"".concat((0,a.yR)(e.column)," ").concat(e.operator," ").concat(o(e.value))}}).join(" and "))}function o(e){return"string"!=typeof e||(null==e?void 0:e.startsWith("ARRAY["))&&(null==e?void 0:e.endsWith("]"))?e:(0,a.i0)(e)}function s(e){return"".concat((0,a.yR)(e.schema),".").concat((0,a.yR)(e.name))}class i{range(e,t){return this.pagination={offset:e,limit:t-e+1},this}toSql(){try{var e;let{actionValue:t,actionOptions:n,filters:r,sorts:o}=null!==(e=this.options)&&void 0!==e?e:{};switch(this.action){case"count":return function(e,t){let n="select count(*) from ".concat(s(e)),{filters:r}=null!=t?t:{};return r&&(n=l(n,r)),n+";"}(this.table,{filters:r});case"delete":return function(e,t,n){if(!t||0===t.length)throw{message:"no filters for this delete query"};let r="delete from ".concat(s(e)),{returning:a,enumArrayColumns:o}=null!=n?n:{};return t&&(r=l(r,t)),a&&(r+=void 0===o||0===o.length?" returning *":" returning *, ".concat(o.map(e=>'"'.concat(e,'"::text[]')).join(","))),r+";"}(this.table,r,{returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"insert":return function(e,t,n){if(!t||0===t.length)throw{message:"no value to insert"};let{returning:r,enumArrayColumns:l}=null!=n?n:{},o=Object.keys(t[0]).map(e=>(0,a.yR)(e)).join(","),i="";return i=0==o.length?(0,a.WU)("insert into %1$s select from jsonb_populate_recordset(null::%1$s, %2$s)",s(e),(0,a.i0)(JSON.stringify(t))):(0,a.WU)("insert into %1$s (%2$s) select %2$s from jsonb_populate_recordset(null::%1$s, %3$s)",s(e),o,(0,a.i0)(JSON.stringify(t))),r&&(i+=void 0===l||0===l.length?" returning *":" returning *, ".concat(l.map(e=>'"'.concat(e,'"::text[]')).join(","))),i+";"}(this.table,t,{returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"select":return function(e,t,n){var r;let o="";o+="select ".concat(null!=t?t:"*"," from ").concat(s(e));let{filters:i,pagination:c,sorts:d}=null!=n?n:{};if(i&&(o=l(o,i)),d&&(r=o,o=0===d.length?r:r+=" order by ".concat(d.map(e=>{if(!e.column)return null;let t=e.ascending?"asc":"desc",n=e.nullsFirst?"nulls first":"nulls last";return"".concat((0,a.yR)(e.table),".").concat((0,a.yR)(e.column)," ").concat(t," ").concat(n)}).join(", "))),c){let{limit:e,offset:t}=null!=c?c:{};o+=" limit ".concat((0,a.i0)(e)," offset ").concat((0,a.i0)(t))}return o+";"}(this.table,t,{filters:r,pagination:this.pagination,sorts:o});case"update":return function(e,t,n){let{filters:r,returning:o,enumArrayColumns:i}=null!=n?n:{};if(!r||0===r.length)throw{message:"no filters for this update query"};let c=Object.keys(t).map(e=>(0,a.yR)(e)).join(","),d=(0,a.WU)("update %1$s set (%2$s) = (select %2$s from json_populate_record(null::%1$s, %3$s))",s(e),c,(0,a.i0)(JSON.stringify(t)));return r&&(d=l(d,r)),o&&(d+=void 0===i||0===i.length?" returning *":" returning *, ".concat(i.map(e=>'"'.concat(e,'"::text[]')).join(","))),d+";"}(this.table,t,{filters:r,returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"truncate":return function(e,t){let n="truncate ".concat(s(e)),{cascade:r}=null!=t?t:{};return r&&(n+=" cascade"),n+";"}(this.table,{cascade:null==n?void 0:n.cascade});default:return""}}catch(e){throw e}}constructor(e,t,n){(0,r._)(this,"table",void 0),(0,r._)(this,"action",void 0),(0,r._)(this,"options",void 0),(0,r._)(this,"pagination",void 0),this.table=e,this.action=t,this.options=n}}class c{filter(e,t,n){return this.filters.push({column:e,operator:t,value:n}),this}match(e){return Object.entries(e).map(e=>{let[t,n]=e;this.filters.push({column:t,operator:"=",value:n})}),this}order(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.sorts.push({table:e,column:t,ascending:n,nullsFirst:r}),this}range(e,t){return this._getQueryModifier().range(e,t)}toSql(){return this._getQueryModifier().toSql()}_getQueryModifier(){return new i(this.table,this.action,{actionValue:this.actionValue,actionOptions:this.actionOptions,filters:this.filters,sorts:this.sorts})}constructor(e,t,n,a){(0,r._)(this,"table",void 0),(0,r._)(this,"action",void 0),(0,r._)(this,"actionValue",void 0),(0,r._)(this,"actionOptions",void 0),(0,r._)(this,"filters",void 0),(0,r._)(this,"sorts",void 0),this.table=e,this.action=t,this.actionValue=n,this.actionOptions=a,this.filters=[],this.sorts=[]}}class d{count(){return new c(this.table,"count")}delete(e){return new c(this.table,"delete",void 0,e)}insert(e,t){return new c(this.table,"insert",e,t)}select(e){return new c(this.table,"select",e)}update(e,t){return new c(this.table,"update",e,t)}truncate(e){return new c(this.table,"truncate",void 0,e)}constructor(e){(0,r._)(this,"table",void 0),this.table=e}}class u{from(e,t){return new d({name:e,schema:null!=t?t:"public"})}}},54775:function(e,t,n){function r(e){try{return JSON.parse(JSON.stringify(e))}catch(e){throw e}}function a(e){return e?"object"==typeof e||Array.isArray(e)?JSON.stringify(e):e:""}n.d(t,{I8:function(){return r},Lw:function(){return a},vQ:function(){return l}});let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(window.document.hasFocus()){var n,r;null===(r=window.navigator)||void 0===r||null===(n=r.clipboard)||void 0===n||n.writeText(e).then(t)}else console.warn("Unable to copy to clipboard")}},25622:function(e,t,n){n.d(t,{II:function(){return d},Kp:function(){return p},LT:function(){return y},N8:function(){return _},Pm:function(){return C},VO:function(){return x},kO:function(){return m},nL:function(){return b},nr:function(){return i},om:function(){return o},v3:function(){return a},yM:function(){return N}});let r=["smallint","integer","bigint","decimal","numeric","real","double precision","serial","bigserial","int2","int4","int8","float4","float8","smallserial","serial2","serial4","serial8"];function a(e){return r.indexOf(e.toLowerCase())>-1}let l=["json","jsonb","array"];function o(e){return l.indexOf(e.toLowerCase())>-1}let s=["array"];function i(e){return s.indexOf(e.toLowerCase())>-1}let c=["uuid","text","character varying"];function d(e){return c.indexOf(e.toLowerCase())>-1}let u=["citext"];function m(e){return u.indexOf(e.toLowerCase())>-1}let f=["timestamp","timestamptz"];function p(e){return f.indexOf(e.toLowerCase())>-1}let h=["date"];function x(e){return h.indexOf(e.toLowerCase())>-1}let g=["time","timetz"];function y(e){return g.indexOf(e.toLowerCase())>-1}let v=["boolean","bool"];function b(e){return v.indexOf(e.toLowerCase())>-1}let j=["user-defined"];function _(e){return j.indexOf(e.toLowerCase())>-1}let w=["bytea"];function N(e){return w.indexOf(e.toLowerCase())>-1}function C(e){var t;let{targetTableSchema:n,targetTableName:r,targetColumnName:a}=null!==(t=null==e?void 0:e.foreignKey)&&void 0!==t?t:{};return!!n&&!!r&&!!a}},17555:function(e,t,n){n.d(t,{Of:function(){return p},QZ:function(){return d},Sb:function(){return y},oo:function(){return m},s8:function(){return g},uE:function(){return u},xY:function(){return f}});var r=n(85466),a=n.n(r),l=n(7534),o=n.n(l),s=n(87882),i=n(45536);let c=e=>{if(["CURRENT_DATE"].includes(e)||"("===e[0]&&")"===e[e.length-1])return!0;let t=e.indexOf("("),n=e.indexOf(")");return!(e.indexOf(" ")>=0)&&t>=0&&n>t},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{name:t,table:n,schema:r,format:a}=e;return{id:(0,i.k$)(),name:t||"",table:n||"",schema:r||"",comment:"",format:a||"",defaultValue:null,foreignKey:void 0,check:null,isNullable:!0,isUnique:!1,isArray:!1,isPrimaryKey:!1,isIdentity:!1,isNewColumn:!0,isEncrypted:!1}},u=(e,t,n)=>{var r,a;let{primary_keys:l}=t,o=l.map(e=>e.name),s=h(e,t,n),c=(null==e?void 0:e.data_type)==="ARRAY";return{foreignKey:s,id:null!==(r=null==e?void 0:e.id)&&void 0!==r?r:(0,i.k$)(),table:e.table,schema:e.schema,name:e.name,comment:null!==(a=null==e?void 0:e.comment)&&void 0!==a?a:"",format:c?e.format.slice(1):e.format,defaultValue:null==e?void 0:e.default_value,check:e.check,isArray:c,isNullable:e.is_nullable,isIdentity:e.is_identity,isUnique:e.is_unique,isNewColumn:!1,isEncrypted:!1,isPrimaryKey:o.includes(e.name)}},m=(e,t)=>{var n,r;let a=!!t.format.includes("int")&&t.isIdentity,l=t.defaultValue;return{tableId:e,isIdentity:a,name:t.name.trim(),comment:null===(n=t.comment)||void 0===n?void 0:n.trim(),type:t.isArray?"".concat(t.format,"[]"):t.format,check:(null===(r=t.check)||void 0===r?void 0:r.trim())||void 0,isUnique:t.isUnique,isPrimaryKey:t.isPrimaryKey,...!t.isPrimaryKey&&!a&&{isNullable:t.isNullable},...!a&&{defaultValue:t.isArray&&l?x(l):l},...!a&&l&&{defaultValueFormat:o()(l)||c(l)?"expression":"literal"}}},f=(e,t,n)=>{var r,l,s,i,d,u;let m=t.primary_keys.map(e=>e.name).includes(e.name),f=n.name.trim(),p=n.isArray?"".concat(n.format,"[]"):n.format,h=null===(r=(null!==(u=null===(l=n.comment)||void 0===l?void 0:l.length)&&void 0!==u?u:"")===0?null:n.comment)||void 0===r?void 0:r.trim(),x=null===(s=n.check)||void 0===s?void 0:s.trim(),g={};if(a()(e.name.trim(),f)||(g.name=f),a()(null===(i=e.comment)||void 0===i?void 0:i.trim(),h)||(g.comment=h),a()(null===(d=e.check)||void 0===d?void 0:d.trim(),x)||(g.check=x),a()(e.format,p)||(g.type=p),!a()(e.default_value,n.defaultValue)){let e=n.defaultValue;g.defaultValue=e,g.defaultValueFormat=o()(e)||c(e)?"expression":"literal"}return a()(e.is_identity,n.isIdentity)||(g.isIdentity=n.isIdentity),a()(e.is_nullable,n.isNullable)||(g.isNullable=n.isNullable),a()(e.is_unique,n.isUnique)||(g.isUnique=n.isUnique),a()(m,n.isPrimaryKey)||(g.isPrimaryKey=n.isPrimaryKey),g},p=e=>{let t={};return 0===e.name.length&&(t.name="Please assign a name for your column"),0===e.format.length&&(t.format="Please select a type for your column"),t},h=(e,t,n)=>{let{relationships:r}=t,a=r.find(t=>t.source_schema===e.schema&&t.source_table_name===e.table&&t.source_column_name===e.name);if(void 0===a)return a;{var l,o;let e=n.find(e=>e.id===a.id);return{...a,deletion_action:null!==(l=null==e?void 0:e.deletion_action)&&void 0!==l?l:s.N.NO_ACTION,update_action:null!==(o=null==e?void 0:e.update_action)&&void 0!==o?o:s.N.NO_ACTION}}},x=e=>e?e.replaceAll("[","{").replaceAll("]","}"):null,g=e=>{switch(e){case s.N.CASCADE:return"Cascade";case s.N.RESTRICT:return"Restrict";case s.N.SET_DEFAULT:return"Set default";case s.N.SET_NULL:return"Set NULL";default:return}},y=(e,t)=>{let n=t||"column_name";switch(e){case"int2":case"int4":case"int8":case"numeric":return'"'.concat(n,'" > 0');case"float4":case"float8":return'"'.concat(n,'" > 0.0');case"text":case"varchar":return'length("'.concat(n,'") <= 50');case"json":case"jsonb":return'jsonb_typeof("'.concat(n,"\"->'active') = 'boolean'");case"bool":return'"'.concat(n,'" in (true, false)');case"date":return'"'.concat(n,"\" > '2024-01-01'");case"time":return'"'.concat(n,"\" between '09:00:00' and '12:00:00'");case"timetz":return'"'.concat(n,"\" at time zone 'UTC' between '09:00:00+00' and '17:00:00+00'");case"uuid":return'"'.concat(n,"\" '00000000-0000-0000-0000-000000000000'");case"timestamp":return'"'.concat(n,"\" > '2023-01-01 00:00' and \"").concat(n,"\" < '2025-01-01 00:00'");case"timestamptz":return'"'.concat(n,"\" > '2023-01-01 00:00:00+00' and \"").concat(n,"\" < '2025-01-01 00:00:00+00'");default:return'length("'.concat(n,'") < 500')}}},42533:function(e,t,n){n.d(t,{D4:function(){return R},Gq:function(){return b},Of:function(){return j},X3:function(){return S},YY:function(){return E},kh:function(){return k}});var r=n(28977),a=n.n(r),l=n(6494),o=n.n(l),s=n(85466),i=n.n(s),c=n(7534),d=n.n(c),u=n(76705),m=n.n(u),f=n(55371),p=n.n(f),h=n(38650),x=n(45536),g=n(36202),y=n(15313).Buffer;let v=e=>{let{column:t,row:n}=e;return void 0===n?g.BB.includes(t.format)?null:"bool"!==t.format?"":t.default_value?t.default_value:t.is_nullable?"null":null:"bool"===t.format&&null===n[t.name]?"null":g.nA.includes(t.format)?N(t.format,n[t.name]):_(n[t.name],t.format)},b=(e,t,n)=>{var r;let{primary_keys:a}=t,l=a.map(e=>e.name);return(null!==(r=t.columns)&&void 0!==r?r:[]).map(t=>{var r,a;let o=v({column:t,row:e}),s=n.find(e=>e.columns.map(e=>e.source).includes(t.name));return{value:o,foreignKey:void 0!==s?{id:s.id,constraint_name:s.name,source_schema:t.schema,source_table_name:t.table,source_column_name:t.name,target_table_schema:s.schema,target_table_name:s.table,target_column_name:null!==(a=null===(r=s.columns.find(e=>e.source===t.name))||void 0===r?void 0:r.target)&&void 0!==a?a:""}:void 0,id:t.id,name:t.name,comment:w(t.comment),format:t.format,enums:t.enums,defaultValue:null==t?void 0:t.default_value,isNullable:t.is_nullable,isIdentity:t.is_identity,isPrimaryKey:l.includes(t.name)}})},j=e=>{let t={};return e.forEach(e=>{var n,r,a;if(e.format.startsWith("_")&&e.value)try{JSON.parse(e.value)}catch(n){t[e.name]="Value is an invalid array"}if(e.format.includes("json")&&(null!==(r=null===(n=e.value)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0){if(k(e.value))return;try{(0,x.jn)(null!==(a=e.value)&&void 0!==a?a:"")}catch(n){t[e.name]="Value is invalid JSON"}}if(e.isIdentity||e.defaultValue)return}),t},_=(e,t)=>{try{if(null===e||"string"==typeof e&&0===e.length||"number"==typeof e||!t)return e;if("bytea"===t)return R(e);if("object"==typeof e)return JSON.stringify(e);else if("boolean"==typeof e)return e.toString();else return e}catch(t){return e}},w=e=>{var t,n;if(!e)return"";let r=o()(e.split("\n"));return 1==r.length?e:2==r.length?"".concat(r[0]," ").concat(null===(t=r[1])||void 0===t?void 0:t.split(".<")[0]):r.length>2?"".concat(r[0]," (").concat(r[1]," ").concat(null===(n=r[2])||void 0===n?void 0:n.split(".<")[0],")"):""},N=(e,t)=>{if(!t||0==t.length)return"";if(g.Ks.includes(e))return a()(t).format("YYYY-MM-DDTHH:mm:ss");if(!g.XO.includes(e))return t;{let e=t&&t.includes("+")?"HH:mm:ssZZ":"HH:mm:ss";return a()(t,e).format("HH:mm:ss")}},C=(e,t)=>{if(!t||0==t.length)return null;switch(e){case"timestamptz":return a()(t,"YYYY-MM-DDTHH:mm:ss").format("YYYY-MM-DDTHH:mm:ssZ");case"timestamp":return a()(t,"YYYY-MM-DDTHH:mm:ss").format("YYYY-MM-DDTHH:mm:ss");case"timetz":return a()(t,"HH:mm:ss").format("HH:mm:ssZZ");case"time":return a()(t,"HH:mm:ss").format("HH:mm:ss");default:return t}},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return e.forEach(e=>{var t;let r=e.format.startsWith("_"),a=g.BB.includes(e.format)?e.value:0===(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").length?null:e.value;if(r&&null!==a)n[e.name]=(0,x.dW)(a);else if(e.format.includes("json"))"object"==typeof e.value?n[e.name]=a:m()(a)&&(n[e.name]=(0,x.dW)(a));else if("bool"===e.format&&a)"null"===a?n[e.name]=null:n[e.name]="true"===a;else if(g.nA.includes(e.format)){let t=2===(a||"").split(":").length?"".concat(a,":00"):a;n[e.name]=C(e.format,t)}else n[e.name]=a}),t?n:p()(n,d())},S=(e,t)=>{let n=E(t,!0),r={};return Object.keys(n).forEach(a=>{let l=t.find(e=>e.name===a),o=null==l?void 0:l.format;if(void 0!==o&&g.nA.includes(o)){let t=N(o,e[a]);C(o,t)!==n[a]&&(r[a]=n[a])}else void 0!==o&&g.YF.includes(o)?k(null==l?void 0:l.value)||(r[a]=n[a]):i()(e[a],n[a])||(r[a]=n[a])}),r},k=e=>(null==e?void 0:e.endsWith("..."))&&(null!=e?e:"").length>h.no,R=e=>"\\x".concat(y.from(e.data).toString("hex"))},36202:function(e,t,n){n.d(t,{BB:function(){return c},DL:function(){return h},Ks:function(){return d},N0:function(){return g},VP:function(){return x},XO:function(){return m},YF:function(){return i},ji:function(){return s},lb:function(){return u},nA:function(){return f},vH:function(){return p}});var r=n(11466),a=n.n(r),l=n(71635),o=n.n(l);let s=["int2","int4","int8","float4","float8","numeric","double precision"],i=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],f=a()(d,u,m),p=["uuid","bool","vector","bytea"],h=o()(a()(s,i,c,f,p)),x={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},g=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"},{name:"bytea",description:"Variable-length binary string",type:"others"}]},99359:function(e,t,n){n.d(t,{R:function(){return r},k:function(){return a}});let r=(e,t,n,r,a)=>{let l=(null==r?void 0:r.find(r=>{var l,o;return(null==r?void 0:null===(l=r.metadata)||void 0===l?void 0:l.name)===e&&(null==r?void 0:null===(o=r.metadata)||void 0===o?void 0:o.schema)===a&&(null==r?void 0:r.name)===t&&n.includes(null==r?void 0:r.level)}))||null;return{hasLint:null!==l,count:l?1:0,matchingLint:l}},a=(e,t)=>{if(0===t.length)return"";let n=e.columns.map(e=>'"'.concat(e.name,'"')).join(", "),r=t.map(t=>{let n={...t};"idx"in n&&delete n.idx;let r=Object.entries(n).map(t=>{var n;let[r,a]=t,{dataType:l,format:o}=null!==(n=e.columns.find(e=>e.name===r))&&void 0!==n?n:{};return null===a?"null":"ARRAY"===l?"'".concat(JSON.stringify(a).replace("[","{").replace(/.$/,"}"),"'"):(null==o?void 0:o.includes("json"))?"".concat(JSON.stringify(a).replace(/\\"/g,'"').replace('"',"'").replace(/.$/,"'")):"'".concat(a,"'")});return"(".concat(r.join(", "),")")}).join(", ");return'INSERT INTO "'.concat(e.schema,'"."').concat(e.name,'" (').concat(n,") VALUES ").concat(r,";")}},74179:function(e,t,n){n.d(t,{LW:function(){return u},bn:function(){return h}});var r=n(36457),a=n(64618),l=n(34549),o=n(15538),s=n.n(o),i=n(25878),c=n(74476),d=n(7324);let u="pgmq_public",m=s()("\ncreate schema if not exists ".concat(u,";\ngrant usage on schema ").concat(u," to postgres, anon, authenticated, service_role;\n\ncreate or replace function ").concat(u,".pop(\n    queue_name text\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.pop(\n        queue_name := queue_name\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".pop(queue_name text) is 'Retrieves and locks the next message from the specified queue.';\n\n\ncreate or replace function ").concat(u,".send(\n    queue_name text,\n    message jsonb,\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send(\n        queue_name := queue_name,\n        msg := message,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer) is 'Sends a message to the specified queue, optionally delaying its availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".send_batch(\n    queue_name text,\n    messages jsonb[],\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send_batch(\n        queue_name := queue_name,\n        msgs := messages,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send_batch(queue_name text, messages jsonb[], sleep_seconds integer) is 'Sends a batch of messages to the specified queue, optionally delaying their availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".delete(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.delete(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".delete(queue_name text, message_id bigint) is 'Permanently deletes a message from the specified queue.';\n\ncreate or replace function ").concat(u,".read(\n    queue_name text,\n    sleep_seconds integer,\n    n integer\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.read(\n        queue_name := queue_name,\n        vt := sleep_seconds,\n        qty := n\n    );\nend;\n$$;\n\ncomment on function ").concat(u,'.read(queue_name text, sleep_seconds integer, n integer) is \'Reads up to "n" messages from the specified queue with an optional "sleep_seconds" (visibility timeout).\';\n\n-- Grant execute permissions on wrapper functions to roles\ngrant execute on function ').concat(u,".pop(text) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.pop(text) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".archive(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.archive(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".delete(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.delete(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".read(text, integer, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.read(text, integer, integer) to postgres, service_role, anon, authenticated;\n\n-- For the service role, we want full access\n-- Grant permissions on existing tables\ngrant all privileges on all tables in schema pgmq to postgres, service_role;\n\n-- Ensure service_role has permissions on future tables\nalter default privileges in schema pgmq grant all privileges on tables to postgres, service_role;\n\ngrant usage on schema pgmq to postgres, anon, authenticated, service_role;\n\n\n/*\n  Grant access to sequences to API roles by default. Existing table permissions\n  continue to enforce insert restrictions. This is necessary to accommodate the\n  on-backup hook that rebuild queue table primary keys to avoid a pg_dump segfault.\n  This can be removed once logical backups are completely retired.\n*/\ngrant usage, select, update\non all sequences in schema pgmq\nto anon, authenticated, service_role;\n\nalter default privileges in schema pgmq\ngrant usage, select, update\non sequences\nto anon, authenticated, service_role;\n")),f=s()("\n  drop function if exists \n    ".concat(u,".pop(queue_name text),\n    ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer),\n    ").concat(u,".send_batch(queue_name text, message jsonb[], sleep_seconds integer),\n    ").concat(u,".archive(queue_name text, message_id bigint),\n    ").concat(u,".delete(queue_name text, message_id bigint),\n    ").concat(u,".read(queue_name text, sleep integer, n integer)\n  ;\n\n  -- Revoke execute permissions on inner pgmq functions to roles (inverse of enabling)\n  do $$\n  begin\n      if exists (select 1 from pg_namespace where nspname = 'pgmq') then\n          -- Revoke privileges on the schema itself\n          revoke all on schema pgmq from anon, authenticated, service_role;\n          \n          -- Revoke default privileges for future objects\n          alter default privileges in schema pgmq revoke all on tables from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on sequences from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on functions from anon, authenticated, service_role;\n      end if;\n  end $$;\n\n  drop schema if exists ").concat(u,";\n"));async function p(e){let{projectRef:t,connectionString:n,enable:r}=e,{result:a}=await (0,i.R)({projectRef:t,connectionString:n,sql:r?m:f,queryKey:["toggle-queues-exposure"]});return a}let h=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,r.NL)();return(0,a.D)(e=>p(e),{async onSuccess(t,n,r){let{projectRef:a}=n;await o.invalidateQueries(c.a.exposePostgrestStatus(a)),o.invalidateQueries(d.A.schemas(a)),await (null==e?void 0:e(t,n,r))},async onError(e,n,r){void 0===t?l.Am.error("Failed to toggle queue exposure via PostgREST: ".concat(e.message)):t(e,n,r)},...n})}},74476:function(e,t,n){n.d(t,{a:function(){return r}});let r={create:()=>["queues","create"],delete:e=>["queues",e,"delete"],purge:e=>["queues",e,"purge"],getMessagesInfinite:(e,t,n)=>["projects",e,"queue-messages",t,n].filter(Boolean),list:e=>["projects",e,"queues"],metrics:(e,t)=>["projects",e,"queue-metrics",t],exposePostgrestStatus:e=>["projects",e,"queue-expose-status"]}},4818:function(e,t,n){n.d(t,{XJ:function(){return i}});var r=n(28894),a=n(25878),l=n(7324);let o=e=>{let{schema:t}=e;if(!t)throw Error("schema is required");return"\nSELECT \n  con.oid as id, \n  con.conname as constraint_name, \n  con.confdeltype as deletion_action,\n  con.confupdtype as update_action,\n  rel.oid as source_id,\n  nsp.nspname as source_schema, \n  rel.relname as source_table, \n  (\n    SELECT \n      array_agg(\n        att.attname \n        ORDER BY \n          un.ord\n      ) \n    FROM \n      unnest(con.conkey) WITH ORDINALITY un (attnum, ord) \n      INNER JOIN pg_attribute att ON att.attnum = un.attnum \n    WHERE \n      att.attrelid = rel.oid\n  ) source_columns, \n  frel.oid as target_id,\n  fnsp.nspname as target_schema, \n  frel.relname as target_table, \n  (\n    SELECT \n      array_agg(\n        att.attname \n        ORDER BY \n          un.ord\n      ) \n    FROM \n      unnest(con.confkey) WITH ORDINALITY un (attnum, ord) \n      INNER JOIN pg_attribute att ON att.attnum = un.attnum \n    WHERE \n      att.attrelid = frel.oid\n  ) target_columns \nFROM \n  pg_constraint con \n  INNER JOIN pg_class rel ON rel.oid = con.conrelid \n  INNER JOIN pg_namespace nsp ON nsp.oid = rel.relnamespace \n  INNER JOIN pg_class frel ON frel.oid = con.confrelid \n  INNER JOIN pg_namespace fnsp ON fnsp.oid = frel.relnamespace \nWHERE \n  con.contype = 'f'\n  AND nsp.nspname = '".concat(t,"'\n").trim()};async function s(e,t){let{projectRef:n,connectionString:r,schema:l}=e,s=o({schema:l}),{result:i}=await (0,a.R)({projectRef:n,connectionString:r,sql:s,queryKey:["foreign-key-constraints",l]},t);return(null!=i?i:[]).map(e=>({...e,source_columns:e.source_columns.replace("{","").replace("}","").split(","),target_columns:e.target_columns.replace("{","").replace("}","").split(",")}))}let i=function(e){let{projectRef:t,connectionString:n,schema:a}=e,{enabled:o=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)(l.A.foreignKeyConstraints(t,a),e=>{let{signal:r}=e;return s({projectRef:t,connectionString:n,schema:a},r)},{enabled:o&&void 0!==t&&void 0!==a,...i})}},1978:function(e,t,n){n.d(t,{Q:function(){return r}});let r={tableEditor:(e,t)=>["projects",e,"table-editor",t]}},39113:function(e,t,n){n.d(t,{IV:function(){return i},nq:function(){return d},iB:function(){return c}});var r=n(28894),a=n(25878),l=n(1978),o=n(15538),s=n.n(o);async function i(e,t){var n,r;let{projectRef:l,connectionString:o,id:i}=e;if(!i)throw Error("id is required");let c=i?s()("\n    with base_table_info as (\n        select \n            c.oid::int8 as id,\n            nc.nspname as schema,\n            c.relname as name,\n            c.relkind,\n            c.relrowsecurity as rls_enabled,\n            c.relforcerowsecurity as rls_forced,\n            c.relreplident,\n            c.relowner,\n            obj_description(c.oid) as comment\n        from pg_class c\n        join pg_namespace nc on nc.oid = c.relnamespace\n        where c.oid = ".concat(i,"\n            and not pg_is_other_temp_schema(nc.oid)\n            and (\n                pg_has_role(c.relowner, 'USAGE')\n                or has_table_privilege(\n                    c.oid,\n                    'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n                )\n                or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n            )\n    ),\n    table_stats as (\n        select \n            b.id,\n            case\n                when b.relreplident = 'd' then 'DEFAULT'\n                when b.relreplident = 'i' then 'INDEX'\n                when b.relreplident = 'f' then 'FULL'\n                else 'NOTHING'\n            end as replica_identity,\n            pg_total_relation_size(format('%I.%I', b.schema, b.name))::int8 as bytes,\n            pg_size_pretty(pg_total_relation_size(format('%I.%I', b.schema, b.name))) as size,\n            pg_stat_get_live_tuples(b.id) as live_rows_estimate,\n            pg_stat_get_dead_tuples(b.id) as dead_rows_estimate\n        from base_table_info b\n        where b.relkind in ('r', 'p')\n    ),\n    primary_keys as (\n        select \n            i.indrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'schema', n.nspname,\n                'table_name', c.relname,\n                'table_id', i.indrelid::int8,\n                'name', a.attname\n            )) as primary_keys\n        from pg_index i\n        join pg_class c on i.indrelid = c.oid\n        join pg_attribute a on (a.attrelid = c.oid and a.attnum = any(i.indkey))\n        join pg_namespace n on c.relnamespace = n.oid\n        where i.indisprimary\n        group by i.indrelid\n    ),\n    relationships as (\n        select \n            c.conrelid as source_id,\n            c.confrelid as target_id,\n            jsonb_build_object(\n                'id', c.oid::int8,\n                'constraint_name', c.conname,\n                'deletion_action', c.confdeltype,\n                'update_action', c.confupdtype,\n                'source_schema', nsa.nspname,\n                'source_table_name', csa.relname,\n                'source_column_name', sa.attname,\n                'target_table_schema', nta.nspname,\n                'target_table_name', cta.relname,\n                'target_column_name', ta.attname\n            ) as rel_info\n        from pg_constraint c\n        join pg_class csa on c.conrelid = csa.oid\n        join pg_namespace nsa on csa.relnamespace = nsa.oid\n        join pg_attribute sa on (sa.attrelid = c.conrelid and sa.attnum = any(c.conkey))\n        join pg_class cta on c.confrelid = cta.oid\n        join pg_namespace nta on cta.relnamespace = nta.oid\n        join pg_attribute ta on (ta.attrelid = c.confrelid and ta.attnum = any(c.confkey))\n        where c.contype = 'f'\n    ),\n    columns as (\n        select \n            a.attrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'id', (a.attrelid || '.' || a.attnum),\n                'table_id', c.oid::int8,\n                'schema', nc.nspname,\n                'table', c.relname,\n                'ordinal_position', a.attnum,\n                'name', a.attname,\n                'default_value', case \n                    when a.atthasdef then pg_get_expr(ad.adbin, ad.adrelid)\n                    else null\n                end,\n                'data_type', case \n                    when t.typtype = 'd' then \n                        case \n                            when bt.typelem <> 0::oid and bt.typlen = -1 then 'ARRAY'\n                            when nbt.nspname = 'pg_catalog' then format_type(t.typbasetype, null)\n                            else 'USER-DEFINED'\n                        end\n                    else \n                        case \n                            when t.typelem <> 0::oid and t.typlen = -1 then 'ARRAY'\n                            when nt.nspname = 'pg_catalog' then format_type(a.atttypid, null)\n                            else 'USER-DEFINED'\n                        end\n                end,\n                'format', case\n                    when t.typtype = 'e' then\n                        case\n                            when nt.nspname <> 'public' then concat(nt.nspname, '.', coalesce(bt.typname, t.typname))\n                            else coalesce(bt.typname, t.typname)\n                        end\n                    else\n                        coalesce(bt.typname, t.typname)\n                end,\n                'is_identity', a.attidentity in ('a', 'd'),\n                'identity_generation', case a.attidentity\n                    when 'a' then 'ALWAYS'\n                    when 'd' then 'BY DEFAULT'\n                    else null\n                end,\n                'is_generated', a.attgenerated in ('s'),\n                'is_nullable', not (a.attnotnull or t.typtype = 'd' and t.typnotnull),\n                'is_updatable', (\n                    b.relkind in ('r', 'p') or \n                    (b.relkind in ('v', 'f') and pg_column_is_updatable(b.id, a.attnum, false))\n                ),\n                'is_unique', uniques.table_id is not null,\n                'check', check_constraints.definition,\n                'comment', col_description(c.oid, a.attnum),\n                'enums', coalesce(\n                    (\n                        select jsonb_agg(e.enumlabel order by e.enumsortorder)\n                        from pg_catalog.pg_enum e\n                        where e.enumtypid = coalesce(bt.oid, t.oid)\n                            or e.enumtypid = coalesce(bt.typelem, t.typelem)\n                    ),\n                    '[]'::jsonb\n                )\n            ) order by a.attnum) as columns\n        from pg_attribute a\n        join base_table_info b on a.attrelid = b.id\n        join pg_class c on a.attrelid = c.oid\n        join pg_namespace nc on c.relnamespace = nc.oid\n        left join pg_attrdef ad on (a.attrelid = ad.adrelid and a.attnum = ad.adnum)\n        join pg_type t on a.atttypid = t.oid\n        join pg_namespace nt on t.typnamespace = nt.oid\n        left join pg_type bt on (t.typtype = 'd' and t.typbasetype = bt.oid)\n        left join pg_namespace nbt on bt.typnamespace = nbt.oid\n        left join (\n            select \n                conrelid as table_id,\n                conkey[1] as ordinal_position\n            from pg_catalog.pg_constraint\n            where contype = 'u' and cardinality(conkey) = 1\n        ) as uniques on uniques.table_id = a.attrelid and uniques.ordinal_position = a.attnum\n        left join (\n            select distinct on (conrelid, conkey[1])\n                conrelid as table_id,\n                conkey[1] as ordinal_position,\n                substring(\n                    pg_get_constraintdef(oid, true),\n                    8,\n                    length(pg_get_constraintdef(oid, true)) - 8\n                ) as definition\n            from pg_constraint\n            where contype = 'c' and cardinality(conkey) = 1\n            order by conrelid, conkey[1], oid asc\n        ) as check_constraints on check_constraints.table_id = a.attrelid \n                            and check_constraints.ordinal_position = a.attnum\n        where a.attnum > 0 \n        and not a.attisdropped\n        group by a.attrelid\n    )\n    select \n        case b.relkind\n            when 'r' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'p' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'v' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_updatable', (pg_relation_is_updatable(b.id, false) & 20) = 20,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'm' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_populated', true,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'f' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n        end as entity\n    from base_table_info b\n    left join table_stats ts on b.id = ts.id\n    left join primary_keys pk on b.id = pk.table_id\n    left join columns c on b.id = c.table_id;\n  ")):"",{result:d}=await (0,a.R)({projectRef:l,connectionString:o,sql:c,queryKey:["table-editor",i]},t);return null!==(r=null===(n=d[0])||void 0===n?void 0:n.entity)&&void 0!==r?r:void 0}let c=function(e){let{projectRef:t,connectionString:n,id:a}=e,{enabled:o=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)(l.Q.tableEditor(t,a),e=>{let{signal:r}=e;return i({projectRef:t,connectionString:n,id:a},r)},{enabled:o&&void 0!==t&&void 0!==a&&!isNaN(a),staleTime:3e5,...s})};function d(e,t){let{projectRef:n,connectionString:r,id:a}=t;return e.fetchQuery(l.Q.tableEditor(n,a),e=>{let{signal:t}=e;return i({projectRef:n,connectionString:r,id:a},t)})}},89199:function(e,t,n){n.d(t,{D1:function(){return i},Du:function(){return o},GV:function(){return l},N3:function(){return a},z_:function(){return s}});var r=n(33940);function a(e){return(null==e?void 0:e.entity_type)===r.l.TABLE||(null==e?void 0:e.entity_type)===r.l.PARTITIONED_TABLE}function l(e){return(null==e?void 0:e.entity_type)===r.l.FOREIGN_TABLE}function o(e){return(null==e?void 0:e.entity_type)===r.l.VIEW}function s(e){return(null==e?void 0:e.entity_type)===r.l.MATERIALIZED_VIEW}function i(e){return o(e)||s(e)}},36592:function(e,t,n){n.d(t,{rp:function(){return i}});var r=n(64618),a=n(34549),l=n(65051),o=n(25878);async function s(e){let{projectRef:t,connectionString:n,table:r,column:a,pkMatch:s}=e,i=function(e){var t;let{table:n,column:r,pkMatch:a}=e;return new l.A().from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).select('"'.concat(r,'"')).match(a).toSql()}({table:r,column:a,pkMatch:s}),{result:c}=await (0,o.R)({projectRef:t,connectionString:n,sql:i});return null==c?void 0:c[0][a]}let i=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.D)(e=>s(e),{async onSuccess(t,n,r){await (null==e?void 0:e(t,n,r))},async onError(e,n,r){void 0===t?a.Am.error(e.message):t(e,n,r)},...n})}},79790:function(e,t,n){n.d(t,{s:function(){return r}});let r={tableRows:function(e){let{table:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==t?void 0:t.id,"rows",n]},tableRowsCount:function(e){let{table:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==t?void 0:t.id,"count",n]},tableRowsAndCount:(e,t)=>["projects",e,"table-rows",t]}},76059:function(e,t,n){n.d(t,{Fi:function(){return f},HS:function(){return g}});var r=n(36457),a=n(28894),l=n(65051),o=n(27850),s=n(39113),i=n(99492),c=n(24561),d=n(25878),u=n(79790),m=n(62175);let f=5e4,p="\nCREATE OR REPLACE FUNCTION pg_temp.count_estimate(\n    query text\n) RETURNS integer LANGUAGE plpgsql AS $$\nDECLARE\n    plan jsonb;\nBEGIN\n    EXECUTE 'EXPLAIN (FORMAT JSON)' || query INTO plan;\n    RETURN plan->0->'Plan'->'Plan Rows';\nEND;\n$$;\n".trim(),h=e=>{var t,n,r;let{table:a,filters:o=[],enforceExactCount:s=!1}=e;if(!a)return"";if(s){let e=new l.A().from(a.name,null!==(t=a.schema)&&void 0!==t?t:void 0).count();return o.filter(e=>e.value&&""!==e.value).forEach(t=>{let n=(0,m.q)(a,t);e=e.filter(t.column,t.operator,n)}),"select (".concat(e.toSql().slice(0,-1),"), false as is_estimate;")}{let e=new l.A().from(a.name,null!==(n=a.schema)&&void 0!==n?n:void 0).select("*");o.filter(e=>e.value&&""!=e.value).forEach(t=>{let n=(0,m.q)(a,t);e=e.filter(t.column,t.operator,n)});let t=e.toSql(),s=new l.A().from(a.name,null!==(r=a.schema)&&void 0!==r?r:void 0).count();o.filter(e=>e.value&&""!=e.value).forEach(e=>{let t=(0,m.q)(a,e);s=s.filter(e.column,e.operator,t)});let i=s.toSql().slice(0,-1);return"\n".concat(p,"\n\nwith approximation as (\n    select reltuples as estimate\n    from pg_class\n    where oid = ").concat(a.id,"\n)\nselect \n  case \n    when estimate = -1 then (select pg_temp.count_estimate('").concat(t.replaceAll("'","''"),"'))\n    when estimate > ").concat(f," then ").concat(o.length>0?"pg_temp.count_estimate('".concat(t.replaceAll("'","''"),"')"):"estimate","\n    else (").concat(i,")\n  end as count,\n  estimate = -1 or estimate > ").concat(f," as is_estimate\nfrom approximation;\n").trim()}};async function x(e,t){var n;let{queryClient:r,projectRef:a,connectionString:l,tableId:u,filters:m,impersonatedRole:f,enforceExactCount:p}=e,x=await (0,s.nq)(r,{projectRef:a,connectionString:l,id:u});if(!x)throw Error("Table not found");let g=(0,o.NK)(x),y=(0,i.Jh)(h({table:g,filters:m,enforceExactCount:p}),{projectRef:null!=a?a:"ref",role:f}),{result:v}=await (0,d.R)({projectRef:a,connectionString:l,sql:y,queryKey:["table-rows-count",g.id],isRoleImpersonationEnabled:(0,c.Gm)(f)},t);return{count:v[0].count,is_estimate:null!==(n=v[0].is_estimate)&&void 0!==n&&n}}let g=function(e){let{projectRef:t,connectionString:n,tableId:l,...o}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,r.NL)();return(0,a.a)(u.s.tableRowsCount(t,{table:{id:l},...o}),e=>{let{signal:r}=e;return x({queryClient:c,projectRef:t,connectionString:n,tableId:l,...o},r)},{enabled:s&&void 0!==t&&void 0!==l,...i})}},38650:function(e,t,n){n.d(t,{no:function(){return g},wF:function(){return v},Ue:function(){return w},KK:function(){return _}});var r=n(36457),a=n(28894),l=n(12436),o=n(65051),s=n(27850),i=n(36202),c=n(39113),d=n(37756),u=n(99492),m=n(24561),f=n(25878),p=n(79790),h=n(76059),x=n(62175);let g=10*d.KB,y=e=>{var t;let n=e.columns.filter(e=>null==e?void 0:e.isPrimaryKey).map(e=>e.name);return 0!==n.length?n:[null===(t=e.columns[0])||void 0===t?void 0:t.name]},v=async e=>{var t;let{projectRef:n,connectionString:r,table:a,filters:s=[],sorts:i=[],impersonatedRole:c}=e;if(l.Qy&&!r)return console.error("Connection string is required"),[];let d=[],m=new o.A,p=a.columns.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enum)&&void 0!==t?t:[]).length>0&&"array"===e.dataType.toLowerCase()}).map(e=>'"'.concat(e.name,'"::text[]')),g=m.from(a.name,null!==(t=a.schema)&&void 0!==t?t:void 0).select(p.length>0?"*,".concat(p.join(",")):"*");if(s.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,x.q)(a,e);g=g.filter(e.column,e.operator,t)}),0===i.length&&a.estimateRowCount<=h.Fi){let e=y(a);e.length>0&&e.forEach(e=>{g=g.order(a.name,e,!0,!0)})}else i.forEach(e=>{g=g.order(e.table,e.column,e.ascending,e.nullsFirst)});let v=-1,b=0,j=0,_=[];return await (async()=>{do{v+=1,b=500*v,j=(v+1)*500-1;let e=(0,u.Jh)(g.range(b,j).toSql(),{projectRef:n,role:c});try{let{result:t}=await (0,f.R)({projectRef:n,connectionString:r,sql:e});d.push(...t),_=t}catch(e){return{data:{rows:[]}}}}while(500===_.length)})(),d.filter(e=>1!==e[u.$y])},b=e=>{var t;let{table:n,filters:r=[],sorts:a=[],page:l,limit:s}=e,c=new o.A;if(!n)return"";let d=n.columns.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enum)&&void 0!==t?t:[]).length>0&&"array"===e.dataType.toLowerCase()}).map(e=>'"'.concat(e.name,'"::text[]')),u=c.from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).select(d.length>0?"*,".concat(d.join(",")):"*");if(r.filter(e=>e.value&&""!=e.value).forEach(e=>{let t=(0,x.q)(n,e);u=u.filter(e.column,e.operator,t)}),0===a.length&&n.estimateRowCount<=h.Fi&&n.columns.length>0){let e=y(n);e.length>0&&e.forEach(e=>{u=u.order(n.name,e,!0,!0)})}else a.forEach(e=>{u=u.order(e.table,e.column,e.ascending,e.nullsFirst)});let{from:m,to:f}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=e?e*t:0;return{from:n,to:e?n+t-1:t-1}}((null!=l?l:1)-1,s),p=u.range(m,f).toSql(),v=n.columns.filter(e=>i.BB.includes(e.format)||i.YF.includes(e.format)).map(e=>'case when length("'.concat(e.name,'"::text) > ').concat(g,' then concat(left("').concat(e.name,'"::text, ').concat(g,"), '...') else \"").concat(e.name,'"::text end "').concat(e.name,'"'));return v.length>0?"with _temp as (".concat(p.slice(0,-1),") select *, ").concat(v.join(",")," from _temp"):p};async function j(e,t){let{queryClient:n,projectRef:r,connectionString:a,tableId:l,impersonatedRole:o,filters:i,sorts:d,limit:p,page:h}=e,x=await (0,c.nq)(n,{projectRef:r,connectionString:a,id:l});if(!x)throw Error("Table not found");let g=(0,s.NK)(x),y=(0,u.Jh)(b({table:g,filters:i,sorts:d,limit:p,page:h,impersonatedRole:o}),{projectRef:null!=r?r:"ref",role:o}),{result:v}=await (0,f.R)({projectRef:r,connectionString:a,sql:y,queryKey:["table-rows",null==g?void 0:g.id],isRoleImpersonationEnabled:(0,m.Gm)(o)},t);return{rows:v.map((e,t)=>({idx:t,...e}))}}let _=function(e){let{projectRef:t,connectionString:n,tableId:l,...o}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,r.NL)();return(0,a.a)(p.s.tableRows(t,{table:{id:l},...o}),e=>{let{signal:r}=e;return j({queryClient:c,projectRef:t,connectionString:n,tableId:l,...o},r)},{enabled:s&&void 0!==t&&void 0!==l,...i})};function w(e,t){let{projectRef:n,connectionString:r,tableId:a,impersonatedRole:l,...o}=t;return e.fetchQuery(p.s.tableRows(n,{table:{id:a},...o}),t=>{let{signal:l}=t;return j({queryClient:e,projectRef:n,connectionString:r,tableId:a,...o},l)})}},62175:function(e,t,n){n.d(t,{h:function(){return o},q:function(){return l}});var r=n(25622),a=n(89199);function l(e,t){let n=e.columns.find(e=>e.name==t.column);if(n&&(0,r.v3)(n.format)){let e=Number(t.value);if(!Number.isNaN(e)&&!(e>Number.MAX_SAFE_INTEGER))return Number(t.value)}return t.value}function o(e){let{table:t}=e;if(!(0,a.N3)(t))return{error:{message:"Only table rows can be updated or deleted"}};let n=t.primary_keys;return n&&0!=n.length?{primaryKeys:n.map(e=>e.name)}:{error:{message:"Please add a primary key column to your table to update or delete rows"}}}},96444:function(e,t,n){n.d(t,{T:function(){return a},s:function(){return r}});let r=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public",n(74179).LW],a=r.filter(e=>"extensions"!==e)},62095:function(e,t,n){n.d(t,{z:function(){return H},v:function(){return U}});var r=n(97458),a=n(52983),l=n(29442),o=n(63969),s=n(63730),i=n(12436),c=n(88971),d=n(38650),u=n(53114),m=n(24561),f=n(96226),p=n(27850),h=n(98495),x=n(54775),g=n(86086);function y(e){let{gridRef:t}=e,{rows:n,gridColumns:r,selectedCellPosition:l}=(0,h.Qq)(),[o,s]=a.useState("Command");return a.useEffect(()=>{var e,t;s("windows"==((null===(e=navigator)||void 0===e?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null===(t=navigator)||void 0===t?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command")},[]),(0,g.a)({["".concat(o,"+ArrowUp")]:e=>{if(e.stopPropagation(),l){var n;let e={idx:null!==(n=null==l?void 0:l.idx)&&void 0!==n?n:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(o,"+ArrowDown")]:e=>{if(e.stopPropagation(),l){var r;let e={idx:null!==(r=null==l?void 0:l.idx)&&void 0!==r?r:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(o,"+ArrowLeft")]:e=>{var n;e.stopPropagation();let a={idx:r.filter(e=>e.frozen).length,rowIdx:null!==(n=null==l?void 0:l.rowIdx)&&void 0!==n?n:0};t.current.selectCell(a)},["".concat(o,"+ArrowRight")]:e=>{var n,a;e.stopPropagation(),null===(n=t.current)||void 0===n||n.selectCell({idx:r.length-1,rowIdx:null!==(a=null==l?void 0:l.rowIdx)&&void 0!==a?a:0})},["".concat(o,"+c")]:e=>{if(e.stopPropagation(),l){let{idx:e,rowIdx:o}=l;if(e>0){var t,a;let l=r[e].key,s=null!==(a=null===(t=n[o])||void 0===t?void 0:t[l])&&void 0!==a?a:"",i=(0,x.Lw)(s);(0,x.vQ)(i)}}}},["INPUT","TEXTAREA","SELECT"]),null}var v=n(99968),b=n(12832),j=n(44914),_=n(87595),w=n(30457),N=n(31472),C=n(55271),E=n(5529),S=n(4818),k=n(82288),R=n(75541),T=n(45536),A=n(65092),L=n(90839),O=n(70717),I=n(8836);function P(e,t){let{show:n}=(0,O.av)();return(0,r.jsx)(j.X2,{...t,onContextMenu:function(e){n(e,{id:I.ep,props:{rowIdx:t.rowIdx}})},"data-sentry-element":"Row","data-sentry-component":"RowRenderer","data-sentry-source-file":"RowRenderer.tsx"},e)}let q=e=>{var t;return null!==(t=null==e?void 0:e.idx)&&void 0!==t?t:-1},D=(0,b.Z)((e,t,n)=>{n({type:"UPDATE_COLUMN_SIZE",payload:{index:e,width:Math.round(t)}})},500),z=(0,_.X$)((0,a.forwardRef)((e,t)=>{var n;let{width:l,height:o,containerClass:s,gridClass:i,rowClass:d,rows:u,error:m,isLoading:f,isSuccess:p,isError:y,filters:v,setParams:b,updateRow:_,onAddRow:O,onImportData:I,onEditForeignKeyColumnValue:z}=e,F=(0,h.I0)(),Z=(0,h.Qq)();async function M(e,t){let n=e[t.indexes[0]],r=u.find(e=>e.idx==n.idx),a=Object.keys(n).find(e=>n[e]!==r[e]);a&&_(r,{[a]:n[a]})}let U=(0,a.useRef)(null);function W(){var e,t,n,r;let a=null===(r=U.current)||void 0===r?void 0:null===(n=r.row)||void 0===n?void 0:n[null===(t=U.current)||void 0===t?void 0:null===(e=t.column)||void 0===e?void 0:e.key],l=(0,x.Lw)(a);l&&(0,T.vQ)(l)}(0,g.a)({"Command+c":e=>{e.stopPropagation(),W()},"Control+c":e=>{e.stopPropagation(),W()}},["INPUT","TEXTAREA"]);let H=Z.table,{mutate:K}=(0,k.a)(),Y=(0,R.l)(),{project:B}=(0,c.d2)(),{data:$}=(0,S.XJ)({projectRef:null==B?void 0:B.ref,connectionString:null==B?void 0:B.connectionString,schema:null!==(n=null==H?void 0:H.schema)&&void 0!==n?n:void 0}),J=()=>{b(e=>({...e,filter:[]}))};return(0,r.jsx)("div",{className:(0,A.cn)("flex flex-col",s),style:{width:l||"100%",height:o||"50vh"},children:(0,r.jsx)(j.ZP,{ref:t,className:"".concat(i," flex-grow"),rowClass:d,columns:Z.gridColumns,rows:null!=u?u:[],renderers:{renderRow:P,noRowsFallback:(0,r.jsxs)("div",{style:{width:"calc(100vw - 255px - 55px)"},children:[f&&(0,r.jsx)(N.U,{}),y&&(0,r.jsx)("div",{className:"p-2 col-span-full",children:(0,r.jsx)(E.Z,{error:m,subject:"Failed to retrieve rows from table"})}),p&&(0,r.jsx)(r.Fragment,{children:0===(null!=v?v:[]).length?(0,r.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,r.jsx)("p",{className:"text-sm text-light",children:"This table is empty"}),void 0!==O&&void 0!==I&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-sm text-light mt-1",children:"Add rows to your table to get started."}),(0,r.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:void 0!==O&&void 0!==I&&(0,r.jsx)(L.z,{type:"default",onClick:()=>{var e,t;I(),K({action:w.b.IMPORT_DATA_BUTTON_CLICKED,properties:{tableType:"Existing Table"},groups:{project:null!==(e=null==B?void 0:B.ref)&&void 0!==e?e:"Unknown",organization:null!==(t=null==Y?void 0:Y.slug)&&void 0!==t?t:"Unknown"}})},children:"Import data from CSV"})})]})]}):(0,r.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,r.jsx)("p",{className:"text-sm text-light",children:"The filters applied have returned no results from this table"}),(0,r.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,r.jsx)(L.z,{type:"default",onClick:()=>J(),children:"Remove all filters"})})]})})]})},rowKeyGetter:q,selectedRows:Z.selectedRows,onColumnResize:function(e,t){D(e,t,F)},onRowsChange:M,onSelectedCellChange:function(e){U.current=e,F({type:"SELECTED_CELL_CHANGE",payload:{position:{idx:e.column.idx,rowIdx:e.rowIdx}}})},onSelectedRowsChange:function(e){F({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:e}})},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:r,targetTableName:a,targetColumnName:l}=null!==(n=null==H?void 0:null===(t=H.columns.find(t=>t.name==e))||void 0===t?void 0:t.foreignKey)&&void 0!==n?n:{},o=null==$?void 0:$.find(t=>t.source_schema===(null==H?void 0:H.schema)&&t.source_table===(null==H?void 0:H.name)&&t.source_columns.includes(e)&&t.target_schema===r&&t.target_table===a&&t.target_columns.includes(l));return void 0!==o?(0,C.S)([o])[0]:void 0}(t.name);n&&z({foreignKey:n,row:e,column:t})})(e.row,e.column)})})}));var F=n(6600),Z=n(56813),M=n(21482);function U(e,t,n){let r=(0,p.x4)(Z.E_,e),a=localStorage.getItem(r);if(a)return JSON.parse(a)[n&&"public"!=n?"".concat(n,".").concat(t):t]}async function W(e,t,n,r,a){var l,o;let s=e.projectRef?U(e.projectRef,e.table.name,e.table.schema):void 0;if(!t.isInitialComplete&&void 0===r&&void 0===a&&((null==s?void 0:s.sorts)||(null==s?void 0:s.filters)))return{savedState:{sorts:s.sorts,filters:s.filters}};let i=(0,M.cv)(e.table,{projectRef:e.projectRef,tableId:e.tableId,editable:e.editable,defaultWidth:null===(l=e.gridProps)||void 0===l?void 0:l.defaultColumnWidth,onAddColumn:e.editable?e.onAddColumn:void 0,onExpandJSONEditor:e.onExpandJSONEditor,onExpandTextEditor:e.onExpandTextEditor});return n({type:"INIT_TABLE",payload:{table:e.table,gridProps:e.gridProps,gridColumns:i,savedState:s,editable:e.editable,onError:null!==(o=e.onError)&&void 0!==o?o:e=>{console.error("Supabase grid error: ",e)}}}),{savedState:{}}}let H=e=>{let t=(0,p.cc)(e);return(0,r.jsx)(h.g3,{"data-sentry-element":"StoreProvider","data-sentry-component":"SupabaseGrid","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,r.jsx)(l.W,{backend:o.PD,context:window,"data-sentry-element":"DndProvider","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,r.jsx)(K,{...t,"data-sentry-element":"SupabaseGridLayout","data-sentry-source-file":"SupabaseGrid.tsx"})})})},K=e=>{var t,n,l;let{editable:o,projectRef:x,gridProps:g,headerActions:b,showCustomChildren:j,customHeader:_,children:w,onAddRow:N,onAddColumn:C,updateTableRow:E,onEditForeignKeyColumnValue:S,onImportData:k}=e,{id:R}=(0,i.UO)(),T=(0,h.I0)(),A=(0,h.Qq)(),L=(0,f._2)(),O=(0,a.useRef)(null),[P,q]=(0,a.useState)(!1),[{sort:D,filter:Z},M]=(0,u.x)({arrayKeys:["sort","filter"]}),U=(0,p.rg)(e.table.name,D),H=(0,p.Yb)(Z),K=(0,m.fN)(),{project:Y}=(0,c.d2)(),{data:B,error:$,isSuccess:J,isError:V,isLoading:G,isRefetching:Q}=(0,d.KK)({projectRef:null==Y?void 0:Y.ref,connectionString:null==Y?void 0:Y.connectionString,tableId:e.table.id,sorts:U,filters:H,page:L.page,limit:L.rowsPerPage,impersonatedRole:K.role},{keepPreviousData:!0,retryDelay:(e,t)=>{var n;return(t&&(null===(n=t.message)||void 0===n?void 0:n.includes("does not exist"))&&M(e=>({...e,sort:void 0})),e>3)?1/0:5e3},onSuccess(e){T({type:"SET_ROWS_COUNT",payload:e.rows.length})}});return(0,a.useEffect)(()=>{P||q(!0)},[]),(0,a.useEffect)(()=>{P&&T({type:"UPDATE_FILTERS",payload:{}})},[JSON.stringify(H)]),(0,a.useEffect)(()=>{P&&T({type:"UPDATE_SORTS",payload:{}})},[JSON.stringify(U)]),(0,a.useEffect)(()=>{A.isInitialComplete&&x&&A.table&&(0,p.Tf)(A,x,D,Z)},[A.table,A.isInitialComplete,A.gridColumns,JSON.stringify(U),JSON.stringify(H),x]),(0,a.useEffect)(()=>{T({type:"INIT_CALLBACK",payload:{...e}})},[]),(0,a.useEffect)(()=>{let t=async()=>{let{savedState:t}=await W({...e,tableId:R},A,T,D,Z);(t.sorts||t.filters)&&M(e=>({...e,...t.sorts&&{sort:t.sorts},...t.filters&&{filter:t.filters}}))},n=JSON.stringify(e.table)!==JSON.stringify(A.table);(!A.table||n)&&t()},[A.table,e.table,e.schema]),(0,r.jsxs)("div",{className:"sb-grid h-full flex flex-col","data-sentry-component":"SupabaseGridLayout","data-sentry-source-file":"SupabaseGrid.tsx",children:[(0,r.jsx)(F.ZP,{table:e.table,sorts:U,filters:H,onAddRow:o&&(null!==(t=e.table.columns)&&void 0!==t?t:[]).length>0?N:void 0,onAddColumn:o?C:void 0,onImportData:o?k:void 0,headerActions:b,customHeader:_,"data-sentry-element":"Header","data-sentry-source-file":"SupabaseGrid.tsx"}),j&&void 0!==w?(0,r.jsx)(r.Fragment,{children:w}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{ref:O,...g,rows:null!==(n=null==B?void 0:B.rows)&&void 0!==n?n:[],error:$,isLoading:G,isSuccess:J,isError:V,filters:H,setParams:M,updateRow:E,onAddRow:N,onImportData:k,onEditForeignKeyColumnValue:S}),(0,r.jsx)(v.Z,{isRefetching:Q}),(0,r.jsx)(y,{gridRef:O})]}),P&&(0,s.createPortal)((0,r.jsx)(I.q4,{rows:null!==(l=null==B?void 0:B.rows)&&void 0!==l?l:[]}),document.body)]})}},53365:function(e,t,n){n.d(t,{F:function(){return l}});var r=n(97458),a=n(14500);let l=e=>{let{children:t,side:n,align:l,options:o,onSelect:s}=e;return(0,r.jsxs)(a.h_,{"data-sentry-element":"DropdownMenu","data-sentry-component":"DropdownControl","data-sentry-source-file":"DropdownControl.tsx",children:[(0,r.jsx)(a.$F,{"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"DropdownControl.tsx",children:t}),(0,r.jsx)(a.AW,{side:n,align:l,"data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"DropdownControl.tsx",children:(0,r.jsxs)("div",{className:"dropdown-control",style:{maxHeight:"30vh"},children:[0===o.length&&(0,r.jsx)("p",{className:"dropdown-control__empty-text",children:"No more items"}),o.map(e=>(0,r.jsx)(a.Xi,{onClick:()=>s(e.value),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.preLabel&&(0,r.jsx)("span",{className:"grow text-foreground-lighter",children:e.preLabel}),(0,r.jsx)("span",{children:e.label}),e.postLabel&&(0,r.jsx)("span",{className:"text-foreground-lighter",children:e.postLabel})]})},e.value))]})})]})}},86086:function(e,t,n){n.d(t,{a:function(){return l}});var r=n(52983);function a(e,t){return e.indexOf(t)>=0}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[l,o]=r.useState(),s=r=>{if(!e||a(t,r.target.nodeName)||a(n,r.target.className))return;let l=r.metaKey&&r.shiftKey?"Command+Shift+".concat(r.key):r.metaKey?"Command+".concat(r.key):r.shiftKey&&"Enter"===r.key?"Shift+".concat(r.key):r.ctrlKey&&r.key?"Control+".concat(r.key):r.key;e[l]&&(l.includes("+")?(r.preventDefault(),e[l](r),o(null)):(o(r.key),r.preventDefault()))},i=t=>{e&&e[t.key]&&l===t.key&&(t.preventDefault(),e[t.key](t),o(null))};r.useEffect(()=>(window.addEventListener("keydown",s),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",s),window.removeEventListener("keyup",i)}))}},88841:function(e,t,n){n.d(t,{r:function(){return l}});var r=n(97458),a=n(85229);let l=e=>{let{width:t,height:n,value:l,language:o,readOnly:s=!1,onChange:i,onMount:c}=e;return(0,r.jsx)(a.default,{width:t,height:n||"200px",theme:"supabase",wrapperProps:{className:"grid-monaco-editor-container"},className:"grid-monaco-editor",defaultLanguage:o||"plaintext",defaultValue:l,onChange:i,onMount:function(e){e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})});let t=e.getModel().getPositionAt(null==l?void 0:l.length);e.setPosition(t),setTimeout(()=>{null==e||e.focus()},0),c&&c(e)},options:{readOnly:s,tabSize:2,fontSize:13,minimap:{enabled:!1},glyphMargin:!1,folding:!1,lineNumbers:"off",lineNumbersMinChars:0,scrollBeyondLastLine:!1,wordWrap:"on"},"data-sentry-element":"Editor","data-sentry-component":"MonacoEditor","data-sentry-source-file":"MonacoEditor.tsx"})}},99968:function(e,t,n){n.d(t,{Z:function(){return R}});var r=n(97458),a=n(12436),l=n(88971),o=n(17212),s=n(75308),i=n(39113),c=n(89199),d=n(53114),u=n(4951),m=n(50497),f=n(94289),p=n(96056),h=n(52983),x=n(27850),g=n(76059),y=n(24561),v=n(96226),b=n(90839),j=n(40577),_=n(85682),w=n(32002),N=n(98495),C=n(53365);let E=e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),n=t>4?"T":["","K","M","B","T"][t];return"".concat((e/Math.pow(1e3,t>4?4:t)).toFixed(1)).concat(n)},S=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}];var k=()=>{var e,t;let{id:n}=(0,a.UO)(),o=n?Number(n):void 0,s=(0,N.Qq)(),u=(0,N.I0)(),{project:k}=(0,l.d2)(),R=(0,v._2)(),{data:T}=(0,i.iB)({projectRef:null==k?void 0:k.ref,connectionString:null==k?void 0:k.connectionString,id:o}),A=(0,c.N3)(T)?T.live_rows_estimate:null,[{filter:L}]=(0,d.x)({arrayKeys:["filter"]}),O=(0,x.Yb)(L),I=R.page,P=(0,y.fN)(),[q,D]=(0,h.useState)(!1),[z,F]=(0,h.useState)(!1),[Z,M]=(0,h.useState)(!1),[U,W]=(0,h.useState)(I.toString());(0,h.useEffect)(()=>{W(String(I))},[I]);let{data:H,isLoading:K,isSuccess:Y,isError:B,isFetching:$}=(0,g.HS)({projectRef:null==k?void 0:k.ref,connectionString:null==k?void 0:k.connectionString,tableId:o,filters:O,enforceExactCount:R.enforceExactCount,impersonatedRole:P.role},{keepPreviousData:!0,onSuccess(e){u({type:"SET_ROWS_COUNT",payload:e.count})}}),J=(null==H?void 0:H.is_estimate)?E(H.count):null==H?void 0:H.count.toLocaleString(),V=Math.ceil((null!==(e=null==H?void 0:H.count)&&void 0!==e?e:0)/R.rowsPerPage),G=(null!==(t=null==H?void 0:H.count)&&void 0!==t?t:0)>0?V:1,Q=()=>{ee(),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})},X=()=>{et(),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})},ee=()=>{let e=I-1;R.setPage(e)},et=()=>{let e=I+1;R.setPage(e)},en=e=>{let t=e>V?V:e;R.setPage(t||1)};return(0,h.useEffect)(()=>{I&&I>G&&R.setPage(G)},[I,G]),(0,h.useEffect)(()=>{void 0!==o&&R.setEnforceExactCount(null!==A&&A<=g.Fi)},[o]),(0,r.jsxs)("div",{className:"flex items-center gap-x-4","data-sentry-component":"Pagination","data-sentry-source-file":"Pagination.tsx",children:[K&&(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading records count..."}),Y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(b.z,{icon:(0,r.jsx)(m.Z,{}),type:"outline",className:"px-1.5",disabled:I<=1||K,onClick:()=>{I>1&&(s.selectedRows.size>=1?F(!0):ee())}}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,r.jsx)(_.I,{className:"w-12",size:"tiny",min:1,max:V,value:U,onChange:e=>W(e.target.value),onKeyDown:e=>{let t=Number(U);"Enter"===e.code&&!Number.isNaN(t)&&t>=1&&t<=V&&en(t)}}),(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:["of ",G.toLocaleString()]}),(0,r.jsx)(b.z,{icon:(0,r.jsx)(f.Z,{}),type:"outline",className:"px-1.5",disabled:I>=V||K,onClick:()=>{I<V&&(s.selectedRows.size>=1?D(!0):et())}}),(0,r.jsx)(C.F,{options:S,onSelect:e=>{let t=Number(e);R.setRowsPerPage(isNaN(t)?100:t)},side:"top",align:"start",children:(0,r.jsx)(b.z,{asChild:!0,type:"outline",style:{padding:"3px 10px"},children:(0,r.jsx)("span",{children:"".concat(R.rowsPerPage," rows")})})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:["".concat(J," ").concat(0===H.count||H.count>1?"records":"record")," ",H.is_estimate?"(estimated)":""]}),H.is_estimate&&(0,r.jsxs)(j.u,{children:[(0,r.jsx)(j.aJ,{asChild:!0,children:(0,r.jsx)(b.z,{size:"tiny",type:"text",className:"px-1.5",loading:$,icon:(0,r.jsx)(p.Z,{}),onClick:()=>{null===A||H.count>g.Fi?M(!0):R.setEnforceExactCount(!0)}})}),(0,r.jsxs)(j._v,{side:"top",className:"w-72",children:["This is an estimated value as your table has more than"," ",g.Fi.toLocaleString()," rows. ",(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count of the table."})]})]})]})]}),B&&(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."}),(0,r.jsx)(w.Z,{visible:z,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>F(!1),onConfirm:()=>{Q()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,r.jsx)(w.Z,{visible:q,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>D(!1),onConfirm:()=>{X()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,r.jsx)(w.Z,{variant:"warning",visible:Z,title:"Confirm to fetch exact count for table",confirmLabel:"Retrieve exact count",onCancel:()=>M(!1),onConfirm:()=>{R.setEnforceExactCount(!0),M(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:null===A?"If your table has a row count of greater than ".concat(g.Fi.toLocaleString()," rows,\n          retrieving the exact count of the table may cause performance issues on your database."):"Your table has a row count of greater than ".concat(g.Fi.toLocaleString()," rows, and\n          retrieving the exact count of the table may cause performance issues on your database.")})})]})},R=e=>{let{isRefetching:t}=e,{project:n}=(0,l.d2)(),{id:m}=(0,a.UO)(),f=m?Number(m):void 0,{data:p}=(0,i.iB)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:f}),[{view:h="data"},x]=(0,d.x)(),g=(0,c.D1)(p),y=(0,c.N3)(p);return(0,r.jsxs)(o.x,{"data-sentry-element":"GridFooter","data-sentry-component":"Footer","data-sentry-source-file":"Footer.tsx",children:["data"===h&&(0,r.jsx)(k,{}),(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-x-2",children:[p&&"data"===h&&(0,r.jsx)(u.Z,{table:p,isRefetching:t}),(g||y)&&(0,r.jsx)(s.Z,{width:75,options:["definition","data"],activeOption:h,borderOverride:"border",onClickOption:e=>{"data"===e?x({view:void 0}):x({view:e})}})]})]})}},6600:function(e,t,n){n.d(t,{kI:function(){return D},m0:function(){return z}});var r=n(97458),a=n(198),l=n(12887),o=n.n(l),s=n(98601),i=n(26063),c=n(38273),d=n(74304),u=n(83145),m=n.n(u),f=n(49571),p=n.n(f),h=n(52983),x=n(34549),g=n(12436),y=n(30457),v=n(98495),b=n(99359),j=n(88971),_=n(359),w=n(76059),N=n(38650),C=n(82288),E=n(90817),S=n(75541),k=n(53114),R=n(24561),T=n(96226),A=n(14500),L=n(90839),O=n(65092),I=n(11221),P=n(2954),q=n(18669);let D=5e5,z=(0,r.jsxs)(r.Fragment,{children:["Sorry! We're unable to support exporting row counts larger than $",D.toLocaleString()," at the moment. Alternatively, you may consider using",(0,r.jsx)(m(),{href:"https://supabase.com/docs/reference/cli/supabase-db-dump",target:"_blank",children:"pg_dump"})," ","via our CLI instead."]});t.ZP=e=>{let{table:t,sorts:n,filters:a,onAddColumn:l,onAddRow:o,onImportData:s,headerActions:i,customHeader:c}=e,{selectedRows:d}=(0,v.Qq)();return(0,r.jsx)("div",{"data-sentry-component":"Header","data-sentry-source-file":"Header.tsx",children:(0,r.jsxs)("div",{className:"flex h-10 items-center justify-between bg-dash-sidebar px-1.5 py-1.5 gap-2 overflow-x-auto",children:[c?(0,r.jsx)(r.Fragment,{children:c}):(0,r.jsx)(r.Fragment,{children:d.size>0?(0,r.jsx)(Z,{table:t,sorts:n,filters:a}):(0,r.jsx)(F,{table:t,onAddColumn:l,onAddRow:o,onImportData:s})}),(0,r.jsx)("div",{className:"sb-grid-header__inner",children:i})]})})};let F=e=>{let{table:t,onAddColumn:n,onAddRow:l,onImportData:o}=e,{ref:d}=(0,g.UO)(),u=(0,S.l)(),m=(0,E.Xo)(a.KA.TENANT_SQL_ADMIN_WRITE,"columns"),[{filter:f,sort:p},h]=(0,k.x)({arrayKeys:["sort","filter"]}),{mutate:x}=(0,C.a)();return(0,r.jsxs)("div",{className:"flex items-center gap-4","data-sentry-component":"DefaultHeader","data-sentry-source-file":"Header.tsx",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(P.Z,{table:t,filters:f,setParams:h,"data-sentry-element":"FilterPopover","data-sentry-source-file":"Header.tsx"}),(0,r.jsx)(q.f,{table:t,sorts:p,setParams:h,"data-sentry-element":"SortPopover","data-sentry-source-file":"Header.tsx"})]}),(void 0!==l||void 0!==n)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-[20px] w-px border-r border-control"}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:m&&(0,r.jsxs)(A.h_,{children:[(0,r.jsx)(A.$F,{asChild:!0,children:(0,r.jsx)(L.z,{"data-testid":"table-editor-insert-new-row",type:"primary",size:"tiny",icon:(0,r.jsx)(s.Z,{strokeWidth:1.5}),children:"Insert"})}),(0,r.jsx)(A.AW,{side:"bottom",align:"start",children:[...void 0!==l?[(0,r.jsxs)(A.Xi,{className:"group space-x-2",onClick:l,children:[(0,r.jsxs)("div",{className:"-mt-2 pr-1.5",children:[(0,r.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px]"}),(0,r.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px] my-[2px]"}),(0,r.jsx)("div",{className:(0,O.cn)(["border border-foreground-light w-[15px] h-[4px] translate-x-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-x-0"])})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Insert row"}),(0,r.jsxs)("p",{className:"text-foreground-light",children:["Insert a new row into ",t.name]})]})]},"add-row")]:[],...void 0!==n?[(0,r.jsxs)(A.Xi,{className:"group space-x-2",onClick:n,children:[(0,r.jsxs)("div",{className:"flex -mt-2 pr-1.5",children:[(0,r.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px]"}),(0,r.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px] mx-[2px]"}),(0,r.jsx)("div",{className:(0,O.cn)(["border border-foreground-light w-[4px] h-[15px] -translate-y-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-y-0"])})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Insert column"}),(0,r.jsxs)("p",{className:"text-foreground-light",children:["Insert a new column into ",t.name]})]})]},"add-column")]:[],...void 0!==o?[(0,r.jsxs)(A.Xi,{className:"group space-x-2",onClick:()=>{var e;o(),x({action:y.b.IMPORT_DATA_BUTTON_CLICKED,properties:{tableType:"Existing Table"},groups:{project:null!=d?d:"Unknown",organization:null!==(e=null==u?void 0:u.slug)&&void 0!==e?e:"Unknown"}})},children:[(0,r.jsxs)("div",{className:"relative -mt-2",children:[(0,r.jsx)(i.Z,{size:18,strokeWidth:1.5,className:"-translate-x-[2px]"}),(0,r.jsx)(c.Z,{className:(0,O.cn)("transition duration-200 absolute bottom-0 right-0 translate-y-1 opacity-0 bg-brand-400 rounded-full","group-data-[highlighted]:translate-y-0 group-data-[highlighted]:text-brand group-data-[highlighted]:opacity-100"),strokeWidth:3,size:12})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Import data from CSV"}),(0,r.jsx)("p",{className:"text-foreground-light",children:"Insert new rows from a CSV"})]})]},"import-data")]:[]]})]})})]})]})},Z=e=>{var t,n;let{table:a,sorts:l,filters:i}=e,c=(0,v.Qq)(),u=(0,v.I0)(),{project:m}=(0,j.d2)(),f=(0,T._2)(),g=(0,R.fN)(),y=void 0!==g.role,[C,E]=(0,h.useState)(!1),{data:S}=(0,N.KK)({projectRef:null==m?void 0:m.ref,connectionString:null==m?void 0:m.connectionString,tableId:a.id,sorts:l,filters:i,page:f.page,limit:f.rowsPerPage,impersonatedRole:g.role}),{data:k}=(0,w.HS)({projectRef:null==m?void 0:m.ref,connectionString:null==m?void 0:m.connectionString,tableId:a.id,filters:i,enforceExactCount:f.enforceExactCount,impersonatedRole:g.role},{keepPreviousData:!0}),O=()=>{u({type:"SELECT_ALL_ROWS",payload:{selectedRows:new Set(F.map(e=>e.idx))}})};async function P(){if(E(!0),W&&Z>D)return x.Am.error((0,r.jsx)("div",{className:"prose text-sm text-foreground",children:z})),E(!1);if(!m)return x.Am.error("Project is required"),E(!1);let e=(W?await (0,N.wF)({projectRef:m.ref,connectionString:m.connectionString,table:a,filters:i,sorts:l,impersonatedRole:g.role}):F.filter(e=>M.has(e.idx))).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e)),t=new Blob([p().unparse(e,{columns:c.table.columns.map(e=>e.name)})],{type:"text/csv;charset=utf-8;"});o()(t,"".concat(c.table.name,"_rows.csv")),E(!1)}async function q(){if(E(!0),W&&Z>D)return x.Am.error((0,r.jsx)("div",{className:"prose text-sm text-foreground",children:z})),E(!1);if(!m)return x.Am.error("Project is required"),E(!1);let e=W?await (0,N.wF)({projectRef:m.ref,connectionString:m.connectionString,table:a,filters:i,sorts:l,impersonatedRole:g.role}):F.filter(e=>M.has(e.idx)),t=new Blob([(0,b.k)(a,e)],{type:"text/sql;charset=utf-8;"});o()(t,"".concat(c.table.name,"_rows.sql")),E(!1)}let F=null!==(t=null==S?void 0:S.rows)&&void 0!==t?t:[],Z=null!==(n=null==k?void 0:k.count)&&void 0!==n?n:0,{selectedRows:M,editable:U,allRowsSelected:W}=c;return(0,R.gv)(()=>{(W||M.size>0)&&u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2","data-sentry-component":"RowHeader","data-sentry-source-file":"Header.tsx",children:[U&&(0,r.jsx)(_.u,{type:"default",size:"tiny",icon:(0,r.jsx)(d.Z,{}),onClick:()=>{let e=W?Z:M.size,t=Array.from(M),n=F.filter(e=>t.includes(e.idx));f.onDeleteRows(n,{allRowsSelected:W,numRows:e,callback:()=>{u({type:"REMOVE_ROWS",payload:{rowIdxs:t}}),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})}})},disabled:W&&y,tooltip:{content:{side:"bottom",text:W&&y?"Table truncation is not supported when impersonating a role":void 0}},children:W?"Delete all rows in table":M.size>1?"Delete ".concat(M.size," rows"):"Delete ".concat(M.size," row")}),(0,r.jsxs)(A.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"Header.tsx",children:[(0,r.jsx)(A.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"Header.tsx",children:(0,r.jsx)(L.z,{type:"default",size:"tiny",iconRight:(0,r.jsx)(s.Z,{}),loading:C,disabled:C,"data-sentry-element":"Button","data-sentry-source-file":"Header.tsx",children:"Export"})}),(0,r.jsxs)(A.AW,{className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"Header.tsx",children:[(0,r.jsx)(A.Xi,{onClick:P,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:(0,r.jsx)("span",{className:"text-foreground-light",children:"Export to CSV"})}),(0,r.jsx)(A.Xi,{onClick:q,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:"Export to SQL"})]})]}),!W&&Z>F.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-6 ml-0.5",children:(0,r.jsx)(I.Z,{orientation:"vertical"})}),(0,r.jsx)(L.z,{type:"text",onClick:()=>O(),children:"Select all rows in table"})]})]})}},4951:function(e,t,n){var r=n(97458),a=n(36457),l=n(5211),o=n(12436),s=n(79790),i=n(90839);t.Z=e=>{let{table:t,isRefetching:n}=e,{ref:c}=(0,o.UO)(),d=(0,a.NL)(),u=s.s.tableRowsAndCount(c,t.id);async function m(){await d.invalidateQueries(u)}return(0,r.jsx)(i.z,{type:"text",loading:n,icon:(0,r.jsx)(l.Z,{className:"text-foreground-muted",strokeWidth:1.5}),onClick:()=>m(),"data-sentry-element":"Button","data-sentry-component":"RefreshButton","data-sentry-source-file":"RefreshButton.tsx",children:"Refresh"})}},2954:function(e,t,n){n.d(t,{Z:function(){return j}});var r=n(97458),a=n(58724),l=n.n(a),o=n(85466),s=n.n(o),i=n(41957),c=n(36950),d=n(52983),u=n(27850),m=n(42026),f=n(90839),p=n(94092),h=n(51571),x=n(53365),g=n(98601),y=n(98686),v=(0,d.memo)(e=>{var t,n;let{table:a,filter:l,filterIdx:o,onChange:s,onDelete:i,onKeyDown:c}=e,d=a.columns.find(e=>e.name===l.column),u=(null===(t=a.columns)||void 0===t?void 0:t.map(e=>({value:e.name,label:e.name,postLabel:e.dataType})))||[],m=(null==d?void 0:d.format)==="timestamptz"?"yyyy-mm-dd hh:mm:ss+zz":(null==d?void 0:d.format)==="timestamp"?"yyyy-mm-dd hh:mm:ss":"Enter a value";return(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-x-1 px-3","data-sentry-component":"FilterRow","data-sentry-source-file":"FilterRow.tsx",children:[(0,r.jsx)(x.F,{align:"start",options:u,onSelect:e=>s(o,{...l,column:e}),"data-sentry-element":"DropdownControl","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)(f.z,{asChild:!0,type:"outline",icon:(0,r.jsx)("div",{className:"text-foreground-lighter",children:(0,r.jsx)(g.Z,{strokeWidth:1.5})}),className:"w-32 justify-start","data-sentry-element":"Button","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)("span",{children:null!==(n=null==d?void 0:d.name)&&void 0!==n?n:""})})}),(0,r.jsx)(x.F,{align:"start",options:p.o,onSelect:e=>s(o,{...l,operator:e}),"data-sentry-element":"DropdownControl","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)(f.z,{asChild:!0,type:"outline",icon:(0,r.jsx)("div",{className:"text-foreground-lighter",children:(0,r.jsx)(g.Z,{strokeWidth:1.5})}),"data-sentry-element":"Button","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)("span",{children:l.operator})})}),(0,r.jsx)(h.Z,{size:"tiny",className:"w-full",placeholder:m,value:l.value,onChange:e=>s(o,{...l,value:e.target.value}),onKeyDown:c,"data-sentry-element":"Input","data-sentry-source-file":"FilterRow.tsx"}),(0,r.jsx)(f.z,{type:"text",className:"px-1",icon:(0,r.jsx)(y.Z,{strokeWidth:1.5}),onClick:()=>i(o),"data-sentry-element":"Button","data-sentry-source-file":"FilterRow.tsx"})]})}),b=n(96226),j=e=>{let{table:t,filters:n,setParams:a}=e,[l,o]=(0,d.useState)(!1),s=(0,b._2)(),c=(n||[]).length>0?"Filtered by ".concat(n.length," rule").concat(n.length>1?"s":""):"Filter";return(0,r.jsxs)(m.J2,{open:l,onOpenChange:o,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx",children:[(0,r.jsx)(m.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,r.jsx)(f.z,{type:(n||[]).length>0?"link":"text",icon:(0,r.jsx)(i.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:c})}),(0,r.jsx)(m.yk,{className:"p-0 w-96",side:"bottom",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,r.jsx)(_,{table:t,filters:n,onApplyFilters:e=>{s.setEnforceExactCount(!1),a(t=>({...t,filter:e.map(e=>{let t=p.o.find(t=>t.value===e.operator);return"".concat(e.column,":").concat(null==t?void 0:t.abbrev,":").concat(e.value)})}))},"data-sentry-element":"FilterOverlay","data-sentry-source-file":"FilterPopover.tsx"})})]})};let _=e=>{let{table:t,filters:n,onApplyFilters:a}=e,o=(0,d.useMemo)(()=>(0,u.Yb)(null!=n?n:[]),[n]),[i,p]=(0,d.useState)(o),h=(0,d.useCallback)((e,t)=>{p(n=>l()(n,{[e]:{$set:t}}))},[]),x=(0,d.useCallback)(e=>{p(t=>l()(t,{$splice:[[e,1]]}))},[]),g=()=>{let e=i.map(e=>{let n=t.columns.find(t=>t.name===e.column);return(null==n?void 0:n.format)==="uuid"?{...e,value:e.value.trim()}:e});p(e),a(e)};function y(e){"Enter"===e.key&&g()}return(0,r.jsxs)("div",{className:"space-y-2 py-2","data-sentry-component":"FilterOverlay","data-sentry-source-file":"FilterPopover.tsx",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[i.map((e,n)=>(0,r.jsx)(v,{table:t,filter:e,filterIdx:n,onChange:h,onDelete:x,onKeyDown:y},"filter-".concat(e.column,"-").concat([n]))),0==i.length&&(0,r.jsxs)("div",{className:"space-y-1 px-3",children:[(0,r.jsx)("h5",{className:"text-sm text-foreground-light",children:"No filters applied to this view"}),(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Add a column below to filter the view"})]})]}),(0,r.jsx)(m.Fm,{"data-sentry-element":"PopoverSeparator_Shadcn_","data-sentry-source-file":"FilterPopover.tsx"}),(0,r.jsxs)("div",{className:"px-3 flex flex-row justify-between",children:[(0,r.jsx)(f.z,{icon:(0,r.jsx)(c.Z,{}),type:"text",onClick:function(){var e;let n=null===(e=t.columns[0])||void 0===e?void 0:e.name;n&&p([...i,{column:n,operator:"=",value:""}])},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Add filter"}),(0,r.jsx)(f.z,{disabled:s()(i,o),type:"default",onClick:()=>g(),"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Apply filter"})]})]})}},98495:function(e,t,n){n.d(t,{g3:function(){return m},I0:function(){return p},Qq:function(){return f}});var r=n(52983),a=n(87595),l=n(56813),o=n(58724),s=n.n(o),i=n(54775);function c(e){let t=(0,i.I8)(e);return t.renderEditCell=e.renderEditCell,t.renderHeaderCell=e.renderHeaderCell,t.renderCell=e.renderCell,t.renderGroupCell=e.renderGroupCell,t}let d={table:null,isInitialComplete:!1,editable:!1,allRowsSelected:!1,onAddColumn:null,onAddRow:null,onError:null,onEditRow:null,onEditColumn:null,onDeleteColumn:null,gridColumns:[],rows:[],selectedRows:new Set,selectedCellPosition:null,totalRows:l.Vz},u=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=arguments.length>1?arguments[1]:void 0;for(let r=0;r<t.length;r++)e=t[r](e,n);return e}}((e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,table:t.payload.table,isInitialComplete:!0,editable:t.payload.editable||!1};case"UPDATE_FILTERS":{let t={...e};return t.page=1,t.totalRows=l.ZR,t}case"UPDATE_SORTS":return{...e};default:return e}},(e,t)=>"INIT_CALLBACK"===t.type?{...e,onAddColumn:t.payload.onAddColumn,onAddRow:t.payload.onAddRow,onError:t.payload.onError,onEditRow:t.payload.onEditRow,onEditColumn:t.payload.onEditColumn,onDeleteColumn:t.payload.onDeleteColumn}:e,(e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,gridColumns:function(e,t){let n=e;if(null==t?void 0:t.gridColumns){n=[];let r=t.gridColumns.filter(e=>(null==e?void 0:e.name)!=="");for(let t=0;t<r.length;t++){let a=r[t],l=e.find(e=>e.key===a.key);l&&n.push({...l,width:a.width,frozen:a.frozen})}let a=e.filter(e=>!r.find(t=>t.key===e.key)&&""!==e.name);n=n.concat(a);let o=e.find(e=>e.key===l.W);o&&(n=[o,...n]);let s=e.find(e=>e.key===l.uZ);s&&n.push(s)}return n}(t.payload.gridColumns,t.payload.savedState)};case"MOVE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.fromKey),r=e.gridColumns.findIndex(e=>e.key===t.payload.toKey),a=e.gridColumns[n];return{...e,gridColumns:s()(e.gridColumns,{$splice:[[n,1],[r,0,a]]})}}case"UPDATE_COLUMN_SIZE":{let n=c(e.gridColumns[t.payload.index]);return n.width=t.payload.width,{...e,gridColumns:s()(e.gridColumns,{[t.payload.index]:{$set:n}})}}case"FREEZE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),r=c(e.gridColumns[n]);return r.frozen=!0,{...e,gridColumns:s()(e.gridColumns,{[n]:{$set:r}})}}case"UNFREEZE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),r=c(e.gridColumns[n]);return r.frozen=!1,{...e,gridColumns:s()(e.gridColumns,{[n]:{$set:r}})}}case"UPDATE_COLUMN_IDX":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),r=c(e.gridColumns[n]);return r.idx=t.payload.columnIdx,{...e,gridColumns:s()(e.gridColumns,{[n]:{$set:r}}).sort((e,t)=>e.idx-t.idx)}}default:return e}},(e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,selectedCellPosition:null,selectedRows:new Set,totalRows:l.ZR};case"SELECTED_CELL_CHANGE":return{...e,selectedCellPosition:t.payload.position};case"SELECTED_ROWS_CHANGE":return{...e,allRowsSelected:!1,selectedRows:t.payload.selectedRows};case"SELECT_ALL_ROWS":return{...e,allRowsSelected:!0,selectedRows:t.payload.selectedRows};case"SET_ROWS":return{...e,rows:t.payload.rows};case"SET_ROWS_COUNT":return{...e,totalRows:t.payload};default:return e}}),{Provider:m,useTrackedState:f,useUpdate:p}=(0,a.fH)(()=>(0,r.useReducer)(u,d))},21482:function(e,t,n){n.d(t,{i1:function(){return eA},ve:function(){return eO},cv:function(){return eL}});var r=n(97458),a=n(56813),l=n(98495),o=n(5079);let s=e=>{let{row:t,column:n,isNullable:a,onRowChange:s,onClose:i}=e,c=(0,l.Qq)().gridColumns.find(e=>e.name==n.key),d=t[n.key];return(0,r.jsxs)(o.ZP,{autoFocus:!0,id:"boolean-editor",name:"boolean-editor",size:"small",onBlur:()=>i(!1),onChange:e=>{let r=e.target.value;"null"===r?s({...t,[n.key]:null},!0):s({...t,[n.key]:"true"===r},!0)},defaultValue:null===d?"null":d.toString(),style:{width:"".concat((null==c?void 0:c.width)||n.width,"px")},"data-sentry-element":"Select","data-sentry-component":"BooleanEditor","data-sentry-source-file":"BooleanEditor.tsx",children:[(0,r.jsx)(o.ZP.Option,{value:"true","data-sentry-element":"unknown","data-sentry-source-file":"BooleanEditor.tsx",children:"TRUE"}),(0,r.jsx)(o.ZP.Option,{value:"false","data-sentry-element":"unknown","data-sentry-source-file":"BooleanEditor.tsx",children:"FALSE"}),a&&(0,r.jsx)(o.ZP.Option,{value:"null",children:"NULL"})]})};var i=n(28977),c=n.n(i),d=n(98601),u=n(52983),m=n(42026),f=n(65092),p=n(90839),h=n(14500),x=n(54354),g=n(85682);let y=e=>{let[t,n]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{let t=t=>{e.current&&!e.current.contains(t.target)?n(!0):n(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e]),t},v=e=>{let{value:t,children:n,onEscape:a,onEnter:l,ignoreOutsideClicks:o=!1}=e,s=(0,u.useRef)(null),i=y(s),c=(0,u.useCallback)(e=>{switch(e.key){case"Escape":e.stopPropagation(),a&&a(t);break;case"Enter":e.stopPropagation(),!e.shiftKey&&l&&(e.preventDefault(),l(t))}},[t]);return(0,u.useEffect)(()=>{!o&&i&&void 0!==l&&l(t)},[i]),(0,r.jsx)("div",{ref:s,onKeyDown:c,"data-sentry-component":"BlockKeys","data-sentry-source-file":"BlockKeys.tsx",children:n})},b={date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss",datetimetz:"YYYY-MM-DD HH:mm:ss+ZZ"};function j(e){let{row:t,column:n,type:a,isNullable:l,onRowChange:o,onClose:s}=e,i=(0,u.useRef)(null),y=b[a],j=t[n.key],[_,w]=(0,u.useState)(j),N=_?Number(c()(_,y)):_,C=e=>{("string"!=typeof e||0!==e.length)&&"Invalid Date"!==N&&o({...t,[n.key]:e},!0)},E=()=>{C(c()().format("date"===a?"YYYY-MM-DD":"datetimetz"===a?"YYYY-MM-DDTHH:mm:ssZ":"YYYY-MM-DDTHH:mm:ss"))};return(0,u.useEffect)(()=>{var e,t;try{null===(e=i.current)||void 0===e||e.focus({preventScroll:!0})}catch(e){null===(t=i.current)||void 0===t||t.focus()}},[]),(0,r.jsxs)(m.J2,{open:!0,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"BaseEditor","data-sentry-source-file":"DateTimeEditor.tsx",children:[(0,r.jsx)(m.xo,{"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"DateTimeEditor.tsx",children:(0,r.jsx)("div",{className:(0,f.cn)("px-[8px]",null===j?"text-foreground-lighter":""),children:null===j?"NULL":j})}),(0,r.jsxs)(m.yk,{align:"start",className:"p-0 rounded-none w-64","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"DateTimeEditor.tsx",children:[(0,r.jsx)(v,{ignoreOutsideClicks:!0,value:_,onEscape:()=>s(!1),onEnter:C,"data-sentry-element":"BlockKeys","data-sentry-source-file":"DateTimeEditor.tsx",children:(0,r.jsx)(g.I,{ref:i,value:null!=_?_:"",placeholder:y,onChange:e=>w(e.target.value),className:"border-0 rounded-none bg-dash-sidebar outline-none !ring-0 !ring-offset-0","data-sentry-element":"Input","data-sentry-source-file":"DateTimeEditor.tsx"})}),(0,r.jsxs)("div",{className:"px-3 py-1 flex flex-col gap-y-0.5",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Formatted value:"}),0===(null!=_?_:"").length?(0,r.jsx)("p",{className:"text-sm font-mono text-foreground-light",children:"Enter a valid date format"}):"Invalid Date"===N?(0,r.jsx)("p",{className:"text-sm font-mono text-foreground-light",children:"Invalid date format"}):"datetimetz"===a?(0,r.jsx)(x.c,{displayAs:"utc",utcTimestamp:N,labelFormat:"DD MMM YYYY HH:mm:ss (ZZ)",className:"text-left !text-sm font-mono tracking-tight"}):(0,r.jsx)("p",{className:"text-sm font-mono tracking-tight",children:(0,x.w)({utcTimestamp:N,format:"date"===a?"DD MMM YYYY":"datetime"===a?"DD MMM YYYY HH:mm:ss":void 0})})]}),(0,r.jsxs)("div",{className:"px-3 pt-1 pb-2 flex justify-between gap-x-1",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1.5 h-[22px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:""})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1 h-[22px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,r.jsx)("div",{className:"flex",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.z,{type:"default",className:"rounded-r-none",onClick:()=>C(null),children:"Set NULL"}),(0,r.jsxs)(h.h_,{children:[(0,r.jsx)(h.$F,{asChild:!0,children:(0,r.jsx)(p.z,{type:"default",icon:(0,r.jsx)(d.Z,{}),className:"px-1 rounded-l-none border-l-0"})}),(0,r.jsx)(h.AW,{className:"w-20",align:"end",children:(0,r.jsx)(h.Xi,{onClick:E,children:"Set to NOW"})})]})]}):(0,r.jsx)(p.z,{type:"default",onClick:E,children:"Set to NOW"})})]})]})]})}function _(e,t){return n=>(0,r.jsx)(j,{...n,type:e,isNullable:t})}var w=n(47592),N=n(34549),C=n(12436),E=n(39113),S=n(89199),k=n(36592),R=n(38650),T=n(62432),A=n(45536),L=n(4526),O=n(40577),I=n(88841);let P=()=>(0,r.jsx)("span",{className:"null-value opacity-50","data-sentry-component":"NullValue","data-sentry-source-file":"NullValue.tsx",children:"NULL"}),q=e=>{let{isLoading:t,loadFullValue:n}=e;return(0,r.jsxs)("div",{className:(0,f.cn)("absolute top-0 left-0 flex items-center justify-center flex-col gap-y-3","text-xs w-full h-full px-3 text-center","bg-default/80 backdrop-blur-[1.5px]"),"data-sentry-component":"TruncatedWarningOverlay","data-sentry-source-file":"TruncatedWarningOverlay.tsx",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,r.jsxs)("p",{children:["Value is larger than ",R.no.toLocaleString()," characters"]}),(0,r.jsx)("p",{className:"text-foreground-light",children:"You may try to render the entire value, but your browser may run into performance issues"})]}),(0,r.jsx)(p.z,{type:"default",loading:t,onClick:n,"data-sentry-element":"Button","data-sentry-source-file":"TruncatedWarningOverlay.tsx",children:"Load full value"})]})},D=e=>{try{return JSON.parse(e),!0}catch(e){return!1}},z=e=>{try{let t=JSON.parse(e);return JSON.stringify(t)}catch(t){if("string"==typeof e)return e.replaceAll('"','"');return JSON.stringify(e)}},F=e=>{let{row:t,column:n,isEditable:a=!0,onRowChange:o,onExpandEditor:s}=e,i=(0,l.Qq)(),{id:c}=(0,C.UO)(),d=c?Number(c):void 0,m=(0,T.Vm)(),{data:f}=(0,E.iB)({projectRef:null==m?void 0:m.ref,connectionString:null==m?void 0:m.connectionString,id:d}),p=i.gridColumns.find(e=>e.name==n.key),h=t[n.key],x=null==h||"string"==typeof h?h:JSON.stringify(h),g=(0,A.ZO)(x?z(x):""),y="string"==typeof x&&x.endsWith("...")&&x.length>R.no,[b,j]=(0,u.useState)(!0),[_,F]=(0,u.useState)(g),{mutate:Z,isLoading:M,isSuccess:U}=(0,k.rp)(),W=(0,u.useCallback)(()=>{a&&o(t,!0),j(!1)},[]),H=(0,u.useCallback)(e=>{(null!==e?(0,A.tT)(e):e)!==_?Y(e):j(!1)},[U]),K=()=>{W(),s(n.key,{...t,[n.key]:(0,A.dW)(_)||t[n.key]})},Y=e=>{if(a){if(e){if(D(e)){let r=JSON.parse(e);o({...t,[n.key]:r},!0),j(!1)}else{let{onError:e}=i;e&&e(Error("Please enter a valid JSON"))}}else o({...t,[n.key]:null},!0),j(!1)}};return(0,r.jsx)(L.Z,{open:b,side:"bottom",align:"start",sideOffset:-35,className:"rounded-none",overlay:y&&!U?(0,r.jsxs)("div",{style:{width:"".concat((null==p?void 0:p.width)||n.width,"px")},className:"flex items-center justify-center flex-col relative",children:[(0,r.jsx)(I.r,{readOnly:!0,onChange:()=>{},width:"".concat((null==p?void 0:p.width)||n.width,"px"),value:null!=_?_:"",language:"markdown"}),(0,r.jsx)(q,{isLoading:M,loadFullValue:()=>{if(void 0===f||void 0===m||!(0,S.N3)(f))return;if(0===f.primary_keys.length)return(0,N.Am)("Unable to load value as table has no primary keys");let e=f.primary_keys.reduce((e,n)=>({...e,[n.name]:t[n.name]}),{});Z({table:{schema:f.schema,name:f.name},column:n.name,pkMatch:e,projectRef:null==m?void 0:m.ref,connectionString:null==m?void 0:m.connectionString},{onSuccess:e=>{F(JSON.stringify(e))}})}})]}):(0,r.jsxs)(v,{value:_,onEscape:W,onEnter:H,children:[(0,r.jsx)(I.r,{width:"".concat((null==p?void 0:p.width)||n.width,"px"),value:null!=_?_:"",language:"json",readOnly:!a,onChange:e=>{a&&(e&&""!=e?F(e):F(null))}}),(0,r.jsxs)("div",{className:"flex items-start justify-between p-2 bg-surface-200 gap-x-2",children:[a&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1.5 py-[2.5px] rounded bg-selection border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:""})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1 py-[2.5px] rounded bg-selection border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,r.jsxs)(O.u,{children:[(0,r.jsx)(O.aJ,{asChild:!0,children:(0,r.jsx)("div",{className:"border border-strong rounded p-1 flex items-center justify-center transition cursor-pointer bg-selection hover:bg-border-strong",onClick:()=>K(),children:(0,r.jsx)(w.Z,{size:12,strokeWidth:2})})}),(0,r.jsx)(O._v,{side:"bottom",align:"center",children:(0,r.jsx)("span",{children:"Expand editor"})})]})]})]}),"data-sentry-element":"Popover","data-sentry-component":"JsonEditor","data-sentry-source-file":"JsonEditor.tsx",children:(0,r.jsx)("div",{className:"".concat(_&&0==g.trim().length?"sb-grid-fill-container":""," sb-grid-json-editor__trigger"),onClick:()=>j(!b),children:null===_||""===_?(0,r.jsx)(P,{}):g})})};function Z(e){null==e||e.focus(),null==e||e.select()}function M(e){let{row:t,column:n,onRowChange:a,onClose:l}=e,o=t[n.key];return(0,r.jsx)("input",{className:"sb-grid-number-editor",ref:Z,value:null!=o?o:"",onChange:function(e){let r=e.target.value;""===r?a({...t,[n.key]:null}):a({...t,[n.key]:r})},onBlur:function(){l(!0)},type:"number","data-sentry-component":"NumberEditor","data-sentry-source-file":"NumberEditor.tsx"})}function U(e){let{row:t,column:n,onRowChange:a,onClose:s,options:i,isNullable:c}=e,d=(0,l.Qq)().gridColumns.find(e=>e.name==n.key),u=t[n.key];return(0,r.jsxs)(o.ZP,{autoFocus:!0,id:"select-editor",name:"select-editor",size:"small",defaultValue:null!=u?u:"",className:"sb-grid-select-editor !gap-2",style:{width:"".concat((null==d?void 0:d.width)||n.width,"px")},onChange:function(e){e.target.value&&""!=e.target.value?a({...t,[n.key]:e.target.value},!0):a({...t,[n.key]:null},!0)},onBlur:function(){s(!1)},"data-sentry-element":"Select","data-sentry-component":"SelectEditor","data-sentry-source-file":"SelectEditor.tsx",children:[c&&(0,r.jsx)(o.ZP.Option,{value:"",children:"NULL"}),i.map(e=>{let{label:t,_value:n}=e;return(0,r.jsx)(o.ZP.Option,{value:n,selected:n===u,children:t},n)})]})}var W=n(32002);let H=()=>(0,r.jsx)("span",{className:"sb-grid-empty-value opacity-50","data-sentry-component":"EmptyValue","data-sentry-source-file":"EmptyValue.tsx",children:"EMPTY"}),K=e=>{let{row:t,column:n,isNullable:a,isEditable:o,onRowChange:s,onExpandEditor:i}=e,c=(0,l.Qq)(),{id:d}=(0,C.UO)(),m=d?Number(d):void 0,h=(0,T.Vm)(),{data:x}=(0,E.iB)({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString,id:m}),g=c.gridColumns.find(e=>e.name==n.key),y=t[n.key],b=y?String(y):null,[j,_]=(0,u.useState)(!0),[A,D]=(0,u.useState)(b),[z,F]=(0,u.useState)(!1),{mutate:Z,isLoading:M,isSuccess:U}=(0,k.rp)(),K="string"==typeof b&&b.endsWith("...")&&b.length>R.no,Y=(0,u.useCallback)(()=>{o&&s(t,!0),_(!1)},[]),B=(0,u.useCallback)(e=>{o&&e!==A&&s({...t,[n.key]:e},!0),_(!1)},[U]),$=()=>{Y(),i(n.key,{...t,[n.key]:A||t[n.key]})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.Z,{open:j,side:"bottom",align:"start",sideOffset:-35,className:"rounded-none",overlay:K&&!U?(0,r.jsxs)("div",{style:{width:"".concat((null==g?void 0:g.width)||n.width,"px")},className:"flex items-center justify-center flex-col relative",children:[(0,r.jsx)(I.r,{readOnly:!0,onChange:()=>{},width:"".concat((null==g?void 0:g.width)||n.width,"px"),value:null!=A?A:"",language:"markdown"}),(0,r.jsx)(q,{isLoading:M,loadFullValue:()=>{if(void 0===x||void 0===h||!(0,S.N3)(x))return;if(0===x.primary_keys.length)return(0,N.Am)("Unable to load value as table has no primary keys");let e=x.primary_keys.reduce((e,n)=>({...e,[n.name]:t[n.name]}),{});Z({table:{schema:x.schema,name:x.name},column:n.name,pkMatch:e,projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString},{onSuccess:e=>D(e)})}})]}):(0,r.jsxs)(v,{value:A,onEscape:Y,onEnter:B,ignoreOutsideClicks:z,children:[(0,r.jsx)(I.r,{width:"".concat((null==g?void 0:g.width)||n.width,"px"),value:null!=A?A:"",readOnly:!o,onChange:e=>{o&&(e?D(e):D(""))}}),o&&(0,r.jsxs)("div",{className:"flex items-start justify-between p-2 bg-surface-200 space-x-2",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1.5 py-[2.5px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:""})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1 py-[2.5px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-y-1",children:[(0,r.jsxs)(O.u,{children:[(0,r.jsx)(O.aJ,{asChild:!0,children:(0,r.jsx)(p.z,{type:"default",className:"px-1",onClick:()=>$(),icon:(0,r.jsx)(w.Z,{size:12,strokeWidth:2})})}),(0,r.jsx)(O._v,{side:"bottom",children:"Expand editor"})]}),a&&(0,r.jsx)(p.z,{size:"tiny",type:"default",htmlType:"button",onClick:()=>F(!0),children:"Set to NULL"})]})]})]}),"data-sentry-element":"Popover","data-sentry-source-file":"TextEditor.tsx",children:(0,r.jsx)("div",{className:(0,f.cn)(!!A&&0===A.toString().trim().length&&"sb-grid-fill-container","sb-grid-text-editor__trigger"),onClick:()=>_(!j),children:null===A?(0,r.jsx)(P,{}):""===A?(0,r.jsx)(H,{}):A})}),(0,r.jsx)(W.Z,{visible:z,title:"Confirm setting value to NULL",confirmLabel:"Confirm",onCancel:()=>F(!1),onConfirm:()=>{B(null)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"TextEditor.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you wish to set this value to NULL? This action cannot be undone."})})]})};var Y=n(97214),B=n.n(Y);function $(e){null==e||e.focus(),null==e||e.select()}c().extend(B());let J="HH:mm:ss";function V(e){let{row:t,column:n,format:a,onRowChange:l,onClose:o}=e,s=t[n.key],i=s?c()(s,a).format(J):s;return(0,r.jsx)("input",{className:"sb-grid-time-editor",ref:$,value:null!=i?i:"",onChange:function(e){let r=e.target.value;if(""==r)l({...t,[n.key]:null});else{let e=c()(r,J).format(a);l({...t,[n.key]:e})}},onBlur:()=>o(!0),type:"time",step:"1","data-sentry-component":"BaseEditor","data-sentry-source-file":"TimeEditor.tsx"})}function G(e){return(0,r.jsx)(V,{...e,format:"HH:mm:ss","data-sentry-element":"BaseEditor","data-sentry-component":"TimeEditor","data-sentry-source-file":"TimeEditor.tsx"})}function Q(e){return(0,r.jsx)(V,{...e,format:"HH:mm:ssZZ","data-sentry-element":"BaseEditor","data-sentry-component":"TimeWithTimezoneEditor","data-sentry-source-file":"TimeEditor.tsx"})}var X=n(42533);let ee=e=>{let t=e.row[e.column.key];if(!t)return(0,r.jsx)(P,{});let n=(0,X.D4)(t);return(0,r.jsx)(r.Fragment,{children:n})},et=e=>{let t=e.row[e.column.key];return null===t?(0,r.jsx)(P,{}):(0,r.jsx)(r.Fragment,{children:t?"TRUE":"FALSE"})},en=e=>{let t=e.row[e.column.key];return null===t?(0,r.jsx)(P,{}):""===t?(0,r.jsx)(H,{}):(("object"==typeof t||Array.isArray(t))&&(t=JSON.stringify(t)),(0,r.jsx)(r.Fragment,{children:t}))};var er=n(94289),ea=n(88971),el=n(359),eo=n(79581),es=n(52139),ei=n(44914),ec=n(83462),ed=n(89129);let eu=e=>{var t,n;let{table:l,column:o,value:s}=e,{ref:i}=(0,C.UO)(),c=(0,T.Vm)(),{data:d,error:u,isSuccess:m,isError:h,isLoading:x}=(0,R.KK)({projectRef:null==c?void 0:c.ref,connectionString:null==c?void 0:c.connectionString,tableId:l.id,filters:[{column:o,operator:"=",value:s}],page:1,limit:10},{keepPreviousData:!0}),g=l.primary_keys.map(e=>e.name),y=(null!==(t=null==l?void 0:l.columns)&&void 0!==t?t:[]).map(e=>{let t=eO({dataType:e.data_type,format:e.format}),n=(e.name.length+e.format.length)*eA,l=g.includes(e.name);return{key:e.name,name:e.name,resizable:!1,draggable:!1,sortable:!1,width:t<n?n:t,minWidth:a.mr,headerCellClass:"outline-none !shadow-none",renderHeaderCell:()=>(0,r.jsxs)("div",{className:"flex h-full items-center justify-center gap-x-2",children:[l&&(0,r.jsxs)(O.u,{children:[(0,r.jsx)(O.aJ,{children:(0,r.jsx)(es.Z,{size:14,strokeWidth:2,className:"text-brand rotate-45"})}),(0,r.jsx)(O._v,{side:"bottom",children:"Primary key"})]}),(0,r.jsx)("span",{className:"text-xs truncate",children:e.name}),(0,r.jsx)("span",{className:"text-xs text-foreground-light font-normal",children:e.format})]}),renderCell:t=>{let{column:n,row:a}=t,l=a[n.name],o="bytea"===e.format?(0,X.D4)(l):l;return(0,r.jsx)("div",{className:(0,f.cn)("flex items-center h-full w-full whitespace-pre",null===o&&"text-foreground-lighter"),children:null===o?"NULL":o})}}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{className:"px-2 py-2 text-xs text-foreground-light border-b",children:["Referencing record from"," ",(0,r.jsxs)("span",{className:"text-foreground",children:[l.schema,".",l.name]}),":"]}),(0,r.jsx)(ei.ZP,{className:"h-32 rounded-b border-0",columns:y,rows:null!==(n=null==d?void 0:d.rows)&&void 0!==n?n:[],onCellDoubleClick:(e,t)=>{t.preventDefault(),t.stopPropagation()},renderers:{noRowsFallback:(0,r.jsxs)("div",{className:"w-96 px-2",children:[x&&(0,r.jsx)("div",{className:"py-2",children:(0,r.jsx)(ed.Z,{})}),h&&(0,r.jsxs)("p",{className:"text-foreground-light",children:["Failed to find referencing row: ",u.message]}),m&&(0,r.jsx)("p",{className:"text-foreground-light",children:"No results were returned"})]})},"data-sentry-element":"DataGrid","data-sentry-source-file":"ReferenceRecordPeek.tsx"}),(0,r.jsx)("div",{className:"flex items-center justify-end px-2 py-1",children:(0,r.jsx)(ec.Sf,{href:"/project/".concat(i,"/editor/").concat(l.id,"?schema=").concat(l.schema,"&filter=").concat(o,"%3Aeq%3A").concat(s),projectRef:i,id:String(l.id),filters:[{column:o,operator:"=",value:String(s)}],"data-sentry-element":"EditorTablePageLink","data-sentry-source-file":"ReferenceRecordPeek.tsx",children:(0,r.jsx)(p.z,{type:"default","data-sentry-element":"Button","data-sentry-source-file":"ReferenceRecordPeek.tsx",children:"Open table"})})})]})},em=e=>{var t;let{project:n}=(0,ea.d2)(),{tableId:a,row:l,column:o}=e,s=a?Number(a):void 0,{data:i}=(0,E.iB)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:s}),c=null==i?void 0:i.columns.find(e=>e.name===o.key),d=(0,S.N3)(i)?i:void 0,u=(null!==(t=null==d?void 0:d.relationships)&&void 0!==t?t:[]).find(e=>e.source_schema===(null==d?void 0:d.schema)&&e.source_table_name===(null==d?void 0:d.name)&&e.source_column_name===o.name),{data:f}=(0,eo.Bj)({projectRef:null==n?void 0:n.ref,includeColumns:!0,connectionString:null==n?void 0:n.connectionString,schema:null==u?void 0:u.target_table_schema}),p=null==f?void 0:f.find(e=>e.schema===(null==u?void 0:u.target_table_schema)&&e.name===u.target_table_name),h=l[o.key],x=(null==c?void 0:c.format)==="bytea"&&h?(0,X.D4)(h):h;return(0,r.jsxs)("div",{className:"sb-grid-foreign-key-formatter flex justify-between","data-sentry-component":"ForeignKeyFormatter","data-sentry-source-file":"ForeignKeyFormatter.tsx",children:[(0,r.jsx)("span",{className:"sb-grid-foreign-key-formatter__text",children:null===x?(0,r.jsx)(P,{}):x}),void 0!==u&&void 0!==p&&null!==x&&(0,r.jsxs)(m.J2,{children:[(0,r.jsx)(m.xo,{asChild:!0,children:(0,r.jsx)(el.u,{type:"default",className:"w-6 h-6",icon:(0,r.jsx)(er.Z,{}),onClick:e=>e.stopPropagation(),tooltip:{content:{side:"bottom",text:"View referencing record"}}})}),(0,r.jsx)(m.yk,{portal:!0,align:"end",className:"p-0 w-96",children:(0,r.jsx)(eu,{table:p,column:u.target_column_name,value:x})})]})]})},ef=e=>{let t=e.row[e.column.key];if(null===t)return(0,r.jsx)(P,{});if(""===t)return(0,r.jsx)(H,{});if("string"==typeof t&&t.endsWith("..."))return(0,r.jsx)(r.Fragment,{children:t});try{let e=JSON.parse(t);return(0,r.jsx)(r.Fragment,{children:JSON.stringify(e)})}catch(e){return(0,r.jsx)(r.Fragment,{children:JSON.stringify(t)})}};var ep=n(36950);let eh={key:a.uZ,name:"",idx:999,width:100,maxWidth:100,resizable:!1,sortable:!1,frozen:!1,isLastFrozenColumn:!1,renderHeaderCell:()=>(0,r.jsx)(ex,{"aria-label":"Add New Row"}),renderCell:en,parent:void 0,level:0,minWidth:0,draggable:!1},ex=e=>{let{}=e,{onAddColumn:t}=(0,l.Qq)();return(0,r.jsx)("div",{className:"sb-grid-add-column","data-sentry-component":"AddColumnHeader","data-sentry-source-file":"AddColumn.tsx",children:(0,r.jsx)(p.z,{block:!0,type:"text",onClick:t,icon:(0,r.jsx)(ep.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"AddColumn.tsx"})})};var eg=n(11024),ey=n(60964),ev=n(17751),eb=n(37555),ej=n(17555),e_=n(87882),ew=n(8836);function eN(e){let{column:t,columnType:n,isPrimaryKey:a,isEncrypted:o,format:s,foreignKey:i}=e,c=(0,u.useRef)(null),d=(0,l.I0)(),m=t.idx,f=t.key,p="array"==n?"".concat(s.replace("_",""),"[]"):s,h=(0,l.Qq)(),x=t.name;(0,u.useEffect)(()=>{h.gridColumns[m].key!=f&&d({type:"UPDATE_COLUMN_IDX",payload:{columnKey:f,columnIdx:m}})},[f,m,h.gridColumns]);let[{isDragging:g},y]=(0,ev.c)({type:"column-header",item:()=>({key:f,index:m}),canDrag:()=>!t.frozen,collect:e=>({isDragging:e.isDragging()})}),[{handlerId:v},b]=(0,eb.L)({accept:"column-header",collect:e=>({handlerId:e.getHandlerId()}),hover(e,n){var r;if(!c.current||t.frozen)return;let a=e.index,l=e.key;if(a===m)return;let o=null===(r=c.current)||void 0===r?void 0:r.getBoundingClientRect(),s=(o.right-o.left)/2,i=n.getClientOffset().x-o.left;a<m&&i<s||a>m&&i>s||(j(l,f),e.index=m)}}),j=(e,t)=>{e!=t&&d({type:"MOVE_COLUMN",payload:{fromKey:e,toKey:t}})},_=t.frozen?"sb-grid-column-header--cursor":"";return y(b(c)),(0,r.jsx)("div",{ref:c,"data-handler-id":v,style:{opacity:g?0:1},className:"w-full","data-sentry-component":"ColumnHeader","data-sentry-source-file":"ColumnHeader.tsx",children:(0,r.jsxs)("div",{className:"sb-grid-column-header ".concat(_),children:[(0,r.jsxs)("div",{className:"sb-grid-column-header__inner",children:[function(e,t){let{name:n,foreignKey:a}=t;return"foreign_key"===e?(0,r.jsxs)(O.u,{children:[(0,r.jsx)(O.aJ,{children:(0,r.jsx)(ey.Z,{size:14,strokeWidth:2})}),(0,r.jsx)(O._v,{side:"bottom",children:(0,r.jsxs)("div",{className:"font-normal",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Foreign key relation:"}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("p",{className:"text-xs !text-foreground",children:n}),(0,r.jsx)(er.Z,{size:14,strokeWidth:1.5,className:"!text-foreground-light"}),(0,r.jsxs)("p",{className:"text-xs !text-foreground",children:[null==a?void 0:a.targetTableSchema,".",null==a?void 0:a.targetTableName,".",null==a?void 0:a.targetColumnName]})]}),(null==a?void 0:a.updateAction)!==e_.N.NO_ACTION&&(0,r.jsxs)("p",{className:"text-xs !text-foreground mt-1",children:["On update: ",(0,ej.s8)(null==a?void 0:a.updateAction)]}),(null==a?void 0:a.deletionAction)!==e_.N.NO_ACTION&&(0,r.jsxs)("p",{className:"text-xs !text-foreground mt-1",children:["On delete: ",(0,ej.s8)(null==a?void 0:a.deletionAction)]})]})})]}):null}(n,{name:t.name,foreignKey:i}),a&&(0,r.jsxs)(O.u,{children:[(0,r.jsx)(O.aJ,{children:(0,r.jsx)("div",{className:"sb-grid-column-header__inner__primary-key",children:(0,r.jsx)(es.Z,{size:14,strokeWidth:2})})}),(0,r.jsx)(O._v,{side:"bottom",className:"font-normal",children:"Primary key"})]}),(0,r.jsx)("span",{className:"sb-grid-column-header__inner__name",title:x,children:t.name}),(0,r.jsxs)("span",{className:"sb-grid-column-header__inner__format",children:[p,"bytea"===p?" (hex)":""]}),o&&(0,r.jsxs)(O.u,{children:[(0,r.jsx)(O.aJ,{children:(0,r.jsx)(eg.Z,{size:14,strokeWidth:2})}),(0,r.jsx)(O._v,{side:"bottom",className:"font-normal",children:"Encrypted column"})]})]}),(0,r.jsx)(ew.ov,{column:t,isEncrypted:o,"data-sentry-element":"ColumnMenu","data-sentry-source-file":"ColumnHeader.tsx"})]})})}var eC=n(38232);let eE={key:a.W,name:"",idx:0,width:65,maxWidth:65,resizable:!1,sortable:!1,frozen:!0,isLastFrozenColumn:!1,renderHeaderCell:e=>{let[t,n]=(0,ei.Gt)();return(0,r.jsx)(eR,{"aria-label":"Select All",tabIndex:e.tabIndex,value:t,onChange:e=>n({type:"HEADER",checked:e})})},renderCell:e=>{let[t,n]=(0,ei.Gt)();return(0,r.jsx)(ek,{"aria-label":"Select",tabIndex:e.tabIndex,value:t,row:e.row,onChange:(t,r)=>{n({type:"ROW",row:e.row,checked:t,isShiftClick:r})},onClick:eS})},renderGroupCell:e=>{let[t,n]=(0,ei.Gt)();return(0,r.jsx)(ek,{"aria-label":"Select Group",tabIndex:e.tabIndex,value:t,onChange:t=>{n({type:"ROW",row:e.row,checked:t,isShiftClick:!1})},onClick:eS})},parent:void 0,level:0,minWidth:0,draggable:!1};function eS(e){e.stopPropagation()}function ek(e){let{row:t,value:n,tabIndex:a,disabled:o,onClick:s,onChange:i,"aria-label":c,"aria-labelledby":d}=e,{onEditRow:u}=(0,l.Qq)();return(0,r.jsxs)("div",{className:"sb-grid-select-cell__formatter","data-sentry-component":"SelectCellFormatter","data-sentry-source-file":"SelectColumn.tsx",children:[(0,r.jsx)("input",{"aria-label":c,"aria-labelledby":d,tabIndex:a,type:"checkbox",className:"rdg-row__select-column__select-action",disabled:o,checked:n,onChange:function(e){i(e.target.checked,e.nativeEvent.shiftKey)},onClick:s}),u&&t&&(0,r.jsx)(el.u,{type:"text",size:"tiny",className:"px-1 rdg-row__select-column__edit-action",icon:(0,r.jsx)(eC.Z,{}),onClick:function(e){e.stopPropagation(),u&&t&&u(t)},tooltip:{content:{side:"bottom",text:"Expand row"}}})]})}function eR(e){let{disabled:t,tabIndex:n,value:a,onChange:o,onClick:s,"aria-label":i,"aria-labelledby":c}=e,{selectedRows:d,allRowsSelected:m}=(0,l.Qq)(),f=(0,u.useRef)(null),p=d.size>0&&!m;return(0,u.useEffect)(()=>{f.current&&(f.current.indeterminate=p)},[p]),(0,r.jsx)("div",{className:"sb-grid-select-cell__header","data-sentry-component":"SelectCellHeader","data-sentry-source-file":"SelectColumn.tsx",children:(0,r.jsx)("input",{ref:f,"aria-label":i,"aria-labelledby":c,tabIndex:n,type:"checkbox",className:"sb-grid-select-cell__header__input",disabled:t,checked:a,onChange:function(e){o(e.target.checked,e.nativeEvent.shiftKey)},onClick:s})})}var eT=n(25622);let eA=9;function eL(e,t){let n=[eE,...e.columns.map((e,n)=>{var l;let o=function(e){if((0,eT.Pm)(e))return"foreign_key";if((0,eT.v3)(e.dataType))return"number";if((0,eT.nr)(e.dataType))return"array";if((0,eT.om)(e.dataType))return"json";if((0,eT.II)(e.dataType))return"text";if((0,eT.kO)(e.format))return"citext";if((0,eT.VO)(e.format))return"date";else if((0,eT.LT)(e.format))return"time";else if((0,eT.Kp)(e.format))return"datetime";else if((0,eT.nL)(e.dataType))return"boolean";else if((0,eT.N8)(e.dataType))return"enum";else if((0,eT.yM)(e.dataType))return"binary";else return"unknown"}(e),i=eO(e),c=(e.name.length+e.format.length)*eA,d=(null==t?void 0:t.defaultWidth)?t.defaultWidth:i<c?c:i;return{key:e.name,name:e.name,idx:n+1,resizable:!0,sortable:!0,width:d,minWidth:a.mr,frozen:e.isPrimaryKey||!1,isLastFrozenColumn:!1,renderHeaderCell:t=>(0,r.jsx)(eN,{...t,columnType:o,isPrimaryKey:e.isPrimaryKey,isEncrypted:e.isEncrypted,format:e.format,foreignKey:e.foreignKey}),renderEditCell:t?function(e,t,n,a,l){if(!n)return["array","json"].includes(t)?e=>(0,r.jsx)(F,{...e,isEditable:n,onExpandEditor:a}):["number","boolean"].includes(t)?void 0:e=>(0,r.jsx)(K,{...e,isEditable:n,onExpandEditor:l});if(!e.isPrimaryKey&&e.isUpdatable)switch(t){case"boolean":return t=>(0,r.jsx)(s,{...t,isNullable:e.isNullable});case"date":return _("date",e.isNullable||!1);case"datetime":return e.format.endsWith("z")?_("datetimetz",e.isNullable||!1):_("datetime",e.isNullable||!1);case"time":return e.format.endsWith("z")?Q:G;case"enum":{let t=e.enum.map(e=>({label:e,value:e}));return n=>(0,r.jsx)(U,{...n,options:t,isNullable:e.isNullable})}case"array":case"json":return e=>(0,r.jsx)(F,{...e,onExpandEditor:a});case"number":return M;case"citext":case"text":return t=>(0,r.jsx)(K,{...t,isEditable:n,isNullable:e.isNullable,onExpandEditor:l});default:return}}(e,o,null!==(l=null==t?void 0:t.editable)&&void 0!==l&&l,t.onExpandJSONEditor,t.onExpandTextEditor):void 0,renderCell:function(e,t,n){switch(t){case"boolean":return et;case"foreign_key":if(!e.isUpdatable)return en;return e=>(0,r.jsx)(em,{...e,projectRef:n.projectRef,tableId:n.tableId});case"binary":return ee;case"json":return ef;default:return en}}(e,o,{projectRef:null==t?void 0:t.projectRef,tableId:null==t?void 0:t.tableId}),parent:void 0,level:0,maxWidth:void 0,draggable:!1}})];return(null==t?void 0:t.onAddColumn)&&n.push(eh),n}function eO(e){return(0,eT.v3)(e.dataType)?120:(0,eT.Kp)(e.format)||(0,eT.VO)(e.format)||(0,eT.LT)(e.format)?150:(0,eT.nL)(e.dataType)?120:(0,eT.N8)(e.dataType)?150:250}},7676:function(e,t,n){n.d(t,{b:function(){return d}});var r=n(97458),a=n(52983),l=n(42155),o=n(90839),s=n(10947),i=n(96444),c=n(44735);let d=e=>{let{visible:t,onClose:n}=e;return(0,r.jsx)(l.Z,{size:"medium",visible:t,header:"Schemas managed by Supabase",customFooter:(0,r.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,r.jsx)(o.z,{type:"default",onClick:()=>n(),children:"Understood"})}),onCancel:()=>n(),"data-sentry-element":"Modal","data-sentry-component":"ProtectedSchemaModal","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,r.jsxs)(l.Z.Content,{className:"space-y-2","data-sentry-element":"unknown","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,r.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:i.s.map(e=>(0,r.jsx)("code",{className:"text-xs",children:e},e))}),(0,r.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,r.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]})})};t.Z=e=>{let{schema:t,entity:n}=e,[l,i]=(0,a.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.bZ,{"data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,r.jsx)(c.Z,{strokeWidth:2,"data-sentry-element":"AlertCircle","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,r.jsxs)(s.Cd,{"data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:["Currently viewing ",n," from a protected schema"]}),(0,r.jsxs)(s.X,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,r.jsxs)("p",{className:"mb-2",children:["The ",(0,r.jsx)("code",{className:"text-xs",children:t})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,r.jsx)(o.z,{type:"default",size:"tiny",onClick:()=>i(!0),"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Learn more"})]})]}),(0,r.jsx)(d,{visible:l,onClose:()=>i(!1),"data-sentry-element":"ProtectedSchemaModal","data-sentry-source-file":"ProtectedSchemaWarning.tsx"})]})}},31472:function(e,t,n){n.d(t,{U:function(){return l},h:function(){return o}});var r=n(97458),a=n(63621);let l=()=>(0,r.jsx)("div",{className:"p-2 col-span-full","data-sentry-component":"TableGridInnerLoadingState","data-sentry-source-file":"LoadingState.tsx",children:(0,r.jsx)(a.A,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"LoadingState.tsx"})}),o=()=>(0,r.jsxs)("div",{className:"flex flex-col","data-sentry-component":"TableGridSkeletonLoader","data-sentry-source-file":"LoadingState.tsx",children:[(0,r.jsx)("div",{className:"h-10 bg-dash-sidebar"}),(0,r.jsx)("div",{className:"h-9 border-y"}),(0,r.jsx)(l,{"data-sentry-element":"TableGridInnerLoadingState","data-sentry-source-file":"LoadingState.tsx"})]})},55271:function(e,t,n){n.d(t,{S:function(){return i},x:function(){return c}});var r=n(97458),a=n(87882),l=n(96056),o=n(40577),s=n(17555);let i=e=>e.map(e=>({id:e.id,name:e.constraint_name,tableId:e.target_id,schema:e.target_schema,table:e.target_table,columns:e.source_columns.map((t,n)=>({source:t,target:e.target_columns[n]})),deletionAction:e.deletion_action,updateAction:e.update_action})),c=(e,t,n)=>{var i;let c="update"===e?"Updating":"Deleting",d=null!==(i=(0,s.s8)(t))&&void 0!==i?i:"No action";switch(t){case a.N.NO_ACTION:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will"," ",(0,r.jsx)("span",{className:"text-amber-900 opacity-75",children:"raise an error"})," if there are records existing in this table that reference it"]});case a.N.CASCADE:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will"," ",(0,r.jsxs)("span",{className:"text-amber-900 opacity-75",children:["also ",e]})," any records that reference it in this table"]});case a.N.RESTRICT:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),(0,r.jsxs)(o.u,{children:[(0,r.jsx)(o.aJ,{className:"translate-y-[3px] mx-1",children:(0,r.jsx)(l.Z,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,r.jsx)(o._v,{side:"bottom",className:"w-80",children:"This is similar to no action, but the restrict check cannot be deferred till later in the transaction"})]}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will"," ",(0,r.jsxs)("span",{className:"text-amber-900 opacity-75",children:["prevent ",c.toLowerCase()]})," ","existing referencing rows from this table."]});case a.N.SET_DEFAULT:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will set the value of any existing records in this table referencing it to their"," ",(0,r.jsx)("span",{className:"text-amber-900 opacity-75",children:"default value"})]});case a.N.SET_NULL:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will set the value of any existing records in this table referencing it"," ",(0,r.jsx)("span",{className:"text-amber-900 opacity-75",children:"to NULL"})]})}}},35452:function(e,t,n){var r=n(97458),a=n(4839),l=n(359),o=n(83145),s=n.n(o),i=n(90839);t.Z=e=>{let{title:t="",size:n="medium",children:o,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:u="",onClickCta:m=()=>{},loading:f=!1,disabled:p=!1,disabledMessage:h="",ctaUrl:x}=e,g=c&&m||u&&d;return(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,r.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,r.jsx)("h5",{className:"text-foreground",children:t}),(0,r.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:o}),g&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&x?(0,r.jsx)(i.z,{asChild:!0,type:"primary",children:(0,r.jsx)(s(),{href:x,children:c})}):c&&m?(0,r.jsx)(l.u,{type:"primary",onClick:m,loading:f,disabled:f||p,tooltip:{content:{side:"bottom",text:p&&h.length>0?h:void 0}},children:c}):null,u&&d?(0,r.jsx)(i.z,{type:"default",icon:(0,r.jsx)(a.Z,{strokeWidth:1.5}),children:(0,r.jsx)("a",{target:"_blank",rel:"noreferrer",href:u,children:d})}):null]})]})})})})}},13064:function(e,t,n){var r=n(97458),a=n(1707),l=n(38232),o=n(4839),s=n(83145),i=n.n(s),c=n(52983),d=n(90839);let u=(0,c.forwardRef)((e,t)=>{let{icon:n,title:s,description:u,url:m,urlLabel:f="Read more",defaultVisibility:p=!1,hideCollapse:h=!1,button:x,className:g="",block:y=!1}=e,[v,b]=(0,c.useState)(p);return(0,r.jsx)("div",{ref:t,role:"alert",className:"".concat(y?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(g),children:(0,r.jsxs)("div",{className:"flex flex-col px-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[n&&(0,r.jsx)("span",{className:"text-foreground-lighter",children:n}),(0,r.jsx)("div",{className:"flex-grow",children:(0,r.jsx)("h5",{className:"text-sm text-foreground",children:s})})]}),u&&!h?(0,r.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>b(!v),children:v?(0,r.jsx)(a.Z,{size:14,strokeWidth:1.5}):(0,r.jsx)(l.Z,{size:14,strokeWidth:1.5})}):null]}),(u||m||x)&&(0,r.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(v?"mt-3":""),style:{maxHeight:v?500:0},children:[(0,r.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,r.jsx)("div",{children:(0,r.jsx)(d.z,{asChild:!0,type:"default",icon:(0,r.jsx)(o.Z,{}),children:(0,r.jsx)(i(),{href:m,target:"_blank",rel:"noreferrer",children:f})})}),x&&(0,r.jsx)("div",{children:x})]})]})})});u.displayName="InformationBox",t.Z=u},83462:function(e,t,n){n.d(t,{Sf:function(){return g},xg:function(){return h},yF:function(){return x}});var r=n(97458),a=n(36457),l=n(32691),o=n(52983),s=n(62095),i=n(27850),c=n(88971),d=n(39113),u=n(38650),m=n(24561),f=n(96226),p=n(29213);function h(e){let{queryClient:t,projectRef:n,connectionString:r,id:a,sorts:l,filters:o,impersonatedRole:c}=e;return(0,d.nq)(t,{projectRef:n,connectionString:r,id:a}).then(e=>{if(e){var d;let m=(0,i.NK)(e),{sorts:p=[],filters:h=[]}=null!==(d=(0,s.v)(n,e.name,e.schema))&&void 0!==d?d:{};(0,u.Ue)(t,{projectRef:n,connectionString:r,tableId:a,sorts:null!=l?l:(0,i.rg)(m.name,p),filters:null!=o?o:(0,i.Yb)(h),page:1,limit:f.Re,impersonatedRole:c})}})}function x(){let e=(0,l.useRouter)(),t=(0,a.NL)(),{project:n}=(0,c.d2)(),r=(0,m.fN)();return(0,o.useCallback)(a=>{let{id:l,filters:o,sorts:s}=a,i=l?Number(l):void 0;!n||!i||isNaN(i)||(e.prefetch("/project/".concat(n.ref,"/editor/").concat(i)),h({queryClient:t,projectRef:n.ref,connectionString:n.connectionString,id:i,sorts:s,filters:o,impersonatedRole:r.role}).catch(()=>{}))},[n,t,r.role,e])}function g(e){let{projectRef:t,id:n,sorts:a,filters:l,href:o,children:s,...i}=e,c=x();return(0,r.jsx)(p.Z,{href:o||"/project/".concat(t,"/editor/").concat(n),prefetcher:()=>c({id:n,sorts:a,filters:l}),...i,"data-sentry-element":"PrefetchableLink","data-sentry-component":"EditorTablePageLink","data-sentry-source-file":"project.$ref.editor.$id.tsx",children:s})}},5079:function(e,t,n){var r=n(97458),a=n(52983),l=n(68249),o=n(51487),s=n(16720),i=n(25843),c=n(11499);function d(e){let{autoComplete:t,autofocus:n,children:d,className:u,descriptionText:m,disabled:f,error:p,icon:h,id:x="",inputRef:g,label:y,afterLabel:v,beforeLabel:b,labelOptional:j,layout:_,name:w="",onChange:N,onBlur:C,placeholder:E,required:S,value:k,defaultValue:R,style:T,size:A="medium",borderless:L=!1,validation:O,...I}=e,{formContextOnChange:P,values:q,errors:D,handleBlur:z,touched:F,fieldLevelValidation:Z}=(0,c.G)();q&&!k&&(k=q[x]),p||(D&&!p&&(p=D[x||w]),p=F&&F[x||w]?p:void 0),(0,a.useEffect)(()=>{O&&Z(x,O(k))},[]);let M=(0,i.Z)("select"),U=[M.container];u&&U.push(u);let W=[M.base];return p&&W.push(M.variants.error),p||W.push(M.variants.standard),h&&W.push(M.with_icon),A&&W.push(M.size[A]),f&&W.push(M.disabled),(0,r.jsx)(l.l,{label:y,afterLabel:v,beforeLabel:b,labelOptional:j,layout:_,id:x,error:p,descriptionText:m,className:u,style:T,size:A,"data-sentry-element":"FormLayout","data-sentry-component":"Select","data-sentry-source-file":"Select.tsx",children:(0,r.jsxs)("div",{className:M.container,children:[(0,r.jsx)("select",{id:x,name:w,"data-size":A,defaultValue:R,autoComplete:t,autoFocus:n,className:W.join(" "),onChange:function(e){N&&N(e),P&&P(e),O&&Z(x,O(e.target.value))},onBlur:function(e){z&&z(e),C&&C(e)},ref:g,value:k,disabled:f,required:S,placeholder:E,...I,children:d}),h&&(0,r.jsx)(s.Z,{size:A,icon:h}),p&&(0,r.jsx)("div",{className:M.actions_container,children:p&&(0,r.jsx)(o.Z,{size:A})}),(0,r.jsx)("span",{className:M.chevron_container,children:(0,r.jsx)("svg",{className:M.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Select.tsx",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Select.tsx"})})})]})})}d.Option=function(e){let{value:t,children:n,selected:a}=e;return(0,r.jsx)("option",{value:t,selected:a,"data-sentry-component":"Option","data-sentry-source-file":"Select.tsx",children:n})},d.OptGroup=function(e){let{label:t,children:n}=e;return(0,r.jsx)("optgroup",{label:t,"data-sentry-component":"OptGroup","data-sentry-source-file":"Select.tsx",children:n})},t.ZP=d}}]);