!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="285026c2-c3b5-4a23-afc9-4618f010a743",e._sentryDebugIdIdentifier="sentry-dbid-285026c2-c3b5-4a23-afc9-4618f010a743")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5885],{8660:function(e){e.exports=function(e,t,n,s){for(var a=-1,i=null==e?0:e.length;++a<i;){var r=e[a];t(s,r,n(r),e)}return s}},3792:function(e,t,n){var s=n(61701);e.exports=function(e,t,n,a){return s(e,function(e,s,i){t(a,e,n(e),i)}),a}},48318:function(e,t,n){var s=n(84546),a=n(45436),i=n(99105),r=n(29233),l=n(31525),o=n(77026);e.exports=function(e,t,n,c){var d=-1,u=a,m=!0,h=e.length,p=[],x=t.length;if(!h)return p;n&&(t=r(t,l(n))),c?(u=i,m=!1):t.length>=200&&(u=o,m=!1,t=new s(t));e:for(;++d<h;){var f=e[d],y=null==n?f:n(f);if(f=c||0!==f?f:0,m&&y==y){for(var g=x;g--;)if(t[g]===y)continue e;p.push(f)}else u(t,y,c)||p.push(f)}return p}},17325:function(e,t,n){var s=n(8660),a=n(3792),i=n(55833),r=n(55589);e.exports=function(e,t){return function(n,l){var o=r(n)?s:a,c=t?t():{};return o(n,e,i(l,2),c)}}},67891:function(e,t,n){var s=n(77379);e.exports=function(e){return(null==e?0:e.length)?s(e,0,-1):[]}},29787:function(e,t,n){var s=n(41351),a=n(87493),i=n(79312),r=n(55589),l=n(30568),o=n(91052),c=n(32840),d=n(50922),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(l(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||o(e)||d(e)||i(e)))return!e.length;var t=a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!s(e).length;for(var n in e)if(u.call(e,n))return!1;return!0}},40916:function(e,t,n){var s=n(54466),a=n(55589);e.exports=function(e,t,n,i){return null==e?[]:(a(t)||(t=null==t?[]:[t]),a(n=i?void 0:n)||(n=null==n?[]:[n]),s(e,t,n))}},50663:function(e,t,n){var s=n(17325)(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});e.exports=s},92238:function(e,t,n){var s=n(48318),a=n(29735),i=n(18268),r=a(function(e,t){return i(e)?s(e,t):[]});e.exports=r},57724:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/policies",function(){return n(53502)}])},74696:function(e,t,n){"use strict";n.d(t,{bS:function(){return a},gA:function(){return s},kR:function(){return i}});let s=(e,t)=>[{id:"policy-1",preview:!1,templateName:"Enable read access to everyone",description:"This policy gives read access to your table for all users via the SELECT operation.",statement:'\ncreate policy "Enable read access for all users"\non "'.concat(e,'"."').concat(t,'"\nfor select using (true);').trim(),name:"Enable read access for all users",definition:"true",check:"",command:"SELECT",roles:[]},{id:"policy-2",preview:!1,templateName:"Enable insert access for authenticated users only",description:"This policy gives insert access to your table for all authenticated users only.",statement:'\ncreate policy "Enable insert for authenticated users only"\non "'.concat(e,'"."').concat(t,'"\nfor insert to authenticated\nwith check (true);').trim(),name:"Enable insert for authenticated users only",definition:"",check:"true",command:"INSERT",roles:["authenticated"]},{id:"policy-3",preview:!1,templateName:"Enable update access for users based on their email *",description:'This policy assumes that your table has a column "email", and allows users to update rows which the "email" column matches their email.',statement:'\ncreate policy "Enable update for users based on email"\non "'.concat(e,'"."').concat(t,"\"\nfor update using (\n  (select auth.jwt()) ->> 'email' = email\n) with check (\n  (select auth.jwt()) ->> 'email' = email\n);").trim(),name:"Enable update for users based on email",definition:"(select auth.jwt()) ->> 'email' = email",check:"(select auth.jwt()) ->> 'email' = email",command:"UPDATE",roles:[]},{id:"policy-4",preview:!1,templateName:"Enable delete access for users based on their user ID *",description:'This policy assumes that your table has a column "user_id", and allows users to delete rows which the "user_id" column matches their ID',statement:'\ncreate policy "Enable delete for users based on user_id"\non "'.concat(e,'"."').concat(t,'"\nfor delete using (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable delete for users based on user_id",definition:"(select auth.uid()) = user_id",check:"",command:"DELETE",roles:[]},{id:"policy-5",preview:!1,templateName:"Enable insert access for users based on their user ID *",description:'This policy assumes that your table has a column "user_id", and allows users to insert rows which the "user_id" column matches their ID',statement:'\ncreate policy "Enable insert for users based on user_id"\non "'.concat(e,'"."').concat(t,'"\nfor insert with check (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable insert for users based on user_id",definition:"",check:"(select auth.uid()) = user_id",command:"INSERT",roles:[]},{id:"policy-6",preview:!0,name:"Policy with table joins",templateName:"Policy with table joins",description:"\nQuery across tables to build more advanced RLS rules\n\nAssuming 2 tables called `teams` and `members`, you can query both tables in the policy to control access to the members table.",statement:'\ncreate policy "Members can update team details if they belong to the team"\non teams for update using (\n  (select auth.uid()) in (\n    select user_id from members where team_id = id\n  )\n);\n'.trim(),definition:"(select auth.uid()) in (select user_id from members where team_id = id)",check:"",command:"UPDATE",roles:[]},{id:"policy-7",preview:!0,templateName:"Policy with security definer functions",description:"\nUseful in a many-to-many relationship where you want to restrict access to the linking table.\n\nAssuming 2 tables called `teams` and `members`, you can use a security definer function in combination with a policy to control access to the members table.".trim(),statement:'\ncreate or replace function get_teams_for_user(user_id uuid)\nreturns setof bigint as $$\n  select team_id from members where user_id = $1\n$$ stable language sql security definer;\n\ncreate policy "Team members can update team members if they belong to the team"\non members\nfor all using (\n  team_id in (select get_teams_for_user(auth.uid()))\n);\n'.trim(),name:"Policy with security definer functions",definition:"team_id in (select get_teams_for_user(auth.uid()))",check:"",command:"ALL",roles:[]},{id:"policy-8",preview:!0,name:"Policy to implement Time To Live (TTL)",templateName:"Policy to implement Time To Live (TTL)",description:"\nImplement a TTL-like feature that you see in Instagram stories or Snapchat where messages expire after a day.\n\nRows under the table are available only if they have been created within the last 24 hours.",statement:'\ncreate policy "Stories are live for a day"\non "'.concat(e,'"."').concat(t,"\"\nfor select using (\n  created_at > (current_timestamp - interval '1 day')\n);\n").trim(),definition:"created_at > (current_timestamp - interval '1 day')",check:"",command:"SELECT",roles:[]},{id:"policy-9",preview:!1,templateName:"Allow users to only view their own data",description:"Restrict users to reading only their own data.",statement:'\ncreate policy "Enable users to view their own data only"\non "'.concat(e,'"."').concat(t,'"\nfor select\nto authenticated\nusing (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable users to view their own data only",definition:"(select auth.uid()) = user_id",check:"",command:"SELECT",roles:["authenticated"]}],a=()=>[{id:"policy-broadcast-1",preview:!1,templateName:"Allow listening for broadcasts for authenticated users only",description:"This policy allows listening for broadcasts for authenticated users only.",statement:"\ncreate policy  \"Allow listening for broadcasts for authenticated users only\"\non realtime.messages for select\nto authenticated\nusing ( realtime.messages.extension = 'broadcast' );".trim(),name:"Allow listening for broadcasts for authenticated users only",definition:"realtime.messages.extension = 'broadcast'",check:"",command:"SELECT",roles:["authenticated"]},{id:"policy-broadcast-2",preview:!1,templateName:"Allow pushing broadcasts for authenticated users only",description:"This policy allows pushing broadcasts for authenticated users only.",statement:"\ncreate policy \"Allow pushing broadcasts for authenticated users only\"\nON realtime.messages for insert\nTO authenticated\nwith check ( realtime.messages.extension = 'broadcast' );".trim(),name:"Allow pushing broadcasts for authenticated users only",definition:"realtime.messages.extension = 'broadcast'",check:"realtime.messages.extension = 'broadcast'",command:"INSERT",roles:["authenticated"]},{id:"policy-broadcast-3",preview:!1,templateName:"Allow listening for broadcasts from a specific channel",description:"This policy allows listening for broadcasts from a specific channel.",statement:"\ncreate policy \"Allow listening for broadcasts from a specific channel\"\non realtime.messages for select\nusing ( realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name' );".trim(),name:"Allow listening for broadcasts from a specific channel",definition:"realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name'",check:"",command:"SELECT",roles:[]},{id:"policy-broadcast-4",preview:!1,templateName:"Allow pushing broadcasts to specific channel",description:"This policy allow pushing broadcasts to specific channel.",statement:"\ncreate policy \"Allow pushing broadcasts to specific channel\"\nON realtime.messages for insert\nwith check ( realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name' );".trim(),name:"Allow pushing broadcasts to specific channel",definition:"realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name'",check:"realtime.messages.extension = 'broadcast' AND realtime.topic() = 'channel_name'",command:"INSERT",roles:[]},{id:"policy-presences-1",preview:!1,templateName:"Allow listening for presences on all channels for authenticated users only",description:"This policy enables listening for presences on all channels for all authenticated users only.",statement:"\ncreate policy \"Allow listening for presences on all channels for authenticated users only\"\non realtime.messages for select\nto authenticated\nusing ( realtime.messages.extension = 'presence' );".trim(),name:"Allow listening for presences on all channels for authenticated users only",definition:"realtime.messages.extension = 'presence'",check:"",command:"SELECT",roles:["authenticated"]},{id:"policy-presences-2",preview:!1,templateName:"Allow broadcasting presences on all channels for authenticated users only",description:"This policy enables broadcasting presences on all channels for all authenticated users only.",statement:"\ncreate policy \"Allow broadcasting presences on all channels for authenticated users only\"\nON realtime.messages for insert\nTO authenticated\nwith check ( realtime.messages.extension = 'presence' );\n  ;".trim(),name:"Allow broadcasting presences on all channels for authenticated users only",definition:"realtime.messages.extension = 'presence'",check:"realtime.messages.extension = 'presence'",command:"INSERT",roles:["authenticated"]},{id:"policy-presences-3",preview:!1,templateName:"Allow listening for presences from a specific channel",description:"This policy enables listening for presences from a specific channel.",statement:"\ncreate policy \"Allow listening for presences from a specific channel\"\non realtime.messages for select\nusing ( realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name' );".trim(),name:"Allow listening for presences from a specific channel",definition:"realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name'",check:"",command:"SELECT",roles:[]},{id:"policy-presences-4",preview:!1,templateName:"Publish presence to a specific channel",description:"This policy allows publishing presence to a specific channel.",statement:"\ncreate policy \"Publish presence to a specific channel\"\nON realtime.messages for insert\nwith check ( realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name' );\n  ;".trim(),name:"Publish presence to a specific channel",definition:"realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name'",check:"realtime.messages.extension = 'presence' AND realtime.topic() = 'channel_name'",command:"INSERT",roles:[]}],i=()=>[{id:"policy-queues-1",preview:!1,templateName:"Allow access to queue",statement:"".trim(),name:"Allow anon and authenticated to access messages from queue",description:"Base policy to ensure that anon and authenticated can only access appropriate rows. USING and CHECK statements will need to be adjusted accordingly",definition:"true",check:"true",command:"ALL",roles:["anon","authenticated"]}]},30976:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});let s=e=>{let t="";return null!==e.definition&&void 0!==e.definition&&(t+="USING (".concat(e.definition,")").concat(null===e.check||void 0===e.check?";":"","\n")),null!==e.check&&void 0!==e.check&&(t+="WITH CHECK (".concat(e.check,");\n")),'\nALTER POLICY "'.concat(e.name,'" \nON "').concat(e.schema,'"."').concat(e.table,'"\nAS ').concat(e.action,"\nFOR ").concat(e.command,"\nTO ").concat(e.roles.join(", "),"\n").concat(t,"\n").trim()}},67628:function(e,t,n){"use strict";n.d(t,{Q:function(){return l}});var s=n(97458),a=n(94059),i=n(73565),r=n(55228),l=e=>{let{page:t,menu:n}=e;return(0,s.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,s.jsx)(a.ZP,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:n.map((e,l)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"my-6 space-y-8",children:(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(a.ZP.Group,{title:e.title?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,s.jsx)("span",{children:e.title}),e.isPreview&&(0,s.jsx)(i.C,{variant:"warning",children:"Not production ready"})]}):null}),(0,s.jsx)("div",{children:e.items.map(e=>{let n=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,s.jsx)(r.Z,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:n,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),l!==n.length-1&&(0,s.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},72909:function(e,t,n){"use strict";n.d(t,{$E:function(){return c},h8:function(){return o},kM:function(){return d}});var s=n(28894),a=n(36457),i=n(6464),r=n(52983),l=n(26600);async function o(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let{data:s,error:a}=await (0,i.U2)("/platform/auth/{ref}/config",{params:{path:{ref:n}},signal:t});return a&&(0,i.S3)(a),s}let c=function(e){let{projectRef:t}=e,{enabled:n=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(l.o.authConfig(t),e=>{let{signal:n}=e;return o({projectRef:t},n)},{enabled:n&&void 0!==t,...a})},d=e=>{let{projectRef:t}=e,n=(0,a.NL)();return(0,r.useCallback)(()=>{t&&n.prefetchQuery(l.o.authConfig(t),e=>{let{signal:n}=e;return o({projectRef:t},n)})},[n,t])}},92259:function(e,t,n){"use strict";n.d(t,{r:function(){return c}});var s=n(28894),a=n(6464),i=n(62432),r=n(37756),l=n(98775);async function o(e,t,n){let{projectRef:s,connectionString:i,schema:r}=e;if(!s)throw Error("projectRef is required");let l=new Headers(n);i&&l.set("x-connection-encrypted",i);let{data:o,error:c}=await (0,a.U2)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":i},path:{ref:s},query:{included_schemas:r||"",excluded_schemas:""}},headers:l,signal:t});return c&&(0,a.S3)(c),o}let c=function(e){let{projectRef:t,connectionString:n,schema:a}=e,{enabled:c=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=(0,i.Vm)(),m=(null==u?void 0:u.status)===r.S.ACTIVE_HEALTHY;return(0,s.a)(l.R.list(t,a),e=>{let{signal:s}=e;return o({projectRef:t,connectionString:n,schema:a},s)},{enabled:c&&void 0!==t&&m,...d})}},41440:function(e,t,n){"use strict";n.d(t,{l:function(){return c}});var s=n(36457),a=n(64618),i=n(34549),r=n(6464),l=n(98775);async function o(e){let{projectRef:t,connectionString:n,id:s}=e,a=new Headers;n&&a.set("x-connection-encrypted",n);let{data:i,error:l}=await (0,r.IV)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},headers:a});return l&&(0,r.S3)(l),i}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(l.R.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to delete database policy: ".concat(e.message)):t(e,n,s)},...n})}},23667:function(e,t,n){"use strict";n.d(t,{k:function(){return c}});var s=n(36457),a=n(64618),i=n(34549),r=n(6464),l=n(98775);async function o(e){let{projectRef:t,connectionString:n,id:s,payload:a}=e,i=new Headers;n&&i.set("x-connection-encrypted",n);let{data:l,error:o}=await (0,r.r$)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},body:a,headers:i});return o&&(0,r.S3)(o),l}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(l.R.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to update database policy: ".concat(e.message)):t(e,n,s)},...n})}},55214:function(e,t,n){"use strict";n.d(t,{fA:function(){return d},x4:function(){return c}});var s=n(49437),a=n(28894),i=n(25878),r=n(49820);let l=s.Z.roles.list();async function o(e,t){let{projectRef:n,connectionString:s}=e,{result:a}=await (0,i.R)({projectRef:n,connectionString:s,sql:l.sql,queryKey:["database-roles"]},t);return a}let c=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.a)(r.E.databaseRoles(t),e=>{let{signal:s}=e;return o({projectRef:t,connectionString:n},s)},{enabled:s&&void 0!==t,...i})};function d(e,t){return e.invalidateQueries(r.E.databaseRoles(t))}},41135:function(e,t,n){"use strict";n.d(t,{T:function(){return d},V:function(){return u}});var s=n(36457),a=n(64618),i=n(34549),r=n(6464),l=n(3190),o=n(1978),c=n(65568);async function d(e){let{projectRef:t,connectionString:n,id:s,payload:a}=e,i=new Headers;n&&i.set("x-connection-encrypted",n);let{data:l,error:o}=await (0,r.r$)("/platform/pg-meta/{ref}/tables",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},body:a,headers:i});return o&&(0,r.S3)(o),l}let u=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>d(e),{async onSuccess(t,n,s){let{projectRef:a,schema:i,id:d}=n;await Promise.all([r.invalidateQueries(o.Q.tableEditor(a,d)),r.invalidateQueries(c.W.list(a,i)),r.invalidateQueries(l.X.lint(a))]),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to update database table: ".concat(e.message)):t(e,n,s)},...n})}},5211:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(98266).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},80066:function(e,t,n){"use strict";n.d(t,{Z:function(){return U}});var s=n(97458),a=n(29787),i=n.n(a),r=n(96056),l=n(32691),o=n(52983),c=n(34549),d=n(12436),u=n(71607),m=n.n(u),h=n(88971),p=n(18186),x=n(92259),f=n(90953),y=n(65092),g=n(40577),v=n(198),_=n(68846),j=n(3977),b=n(74304),N=n(85071),w=n(72909),S=n(90817),k=n(86186),E=n(73565),C=n(14500),T=n(90839),L=n(30976),R=e=>{let{policy:t,isLocked:n,onSelectEditPolicy:a=m(),onSelectDeletePolicy:i=m()}=e,{setAiAssistantPanel:r}=(0,k.WZ)(),l=(0,S.Xo)(v.KA.TENANT_SQL_ADMIN_WRITE,"policies"),{project:o}=(0,h.d2)(),{data:c}=(0,w.$E)({projectRef:null==o?void 0:o.ref}),d=("realtime"!==t.schema||"messages"!==t.table)&&n,u=(null==c?void 0:c.EXTERNAL_ANONYMOUS_USERS_ENABLED)&&(t.roles.includes("authenticated")||t.roles.includes("public"));return(0,s.jsxs)(p.Z.Content,{className:(0,y.cn)("flex border-overlay","w-full last:border-0 space-x-4 border-b py-4 lg:items-center"),"data-sentry-element":"unknown","data-sentry-component":"PolicyRow","data-sentry-source-file":"PolicyRow.tsx",children:[(0,s.jsx)("div",{className:"flex grow flex-col gap-y-1",children:(0,s.jsxs)("div",{className:"flex items-start gap-x-4",children:[(0,s.jsx)("p",{className:"font-mono text-xs text-foreground-light translate-y-[2px] min-w-12",children:t.command}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:t.name}),(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsxs)("div",{className:"text-foreground-lighter text-sm",children:["Applied to:",t.roles.slice(0,3).map((e,t)=>(0,s.jsx)("code",{className:"text-foreground-light text-xs",children:e},"policy-".concat(e,"-").concat(t)))," ","role"]}),t.roles.length>3&&(0,s.jsxs)(g.u,{children:[(0,s.jsx)(g.aJ,{asChild:!0,children:(0,s.jsxs)("code",{className:"text-foreground-light text-xs",children:["+ ",t.roles.length-3," more roles"]},"policy-etc")}),(0,s.jsx)(g._v,{side:"bottom",align:"center",children:t.roles.slice(3).join(", ")})]})]})]}),u?(0,s.jsx)(E.C,{color:"yellow",children:"Applies to anonymous users"}):null]})}),(0,s.jsx)("div",{children:!d&&(0,s.jsxs)(C.h_,{children:[(0,s.jsx)(C.$F,{asChild:!0,children:(0,s.jsx)(T.z,{type:"default",className:"px-1.5",icon:(0,s.jsx)(_.Z,{})})}),(0,s.jsxs)(C.AW,{side:"bottom",align:"end",className:"w-52",children:[(0,s.jsxs)(C.Xi,{className:"gap-x-2",onClick:()=>a(t),children:[(0,s.jsx)(j.Z,{size:14}),(0,s.jsx)("p",{children:"Edit policy"})]}),(0,s.jsxs)(C.Xi,{className:"space-x-2",onClick:()=>{r({open:!0,sqlSnippets:[(0,L.z)(t)],initialInput:'Update the policy with name "'.concat(t.name,'" in the ').concat(t.schema," schema on the ").concat(t.table," table. It should..."),suggestions:{title:'I can help you make a change to the policy "'.concat(t.name,'" in the ').concat(t.schema," schema on the ").concat(t.table," table, here are a few example prompts to get you started:"),prompts:["Tell me how I can improve this policy...","Duplicate this policy for another table...","Add extra conditions to this policy..."]}})},children:[(0,s.jsx)(j.Z,{size:14}),(0,s.jsx)("p",{children:"Edit policy with Assistant"})]}),(0,s.jsx)(C.VD,{}),(0,s.jsxs)(N._,{className:"gap-x-2",disabled:!l,onClick:()=>i(t),tooltip:{content:{side:"left",text:"You need additional permissions to delete policies"}},children:[(0,s.jsx)(b.Z,{size:14}),(0,s.jsx)("p",{children:"Delete policy"})]})]})]})})]})},A=n(11024),q=n(61379),P=n(62213),Z=n(359),z=n(83462),I=n(77060),D=e=>{let{table:t,isLocked:n,onSelectToggleRLS:a=m(),onSelectCreatePolicy:i}=e,{ref:r}=(0,d.UO)(),{setAiAssistantPanel:l}=(0,k.WZ)(),o=(0,S.Xo)(v.KA.TENANT_SQL_ADMIN_WRITE,"policies"),c=(0,S.Xo)(v.KA.TENANT_SQL_ADMIN_WRITE,"tables"),u="realtime"===t.schema,h=u&&"messages"===t.name,p=u?!h:n,[x,f]=(0,P.v1)("view",{defaultValue:""});return(0,s.jsxs)("div",{id:t.id.toString(),className:"flex w-full items-center justify-between","data-sentry-component":"PolicyTableRowHeader","data-sentry-source-file":"PolicyTableRowHeader.tsx",children:[(0,s.jsxs)("div",{className:"flex gap-x-4 text-left",children:[(0,s.jsxs)(z.Sf,{projectRef:r,id:String(t.id),className:"flex items-center gap-x-2","data-sentry-element":"EditorTablePageLink","data-sentry-source-file":"PolicyTableRowHeader.tsx",children:[t.rls_enabled?(0,s.jsx)("div",{className:"flex items-center gap-x-1 text-xs",children:(0,s.jsx)(A.Z,{size:14,strokeWidth:2,className:"text-brand"})}):(0,s.jsx)("div",{className:"flex items-center gap-x-1 text-xs",children:(0,s.jsx)(q.Z,{size:14,strokeWidth:2,className:"text-warning-600"})}),(0,s.jsx)("h4",{className:"m-0",children:t.name})]}),(0,s.jsx)("div",{className:"flex items-center gap-x-2",children:p&&(0,s.jsx)(E.C,{children:(0,s.jsxs)("span",{className:"flex gap-2 items-center text-xs uppercase text-foreground-lighter",children:[(0,s.jsx)(A.Z,{size:12})," Locked"]})})})]}),!p&&(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex flex-row justify-end gap-x-2",children:[!h&&(0,s.jsx)(Z.u,{type:"default",disabled:!c,onClick:()=>a(t),tooltip:{content:{side:"bottom",text:c?void 0:"You need additional permissions to toggle RLS"}},children:t.rls_enabled?"Disable RLS":"Enable RLS"}),(0,s.jsx)(Z.u,{type:"default",disabled:!c||!o,onClick:()=>i(),tooltip:{content:{side:"bottom",text:c?void 0:c&&o?void 0:"You need additional permissions to create RLS policies"}},children:"Create policy"}),(0,s.jsx)(Z.u,{type:"default",className:"px-1",onClick:()=>{l({open:!0,initialInput:"Create and name a new policy for the ".concat(t.schema," schema on the ").concat(t.name," table that ...")})},tooltip:{content:{side:"bottom",text:c&&o?"Create with Supabase Assistant":"You need additional permissions to create RLS policies"}},children:(0,s.jsx)(I.c,{size:16})})]})})]})},M=e=>{let{table:t,isLocked:n,onSelectToggleRLS:a=m(),onSelectCreatePolicy:i,onSelectEditPolicy:r=m(),onSelectDeletePolicy:l=m()}=e,{project:o}=(0,h.d2)(),{data:c}=(0,x.r)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString}),d=(null!=c?c:[]).filter(e=>e.schema===t.schema&&e.table===t.name).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)(p.Z,{className:"!m-0",title:(0,s.jsx)(D,{table:t,isLocked:n,onSelectToggleRLS:a,onSelectCreatePolicy:i}),"data-sentry-element":"Panel","data-sentry-component":"PolicyTableRow","data-sentry-source-file":"index.tsx",children:[!t.rls_enabled&&!n&&(0,s.jsxs)("div",{className:(0,y.cn)("dark:bg-alternative-200 bg-surface-200 px-6 py-2 text-xs flex items-center gap-2",0===d.length?"":"border-b"),children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 bg-warning-600 rounded-full"}),(0,s.jsx)("span",{className:"font-bold text-warning-600",children:"Warning:"})," ",(0,s.jsx)("span",{className:"text-foreground-light",children:"Row Level Security is disabled. Your table is publicly readable and writable."}),(0,s.jsxs)(g.u,{children:[(0,s.jsx)(g.aJ,{asChild:!0,children:(0,s.jsx)(f.Z,{className:"w-3 h-3"})}),(0,s.jsx)(g._v,{className:"w-[400px]",children:"Anyone with the project's anonymous key can modify or delete your data. Enable RLS and create access policies to keep your data secure."})]})]}),0===d.length&&(0,s.jsx)("div",{className:"px-6 py-4 flex flex-col gap-y-3",children:(0,s.jsx)("p",{className:"text-foreground-lighter text-sm",children:"No policies created yet"})}),null==d?void 0:d.map(e=>(0,s.jsx)(R,{isLocked:n,policy:e,onSelectEditPolicy:r,onSelectDeletePolicy:l},e.id))]})},F=n(7676),V=n(10916),O=n(35452),Q=n(13064),B=n(41440),H=n(41135),W=n(32472),U=e=>{let{schema:t,tables:n,hasTables:a,isLocked:u,onSelectCreatePolicy:m,onSelectEditPolicy:p}=e,x=(0,l.useRouter)(),{ref:f}=(0,d.UO)(),{project:y}=(0,h.d2)(),[g,v]=(0,o.useState)(),[_,j]=(0,o.useState)({}),{mutate:b}=(0,H.V)({onError:e=>{c.Am.error("Failed to toggle RLS: ".concat(e.message))},onSettled:()=>{w()}}),{mutate:N}=(0,B.l)({onSuccess:()=>{c.Am.success("Successfully deleted policy!")},onSettled:()=>{w()}}),w=()=>{j({}),v(void 0)},S=e=>{v(e)},k=e=>{p(e)},E=e=>{j(e)},C=async()=>{if(!g)return console.error("Table is required");let e={id:g.id,rls_enabled:!g.rls_enabled};b({projectRef:null==y?void 0:y.ref,connectionString:null==y?void 0:y.connectionString,id:e.id,schema:g.schema,payload:e})},T=async()=>{if(!y)return console.error("Project is required");N({projectRef:y.ref,connectionString:y.connectionString,id:_.id})};return 0===n.length?(0,s.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,s.jsx)(O.Z,{size:"large",title:"Row-Level Security (RLS) Policies",ctaButtonLabel:"Create a table",infoButtonLabel:"What is RLS?",infoButtonUrl:"https://supabase.com/docs/guides/auth/row-level-security",onClickCta:()=>x.push("/project/".concat(f,"/editor")),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(Q.Z,{title:"What are policies?",icon:(0,s.jsx)(r.Z,{size:14,strokeWidth:2}),description:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm",children:"Policies restrict, on a per-user basis, which rows can be returned by normal queries, or inserted, updated, or deleted by data modification commands."}),(0,s.jsx)("p",{className:"text-sm",children:"This is also known as Row-Level Security (RLS). Each policy is attached to a table, and the policy is executed each time its accessed."})]})}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Create a table in this schema first before creating a policy."})]})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-4 pb-4",children:[u&&(0,s.jsx)(F.Z,{schema:t,entity:"policies"}),n.length>0?n.map(e=>(0,s.jsx)("section",{children:(0,s.jsx)(M,{table:e,isLocked:"realtime"===t||u,onSelectToggleRLS:S,onSelectCreatePolicy:()=>m(e.name),onSelectEditPolicy:k,onSelectDeletePolicy:E})},e.id)):a?(0,s.jsx)(V.Z,{}):null]}),(0,s.jsx)(W.Z,{danger:!0,visible:!i()(_),title:"Confirm to delete policy",description:'This is permanent! Are you sure you want to delete the policy "'.concat(_.name,'"'),buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:w,onSelectConfirm:T,"data-sentry-element":"ConfirmModal","data-sentry-source-file":"Policies.tsx"}),(0,s.jsx)(W.Z,{danger:null==g?void 0:g.rls_enabled,visible:void 0!==g,title:"Confirm to ".concat((null==g?void 0:g.rls_enabled)?"disable":"enable"," Row Level Security"),description:"Are you sure you want to ".concat((null==g?void 0:g.rls_enabled)?"disable":"enable",' Row Level Security for the table "').concat(null==g?void 0:g.name,'"?'),buttonLabel:"Confirm",buttonLoadingLabel:"Saving",onSelectCancel:w,onSelectConfirm:C,"data-sentry-element":"ConfirmModal","data-sentry-source-file":"Policies.tsx"})]})}},85490:function(e,t,n){"use strict";n.d(t,{r:function(){return ew}});var s=n(97458),a=n(78751),i=n(198),r=n(36457),l=n(85466),o=n.n(l),c=n(52983),d=n(86848),u=n(34549),m=n(5394),h=n(12436),p=n(359),x=n(23667),f=n(98775),y=n(66802),g=n(90817),v=n(62432),_=n(49142),j=n(72271),b=n(65092),N=n(61893),w=n(36155),S=n(90839),k=n(92240),E=n(64890),C=n(32002);let T=e=>{let{name:t,schema:n,table:s,behavior:a,command:i,roles:r,using:l,check:o}=e,c='create policy "'.concat(t,'" on "').concat(n,'"."').concat(s,'" as ').concat(a," for ").concat(i," to ").concat(r);return"insert"===i?"".concat(c," with check (").concat(o,");"):"".concat(c," using (").concat(l,")").concat((null!=o?o:"").length>0?"with check (".concat(o,");"):";")},L=(e,t)=>!(("INSERT"!==e.command||e.check===t.check)&&("INSERT"===e.command||e.definition===t.definition&&e.check===t.check)&&e.name===t.name&&o()(e.roles,t.roles));var R=n(11024);let A=e=>{let{schema:t,selectedPolicy:n,formFields:a}=e,i=void 0!==n,{name:r,table:l,behavior:o,command:c,roles:d}=a;return(0,s.jsxs)("div",{className:"bg-surface-300 pt-2 pb-1","data-sentry-component":"LockedCreateQuerySection","data-sentry-source-file":"LockedQuerySection.tsx",children:[(0,s.jsx)("div",{className:"flex items-center justify-between px-5 mb-1",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"pl-0.5 pr-5 flex items-center justify-center",children:(0,s.jsx)(R.Z,{size:14,className:"text-foreground-lighter","data-sentry-element":"Lock","data-sentry-source-file":"LockedQuerySection.tsx"})}),(0,s.jsx)("p",{className:"text-xs text-foreground-lighter font-mono uppercase",children:"Use options above to edit"})]})}),(0,s.jsxs)("div",{className:"flex items-start",style:{fontSize:"14px"},children:[(0,s.jsx)("p",{className:"px-6 font-mono text-sm text-foreground-light select-none",children:"1"}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:i?"alter":"create"}),' policy "',0===r.length?"policy_name":r,'"']})]}),(0,s.jsxs)("div",{className:"flex items-start",style:{fontSize:"14px"},children:[(0,s.jsx)("p",{className:"px-6 font-mono text-sm text-foreground-light select-none",children:"2"}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"on"}),' "',t,'"."',l,'"']})]}),!i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-start",style:{fontSize:"14px"},children:[(0,s.jsx)("p",{className:"px-6 font-mono text-sm text-foreground-light select-none",children:"3"}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"as"})," ",o.toLocaleUpperCase()]})]}),(0,s.jsxs)("div",{className:"flex items-start",style:{fontSize:"14px"},children:[(0,s.jsx)("p",{className:"px-6 font-mono text-sm text-foreground-light select-none",children:"4"}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"for"})," ",c.toLocaleUpperCase()]})]})]}),(0,s.jsxs)("div",{className:"flex items-start",style:{fontSize:"14px"},children:[(0,s.jsx)("p",{className:"px-6 font-mono text-sm text-foreground-light select-none",children:"5"}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"to"})," ",0===d.length?"public":d]})]}),(0,s.jsxs)("div",{className:"flex items-start",style:{fontSize:"14px"},children:[(0,s.jsx)("p",{className:"px-6 font-mono text-sm text-foreground-light select-none",children:"6"}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"insert"===c?"with check":"using"})," ",(0,s.jsx)("span",{className:"text-[#ffd700]",children:"("})]})]})]})},q=e=>{let{oldName:t,newName:n,schema:a,table:i,lineNumber:r}=e;return(0,s.jsxs)("div",{className:"bg-surface-300 py-1","data-sentry-component":"LockedRenameQuerySection","data-sentry-source-file":"LockedQuerySection.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center",style:{fontSize:"14px"},children:[(0,s.jsx)("div",{className:"w-[57px]",children:(0,s.jsx)("p",{className:"w-[31px] flex justify-end font-mono text-sm text-foreground-light select-none",children:r})}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"alter"})," policy ",t]})]}),(0,s.jsxs)("div",{className:"flex items-center",style:{fontSize:"14px"},children:[(0,s.jsx)("div",{className:"w-[57px]",children:(0,s.jsx)("p",{className:"w-[31px] flex justify-end font-mono text-sm text-foreground-light select-none",children:r+1})}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"on"}),' "',a,'"."',i,'"']})]}),(0,s.jsxs)("div",{className:"flex items-center",style:{fontSize:"14px"},children:[(0,s.jsx)("div",{className:"w-[57px]",children:(0,s.jsx)("p",{className:"w-[31px] flex justify-end font-mono text-sm text-foreground-light select-none",children:r+2})}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"rename"}),' to "',n,'";']})]})]})};var P=n(50416),Z=n(62507),z=n(88971),I=n(55214),D=n(79581),M=n(56740),F=n(42026),V=n(47482),O=n(22714),Q=n(68839),B=n(6514);let H=e=>{let{schema:t,searchString:n,selectedTable:a,isEditing:r,form:l,onUpdateCommand:o,authContext:d}=e,{project:u}=(0,z.d2)(),[m,h]=(0,c.useState)(!1),p=(0,g.Xo)(i.KA.TENANT_SQL_ADMIN_WRITE,"tables"),{data:x,isSuccess:f}=(0,D.Bj)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString,schema:t,sortByProperty:"name",includeColumns:!0}),{data:y}=(0,I.x4)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString}),v=(null!=y?y:[]).map(e=>({id:e.id,name:e.name,value:e.name,disabled:!1})).sort((e,t)=>e.name.localeCompare(t.name));return(0,c.useEffect)(()=>{if(!r&&void 0===a){let e=null==x?void 0:x.find(e=>e.schema===t&&(e.id.toString()===n||e.name===n));e?l.setValue("table",e.name):f&&x.length>0&&l.setValue("table",x[0].name)}},[r,l,n,x,f,a]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"px-5 py-5 flex flex-col gap-y-4 border-b",children:(0,s.jsxs)("div",{className:"items-start justify-between gap-4 grid grid-cols-12",children:[(0,s.jsx)(_.Wi,{control:l.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(_.xJ,{className:"col-span-6 flex flex-col gap-y-1",children:[(0,s.jsx)(_.lX,{children:"Policy Name"}),(0,s.jsx)(_.NI,{children:(0,s.jsx)(M.I,{...t,disabled:!p,className:"bg-control border-control",placeholder:"Provide a name for your policy"})}),(0,s.jsx)(_.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"PolicyDetailsV2.tsx"}),(0,s.jsx)(_.Wi,{control:l.control,name:"table",render:e=>{let{field:n}=e;return(0,s.jsxs)(_.xJ,{className:"col-span-6 flex flex-col gap-y-1",children:[(0,s.jsxs)(_.lX,{className:"flex items-center gap-x-4",children:[(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Table"}),(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,s.jsx)("code",{className:"text-xs",children:"on"})," clause"]})]}),"database"===d&&(0,s.jsx)(_.NI,{children:(0,s.jsxs)(F.J2,{open:m,onOpenChange:h,modal:!1,children:[(0,s.jsx)(F.xo,{asChild:!0,children:(0,s.jsx)(S.z,{type:"default",disabled:!p,className:"w-full [&>span]:w-full h-[38px] text-sm",iconRight:(0,s.jsx)(P.Z,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:(0,s.jsx)("div",{className:"w-full flex gap-1",children:(0,s.jsxs)("span",{className:"text-foreground",children:[t,".",n.value]})})})}),(0,s.jsx)(F.yk,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,s.jsxs)(V.mY,{children:[(0,s.jsx)(V.sZ,{placeholder:"Find a table..."}),(0,s.jsxs)(V.e8,{children:[(0,s.jsx)(V.rb,{children:"No tables found"}),(0,s.jsx)(V.fu,{children:(0,s.jsx)(E.x,{className:(null!=x?x:[]).length>7?"h-[200px]":"",children:(null!=x?x:[]).map(e=>(0,s.jsx)(V.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{l.setValue("table",e.name),h(!1)},onClick:()=>{l.setValue("table",e.name),h(!1)},children:(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[n.value===e.name?(0,s.jsx)(Z.Z,{size:13}):"",e.name]})},e.id))})})]})]})})]})}),"realtime"===d&&(0,s.jsx)(_.NI,{children:(0,s.jsx)(M.I,{disabled:!0,value:"messages.realtime",className:"bg-control border-control"})}),(0,s.jsx)(_.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"PolicyDetailsV2.tsx"}),(0,s.jsx)(_.Wi,{control:l.control,name:"behavior",render:e=>{let{field:t}=e;return(0,s.jsxs)(_.xJ,{className:"col-span-6 flex flex-col gap-y-1",children:[(0,s.jsxs)(_.lX,{className:"flex items-center gap-x-4",children:[(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Policy Behavior"}),(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,s.jsx)("code",{className:"text-xs",children:"as"})," clause"]})]}),(0,s.jsx)(_.NI,{children:(0,s.jsxs)(O.Ph,{disabled:r,value:t.value,onValueChange:e=>l.setValue("behavior",e),children:[(0,s.jsx)(O.i4,{className:"text-sm h-10 capitalize",children:t.value}),(0,s.jsx)(O.Bw,{children:(0,s.jsxs)(O.DI,{children:[(0,s.jsxs)(O.Ql,{value:"permissive",className:"text-sm",children:[(0,s.jsx)("p",{children:"Permissive"}),(0,s.jsx)("p",{className:"text-foreground-light text-xs",children:'Policies are combined using the "OR" Boolean operator'})]}),(0,s.jsxs)(O.Ql,{value:"restrictive",className:"text-sm",children:[(0,s.jsx)("p",{children:"Restrictive"}),(0,s.jsx)("p",{className:"text-foreground-light text-xs",children:'Policies are combined using the "AND" Boolean operator'})]})]})})]})}),(0,s.jsx)(_.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"PolicyDetailsV2.tsx"}),(0,s.jsx)(_.Wi,{control:l.control,name:"command",render:e=>{let{field:t}=e;return(0,s.jsxs)(_.xJ,{className:"col-span-12 flex flex-col gap-y-1",children:[(0,s.jsxs)(_.lX,{className:"flex items-center gap-x-4",children:[(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Policy Command"}),(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,s.jsx)("code",{className:"text-xs",children:"for"})," clause"]})]}),(0,s.jsx)(_.NI,{children:(0,s.jsx)(Q.Ee,{disabled:r,value:t.value,defaultValue:t.value,onValueChange:e=>{l.setValue("command",e),o(e)},className:"grid grid-cols-10 gap-3 ".concat(r?"opacity-50":""),children:["select","insert",..."database"===d?["update","delete","all"]:[]].map(e=>(0,s.jsx)(Q.kr,{value:e,disabled:r,label:e.toLocaleUpperCase(),className:"col-span-2 w-auto ".concat(r?"cursor-not-allowed":"")},e))})}),(0,s.jsx)(_.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"PolicyDetailsV2.tsx"}),(0,s.jsx)(_.Wi,{control:l.control,name:"roles",render:e=>{var t;let{field:n}=e;return(0,s.jsxs)(_.xJ,{className:"col-span-12 flex flex-col gap-y-1",children:[(0,s.jsxs)(_.lX,{className:"flex items-center gap-x-4",children:[(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Target Roles"}),(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,s.jsx)("code",{className:"text-xs",children:"to"})," clause"]})]}),(0,s.jsx)(_.NI,{children:(0,s.jsx)(B.m,{disabled:!p,options:v,value:0===n.value.length?[]:null===(t=n.value)||void 0===t?void 0:t.split(", "),placeholder:"Defaults to all (public) roles if none selected",searchPlaceholder:"Search for a role",onChange:e=>l.setValue("roles",e.join(", "))})}),(0,s.jsx)(_.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"PolicyDetailsV2.tsx"})]})})})};var W=n(98686),U=n(98601),X=n(98266);let G=(0,X.Z)("PanelLeftClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]]),K=(0,X.Z)("PanelRightClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]]);var Y=n(51e3),$=n(40577);let J=e=>{var t;let{selectedPolicy:n,showTools:a,setShowTools:i}=e,[r,l]=(0,c.useState)(!1);return(0,s.jsxs)(j.Tu,{className:(0,b.cn)("py-3 flex flex-row justify-between items-start border-b"),"data-sentry-element":"SheetHeader","data-sentry-component":"PolicyEditorPanelHeader","data-sentry-source-file":"PolicyEditorPanelHeader.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-3 max-w-[75%] items-start",children:[(0,s.jsxs)(j.sw,{className:(0,b.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","transition disabled:pointer-events-none data-[state=open]:bg-secondary","mt-1.5"),"data-sentry-element":"SheetClose","data-sentry-source-file":"PolicyEditorPanelHeader.tsx",children:[(0,s.jsx)(W.Z,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"PolicyEditorPanelHeader.tsx"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,s.jsx)("div",{className:"h-[24px] w-[1px] bg-border-overlay"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(j.bC,{className:"truncate","data-sentry-element":"SheetTitle","data-sentry-source-file":"PolicyEditorPanelHeader.tsx",children:void 0!==n?"Update policy: ".concat(n.name):"Create a new Row Level Security policy"}),void 0!==n&&(0,s.jsxs)(Y.zF,{className:"-mt-1.5 pb-1.5",open:r,onOpenChange:l,children:[(0,s.jsx)(Y.wy,{className:"group  font-normal p-0 [&[data-state=open]>div>svg]:!-rotate-180",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"View policy details"}),(0,s.jsx)(U.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,s.jsx)(Y.Fw,{className:"grid gap-1.5",children:(0,s.jsx)("div",{className:"flex my-2",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-xs flex items-start space-x-2 border-b py-1.5",children:[(0,s.jsx)("p",{className:"w-[110px] text-foreground-light",children:"Name:"}),(0,s.jsx)("p",{className:"pr-4",children:null==n?void 0:n.name})]}),(0,s.jsxs)("div",{className:"text-xs flex items-start space-x-2 border-b py-1.5",children:[(0,s.jsx)("p",{className:"w-[110px] text-foreground-light",children:"Action:"}),(0,s.jsx)("p",{className:"font-mono pr-4",children:null==n?void 0:n.action})]}),(0,s.jsxs)("div",{className:"text-xs flex items-start space-x-2 border-b py-1.5",children:[(0,s.jsx)("p",{className:"w-[110px] text-foreground-light",children:"Command:"}),(0,s.jsx)("p",{className:"font-mono pr-4",children:null==n?void 0:n.command})]}),(0,s.jsxs)("div",{className:"text-xs flex items-start space-x-2 border-b py-1.5",children:[(0,s.jsx)("p",{className:"w-[110px] text-foreground-light",children:"Target roles:"}),(0,s.jsx)("p",{className:"font-mono pr-4",children:null==n?void 0:n.roles.join(", ")})]}),(0,s.jsxs)("div",{className:"text-xs flex items-start space-x-2 border-b py-1.5",children:[(0,s.jsx)("p",{className:"w-[110px] text-foreground-light",children:"USING expression:"}),(0,s.jsx)("p",{className:"font-mono pr-4",children:null==n?void 0:n.definition})]}),(0,s.jsxs)("div",{className:"text-xs flex items-start space-x-2 pt-1.5",children:[(0,s.jsx)("p",{className:"w-[110px] text-foreground-light",children:"CHECK expression:"}),(0,s.jsx)("p",{className:"".concat((null==n?void 0:n.check)?"":"text-foreground-light"," font-mono pr-4"),children:null!==(t=null==n?void 0:n.check)&&void 0!==t?t:"None"})]})]})})})]})]})]}),(0,s.jsxs)($.u,{"data-sentry-element":"Tooltip","data-sentry-source-file":"PolicyEditorPanelHeader.tsx",children:[(0,s.jsx)($.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"PolicyEditorPanelHeader.tsx",children:(0,s.jsx)("button",{"aria-expanded":a,"aria-controls":"ai-chat-assistant",className:(0,b.cn)(a?"text-light":"text-foreground-lighter","mt-1 hover:text-foreground transition"),onClick:()=>i(!a),children:a?(0,s.jsx)(K,{size:19,strokeWidth:1}):(0,s.jsx)(G,{size:19,strokeWidth:1})})}),(0,s.jsxs)($._v,{side:"left","data-sentry-element":"TooltipContent","data-sentry-source-file":"PolicyEditorPanelHeader.tsx",children:[a?"Hide":"Show"," tools"]})]})]})};var ee=n(77270),et=n(51571),en=n(83965),es=n(73565),ea=n(49996),ei=n(35808),er=n(62234),el=n(66318),eo=n(76767),ec=n(74696);let ed=e=>{let{schema:t,table:n,selectedPolicy:a,selectedTemplate:i,onSelectTemplate:r}=e,[l,o]=(0,c.useState)(""),d="realtime"===t?(0,ec.bS)():"pgmq"===t?(0,ec.kR)():(0,ec.gA)(t,n.length>0?n:"table_name"),u=void 0!==a?d.filter(e=>e.command===a.command):d,m=l.length>0?u.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())||e.command.toLowerCase().includes(l.toLowerCase())):u;return(0,s.jsxs)("div",{className:"h-full px-content py-content flex flex-col gap-3","data-sentry-component":"PolicyTemplates","data-sentry-source-file":"PolicyTemplates.tsx",children:[(0,s.jsx)("label",{className:"sr-only",htmlFor:"template-search",children:"Search templates"}),(0,s.jsx)(et.Z,{size:"small",id:"template-search",icon:(0,s.jsx)(ee.Z,{size:16,className:"text-foreground-muted"}),placeholder:"Search templates",value:l,onChange:e=>o(e.target.value),"data-sentry-element":"Input","data-sentry-source-file":"PolicyTemplates.tsx"}),l.length>0&&0===m.length&&(0,s.jsx)(eo.Z,{searchString:l,className:"min-w-full"}),(0,s.jsx)("div",{className:"flex flex-col gap-1.5",children:m.map(e=>(0,s.jsxs)(en.zs,{openDelay:100,closeDelay:100,children:[(0,s.jsx)(en.Yi,{children:(0,s.jsx)(er.Z,{title:e.name,titleClass:"text-sm",className:(0,b.cn)("transition w-full",e.id===i?"!border-stronger bg-surface-200 hover:!border-stronger":""),onClick:()=>r(e),hideChevron:!0,fixedHeight:!1,icon:(0,s.jsx)("div",{className:"min-w-16",children:(0,s.jsx)(es.C,{className:(0,b.cn)("!rounded font-mono","UPDATE"===e.command?"bg-blue-400 text-blue-900 border border-blue-800":""),variant:"ALL"===e.command?"outline":"SELECT"===e.command?"brand":"UPDATE"===e.command?"default":"DELETE"===e.command?"destructive":"warning",children:e.command})}),children:(0,s.jsx)(ea.U,{content:e.description,className:"[&>p]:m-0 space-y-2"})},e.id)}),(0,s.jsxs)(en.bZ,{hideWhenDetached:!0,side:"left",align:"center",className:"w-[500px] flex",animate:"slide-in",children:[(0,s.jsx)(ei.c,{showCopy:!1,className:"sql",parentClassName:"!p-0 [&>div>span]:text-xs",children:e.statement}),(0,s.jsx)(el.Z,{iconOnly:!0,type:"default",className:"px-1 absolute top-1.5 right-1.5",text:e.statement})]})]},e.id))})]})};var eu=n(67891),em=n.n(eu),eh=n(77875),ep=n.n(eh),ex=n(77627),ef=n.n(ex),ey=n(10947);let eg=e=>{var t,n,a,i;let{error:r,open:l,setOpen:o}=e,c=null!==(i=null===(t=null!==(a=null==r?void 0:null===(n=r.formattedError)||void 0===n?void 0:n.split("\n"))&&void 0!==a?a:[])||void 0===t?void 0:t.filter(e=>e.length>0))&&void 0!==i?i:[];return(0,s.jsxs)("div",{className:"flex flex-col gap-y-3 px-5","data-sentry-component":"QueryError","data-sentry-source-file":"QueryError.tsx",children:[(0,s.jsxs)(ey.bZ,{variant:"destructive","data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"QueryError.tsx",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5","data-sentry-element":"svg","data-sentry-source-file":"QueryError.tsx",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z","data-sentry-element":"path","data-sentry-source-file":"QueryError.tsx"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)(ey.Cd,{className:"m-0","data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"QueryError.tsx",children:"Error running SQL query"}),(0,s.jsxs)(Y.zF,{defaultOpen:!0,className:"flex flex-col gap-3",open:l,onOpenChange:()=>o(!l),"data-sentry-element":"Collapsible_Shadcn_","data-sentry-source-file":"QueryError.tsx",children:[(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(Y.wy,{asChild:!0,"data-sentry-element":"CollapsibleTrigger_Shadcn_","data-sentry-source-file":"QueryError.tsx",children:(0,s.jsx)(S.z,{size:"tiny",type:"outline",className:(0,b.cn)("group",ef()["ai-icon__container--allow-hover-effect"]),"data-sentry-element":"Button","data-sentry-source-file":"QueryError.tsx",children:l?"Hide error details":"Show error details"})})}),(0,s.jsx)(Y.Fw,{className:"overflow-auto","data-sentry-element":"CollapsibleContent_Shadcn_","data-sentry-source-file":"QueryError.tsx",children:c.length>0?c.map((e,t)=>(0,s.jsx)("pre",{className:"font-mono text-xs whitespace-pre-wrap",children:e.split(" ").reduce((e,t)=>{let n=ep()(e);return n&&"ERROR:"!==n?em()(e).concat([[n,t].join(" ")]):""===n?e.concat([" "]):e.concat([t])},[]).map((e,t,n)=>(0,s.jsx)("span",{className:(0,b.cn)("break-all","ERROR:"===e&&"text-destructive"),children:e},t))},"error-".concat(t))):(0,s.jsx)("p",{className:"font-mono text-xs",children:r.error})})]})]})]}),(0,s.jsx)("div",{className:"overflow-x-auto"})]})};var ev=n(85229),e_=n(71607),ej=n.n(e_),eb=n(37462);let eN=e=>{let{id:t,defaultValue:n,wrapperClassName:a,className:i,value:r,placeholder:l,readOnly:o=!1,disableTabToUsePlaceholder:d=!1,lineNumberStart:u,onChange:m=ej(),onMount:h=ej(),editorRef:p,monacoRef:x}=e,f=(0,c.useRef)(),y=(0,ev.useMonaco)(),g="monaco-placeholder-".concat(t),v=async(e,t)=>{p.current=e,void 0!==x&&(x.current=t),f.current=e.createContextKey("hasValue",!1);let n=document.getElementById(g);n&&void 0!==l&&0===(null!=r?r:"").trim().length&&(n.style.display="block"),d||e.addCommand(t.KeyCode.Tab,()=>{e.executeEdits("source",[{identifier:"add-placeholder",range:new t.Range(1,1,1,1),text:(null!=l?l:"").split("\n\n").join("\n").replaceAll("*","").replaceAll("&nbsp;","")}])},"!hasValue"),e.focus(),h()};return(0,c.useEffect)(()=>{m()},[r]),(0,c.useEffect)(()=>{if(y){let e=y.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),n=(0,eb._)(t);return[{range:e.getFullModelRange(),text:n.trim()}]}});return()=>{e.dispose()}}},[y]),(0,c.useEffect)(()=>{if(void 0!==r&&r.trim().length>0){let e=document.getElementById(g);e&&(e.style.display="none")}},[r]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ev.default,{path:t,theme:"supabase",wrapperProps:{className:(0,b.cn)(a)},className:(0,b.cn)(i,"monaco-editor"),value:null!=r?r:void 0,defaultLanguage:"pgsql",defaultValue:null!=n?n:void 0,options:{tabSize:2,fontSize:13,readOnly:o,minimap:{enabled:!1},wordWrap:"on",contextmenu:!0,lineNumbers:void 0!==u?e=>(e+u).toString():void 0,glyphMargin:void 0,lineNumbersMinChars:4,folding:void 0,scrollBeyondLastLine:!1},onMount:v,onChange:e=>{f.current.set((null!=e?e:"").length>0);let t=document.getElementById(g);t&&(e?t.style.display="none":t.style.display="block"),m()},"data-sentry-element":"Editor","data-sentry-source-file":"RLSCodeEditor.tsx"}),void 0!==l&&(0,s.jsx)("div",{id:g,className:(0,b.cn)("monaco-placeholder absolute top-[0px] left-[57px] text-sm pointer-events-none font-mono tracking-tighter","[&>div>p]:text-foreground-lighter [&>div>p]:!m-0"),style:{display:"none"},children:(0,s.jsx)(ea.U,{content:l})})]})},ew=(0,c.memo)(function(e){let{visible:t,schema:n,searchString:l,selectedTable:R,selectedPolicy:P,onSelectCancel:Z,authContext:z}=e,{ref:I}=(0,h.UO)(),D=(0,r.NL)(),M=(0,v.Vm)(),F=(0,g.Xo)(i.KA.TENANT_SQL_ADMIN_WRITE,"tables"),[V,O]=(0,c.useState)(""),[Q,B]=(0,c.useState)(""),[W,U]=(0,c.useState)(),[X,G]=(0,c.useState)(!0),K=(0,c.useRef)(null),Y=(0,c.useRef)(null),[$,ee]=(0,c.useState)(1),[et,en]=(0,c.useState)(0),es=(0,c.useRef)(null),ea=(0,c.useRef)(null),[ei,er]=(0,c.useState)(1),[el,eo]=(0,c.useState)(0),[ec,eu]=(0,c.useState)(),[em,eh]=(0,c.useState)(!0),[ep,ex]=(0,c.useState)(!1),[ef,ey]=(0,c.useState)(),[ev,e_]=(0,c.useState)(!1),[ej,eb]=(0,c.useState)(!1),ew="rls-editor",eS=m.Ry({name:m.Z_().min(1,"Please provide a name"),table:m.Z_(),behavior:m.Z_(),command:m.Z_(),roles:m.Z_()}),ek={name:"",table:"",behavior:"permissive",command:"select",roles:""},eE=(0,d.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,a.F)(eS),defaultValues:ek}),{name:eC,table:eT,behavior:eL,command:eR,roles:eA}=eE.watch(),eq=["update","all"].includes(eR),eP=void 0!==P&&eC!==P.name,{mutate:eZ,isLoading:ez}=(0,y.r)({onSuccess:async()=>{await D.invalidateQueries(f.R.list(I)),u.Am.success("Successfully created new policy"),Z()},onError:e=>eu(e)}),{mutate:eI,isLoading:eD}=(0,x.k)({onSuccess:()=>{u.Am.success("Successfully updated policy"),Z()}}),eM=()=>{var e,t,n,s;let a=(null!==(n=null===(e=Y.current)||void 0===e?void 0:e.getValue().trim())&&void 0!==n?n:null)||null,i=(null!==(s=null===(t=ea.current)||void 0===t?void 0:t.getValue().trim())&&void 0!==s?s:null)||null,r=void 0===P&&(eC.length>0||eA.length>0||a||i),l=void 0!==P&&L(P,{name:eC,roles:0===eA.length?["public"]:eA.split(", "),definition:a,check:"INSERT"===eR?a:i});r||l?eb(!0):Z()};return(0,c.useEffect)(()=>{if(t){if(F&&e_(!0),void 0!==P){let{name:e,action:t,table:n,command:s,roles:a}=P;eE.reset({name:e,table:n,behavior:t.toLowerCase(),command:s.toLowerCase(),roles:1===a.length&&"public"===a[0]?"":a.join(", ")}),P.definition&&O("  ".concat(P.definition)),P.check&&B("  ".concat(P.check)),P.check&&"INSERT"!==P.command&&G(!0)}else void 0!==R&&eE.reset({...ek,table:R})}else{var e,n;null===(e=Y.current)||void 0===e||e.setValue(""),null===(n=ea.current)||void 0===n||n.setValue(""),e_(!1),eb(!1),eu(void 0),ex(!1),ey(void 0),O(""),B(""),G(!1),U(void 0),eE.reset(ek)}},[t]),(0,c.useEffect)(()=>{var e;null===(e=Y.current)||void 0===e||e.layout({width:0,height:0}),window.requestAnimationFrame(()=>{var e;null===(e=Y.current)||void 0===e||e.layout()})},[ep,ec,em]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.l0,{...eE,children:(0,s.jsx)("form",{id:ew,onSubmit:eE.handleSubmit(e=>{var t,s,a;let{name:i,table:r,behavior:l,command:c,roles:d}=e,u=null!==(a=null===(t=Y.current)||void 0===t?void 0:t.getValue().trim())&&void 0!==a?a:void 0,m=null===(s=ea.current)||void 0===s?void 0:s.getValue().trim();if("insert"===c&&(m=u),"insert"===c&&(void 0===m||0===m.length))return U("Please provide a SQL expression for the WITH CHECK statement");if("insert"!==c&&(void 0===u||0===u.length))return U("Please provide a SQL expression for the USING statement");if(U(void 0),void 0===P){let e=T({name:i,schema:n,table:r,behavior:l,command:c,roles:0===d.length?"public":d,using:null!=u?u:"",check:"insert"===c?null!=u?u:"":null!=m?m:""});eu(void 0),eZ({sql:e,projectRef:null==M?void 0:M.ref,connectionString:null==M?void 0:M.connectionString,handleError:e=>{throw e}})}else if(void 0!==M){let e={},t=0===d.length?["public"]:d.split(", ");if(i!==P.name&&(e.name=i),o()(P.roles,t)||(e.roles=t),null!==P.definition&&P.definition!==u&&(e.definition=u),"INSERT"===P.command?null!==P.check&&P.check!==u&&(e.check=u):null!==P.check&&P.check!==m&&(e.check=m),0===Object.keys(e).length)return Z();eI({id:P.id,projectRef:M.ref,connectionString:null==M?void 0:M.connectionString,payload:e})}}),children:(0,s.jsx)(j.yo,{open:t,onOpenChange:()=>eM(),children:(0,s.jsxs)(j.ue,{showClose:!1,size:ev?"lg":"default",className:(0,b.cn)("bg-surface-200 p-0 flex flex-row gap-0",ev?"!min-w-[100vw] lg:!min-w-[1000px]":"!min-w-[100vw] lg:!min-w-[600px]"),children:[(0,s.jsxs)("div",{className:(0,b.cn)("flex flex-col grow w-full",ev&&"w-[60%]"),children:[(0,s.jsx)(J,{selectedPolicy:P,showTools:ev,setShowTools:e_}),(0,s.jsxs)("div",{className:"flex flex-col h-full w-full justify-between overflow-y-auto",children:[(0,s.jsx)(H,{schema:n,searchString:l,selectedTable:R,isEditing:void 0!==P,form:eE,onUpdateCommand:e=>{U(void 0),["update","all"].includes(e)?G(!0):G(!1)},authContext:z}),(0,s.jsxs)("div",{className:"h-full",children:[(0,s.jsx)(A,{schema:n,selectedPolicy:P,formFields:{name:eC,table:eT,behavior:eL,command:eR,roles:eA}}),(0,s.jsx)("div",{className:"mt-1 relative block",style:{height:et<=100?"".concat(8+et,"px"):"108px"},children:(0,s.jsx)(eN,{disableTabToUsePlaceholder:!0,readOnly:!F,id:"rls-exp-one-editor",placeholder:"insert"===eR?"-- Provide a SQL expression for the with check statement":"-- Provide a SQL expression for the using statement",defaultValue:"insert"===eR?Q:V,value:"insert"===eR?Q:V,editorRef:Y,monacoRef:K,lineNumberStart:6,onChange:()=>{var e,t,n,s,a;en(null!==(s=null===(e=Y.current)||void 0===e?void 0:e.getContentHeight())&&void 0!==s?s:0),ee(null!==(a=null===(n=Y.current)||void 0===n?void 0:null===(t=n.getModel())||void 0===t?void 0:t.getLineCount())&&void 0!==a?a:1)},onMount:()=>{setTimeout(()=>{var e,t,n,s,a;en(null!==(s=null===(e=Y.current)||void 0===e?void 0:e.getContentHeight())&&void 0!==s?s:0),ee(null!==(a=null===(n=Y.current)||void 0===n?void 0:null===(t=n.getModel())||void 0===t?void 0:t.getLineCount())&&void 0!==a?a:1)},200)}})}),(0,s.jsx)("div",{className:"bg-surface-300 py-1",children:(0,s.jsxs)("div",{className:"flex items-center",style:{fontSize:"14px"},children:[(0,s.jsx)("div",{className:"w-[57px]",children:(0,s.jsx)("p",{className:"w-[31px] flex justify-end font-mono text-sm text-foreground-light select-none",children:7+$})}),(0,s.jsx)("p",{className:"font-mono tracking-tighter",children:X?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-[#569cd6]",children:"with check"})," ",(0,s.jsx)("span",{className:"text-[#ffd700]",children:"("})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-[#ffd700]",children:")"}),";"]})})]})}),X&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mt-1 min-h-[28px] relative block",style:{height:el<=100?"".concat(8+el,"px"):"108px"},children:(0,s.jsx)(eN,{disableTabToUsePlaceholder:!0,readOnly:!F,id:"rls-exp-two-editor",placeholder:"-- Provide a SQL expression for the with check statement",defaultValue:Q,value:Q,editorRef:ea,monacoRef:es,lineNumberStart:7+$,onChange:()=>{var e,t,n,s,a;eo(null!==(s=null===(e=ea.current)||void 0===e?void 0:e.getContentHeight())&&void 0!==s?s:0),er(null!==(a=null===(n=ea.current)||void 0===n?void 0:null===(t=n.getModel())||void 0===t?void 0:t.getLineCount())&&void 0!==a?a:1)},onMount:()=>{setTimeout(()=>{var e,t,n,s,a;eo(null!==(s=null===(e=ea.current)||void 0===e?void 0:e.getContentHeight())&&void 0!==s?s:0),er(null!==(a=null===(n=ea.current)||void 0===n?void 0:null===(t=n.getModel())||void 0===t?void 0:t.getLineCount())&&void 0!==a?a:1)},200)}})}),(0,s.jsx)("div",{className:"bg-surface-300 py-1",children:(0,s.jsxs)("div",{className:"flex items-center",style:{fontSize:"14px"},children:[(0,s.jsx)("div",{className:"w-[57px]",children:(0,s.jsx)("p",{className:"w-[31px] flex justify-end font-mono text-sm text-foreground-light select-none",children:8+$+ei})}),(0,s.jsxs)("p",{className:"font-mono tracking-tighter",children:[(0,s.jsx)("span",{className:"text-[#ffd700]",children:")"}),";"]})]})})]}),eP&&(0,s.jsx)(q,{oldName:P.name,newName:eC,schema:n,table:eT,lineNumber:8+$+(X?ei:0)}),void 0!==W&&(0,s.jsx)("p",{className:"px-5 py-2 pb-0 text-sm text-red-900",children:W}),eq&&(0,s.jsxs)("div",{className:"px-5 py-3 flex items-center gap-x-2",children:[(0,s.jsx)(N.X,{id:"use-check",name:"use-check",checked:X,onCheckedChange:()=>{U(void 0),G(!X)}}),(0,s.jsx)(w._,{className:"text-xs cursor-pointer",htmlFor:"use-check",children:"Use check expression"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[void 0!==ec&&(0,s.jsx)(eg,{error:ec,open:em,setOpen:eh}),(0,s.jsxs)(j.FF,{className:"flex items-center !justify-end px-5 py-4 w-full border-t",children:[(0,s.jsx)(S.z,{type:"default",disabled:ez||eD,onClick:()=>eM(),children:"Cancel"}),(0,s.jsx)(p.u,{form:ew,htmlType:"submit",loading:ez||eD,disabled:!F||ez||eD,tooltip:{content:{side:"top",text:F?void 0:"You need additional permissions to update policies"}},children:"Save policy"})]})]})]})]}),ev&&(0,s.jsx)("div",{className:(0,b.cn)("border-l shadow-[rgba(0,0,0,0.13)_-4px_0px_6px_0px] z-10",ev&&"w-[50%]","bg-studio overflow-auto"),children:(0,s.jsxs)(k.mQ,{defaultValue:"templates",className:"flex flex-col h-full w-full",children:[(0,s.jsx)(k.dr,{className:"flex gap-4 px-content pt-2",children:(0,s.jsx)(k.SP,{value:"templates",className:"px-0 data-[state=active]:bg-transparent",children:"Templates"},"templates")}),(0,s.jsx)(k.nU,{value:"templates",className:(0,b.cn)("!mt-0 overflow-y-auto","data-[state=active]:flex data-[state=active]:grow"),children:(0,s.jsx)(E.x,{className:"h-full w-full",children:(0,s.jsx)(ed,{schema:n,table:eT,selectedPolicy:P,selectedTemplate:ef,onSelectTemplate:e=>{var t;eE.setValue("name",e.name),eE.setValue("behavior","permissive"),eE.setValue("command",e.command.toLowerCase()),eE.setValue("roles",null!==(t=e.roles.join(", "))&&void 0!==t?t:""),O("  ".concat(e.definition)),B("  ".concat(e.check)),ee(1),er(1),U(void 0),["update","all"].includes(e.command.toLowerCase())&&e.check.length>0?G(!0):G(!1)}})})})]})})]})})})}),(0,s.jsx)(C.Z,{visible:ej,title:"Discard changes",confirmLabel:"Discard",onCancel:()=>eb(!1),onConfirm:()=>{Z(),eb(!1)},children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to close the editor? Any unsaved changes on your policy and conversations with the Assistant will be lost."})})]})});ew.displayName="PolicyEditorPanel"},7539:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var s=n(97458),a=n(12436),i=n(32691),r=n(65921),l=n(67628),o=n(72909),c=n(58326),d=n(83145),u=n.n(d),m=n(10947),h=n(90839),p=n(86976),x=n(37756);let f=e=>[{title:"Manage",items:[{name:"Users",key:"users",url:"/project/".concat(e,"/auth/users"),items:[]}]},{title:"Configuration",items:[{name:"Policies",key:"policies",url:"/project/".concat(e,"/auth/policies"),items:[]},...x.Qy?[{name:"Sign In / Up",key:"sign-in-up",pages:["providers","third-party"],url:"/project/".concat(e,"/auth/providers"),items:[]},{name:"Sessions",key:"sessions",url:"/project/".concat(e,"/auth/sessions"),items:[]},{name:"Rate Limits",key:"rate-limits",url:"/project/".concat(e,"/auth/rate-limits"),items:[]},{name:"Emails",key:"emails",pages:["templates","smtp"],url:"/project/".concat(e,"/auth/templates"),items:[]},{name:"Multi-Factor",key:"mfa",url:"/project/".concat(e,"/auth/mfa"),items:[]},{name:"URL Configuration",key:"url-configuration",url:"/project/".concat(e,"/auth/url-configuration"),items:[]},{name:"Attack Protection",key:"protection",url:"/project/".concat(e,"/auth/protection"),items:[]},{name:"Auth Hooks",key:"hooks",url:"/project/".concat(e,"/auth/hooks"),items:[],label:"BETA"},{name:"Advanced",key:"advanced",url:"/project/".concat(e,"/auth/advanced"),items:[]}]:[]]}],y=()=>{let{ref:e="default"}=(0,a.UO)(),t=(0,r.ar)();(0,o.kM)({projectRef:e});let n=(0,i.useRouter)().pathname.split("/")[4];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Q,{page:n,menu:f(e),"data-sentry-element":"ProductMenu","data-sentry-source-file":"AuthLayout.tsx"}),t&&(0,s.jsx)("div",{className:"px-3",children:(0,s.jsxs)(m.bZ,{children:[(0,s.jsx)(m.Cd,{className:"text-sm",children:"Column Privileges has been shifted"}),(0,s.jsxs)(m.X,{className:"text-xs",children:[(0,s.jsx)("p",{className:"mb-2",children:"It can now be found in the menu under the database section."}),(0,s.jsx)(h.z,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(u(),{href:"/project/".concat(e,"/database/column-privileges"),children:"Head over to Database"})})]})]})})]})};var g=(0,c.Q)(e=>{let{title:t,children:n}=e;return(0,s.jsx)(p.Z,{title:t||"Authentication",product:"Authentication",productMenu:(0,s.jsx)(y,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"AuthLayout","data-sentry-source-file":"AuthLayout.tsx",children:n})})},10916:function(e,t,n){"use strict";var s=n(97458),a=n(50588),i=n(37756);t.Z=()=>(0,s.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center","data-sentry-component":"NoSearchResults","data-sentry-source-file":"NoSearchResults.tsx",children:[(0,s.jsx)(a.Z,{src:"".concat(i.GW,"/img/no-search-results.svg"),preProcessor:e=>e.replace(/svg/,'svg className="mb-2 w-16 h-16 text-color-inherit"'),"data-sentry-element":"SVG","data-sentry-source-file":"NoSearchResults.tsx"}),(0,s.jsx)("p",{className:"w-64 text-center text-sm opacity-50",children:"Hmm, we couldn't find any results that match your query."})]})},62234:function(e,t,n){"use strict";var s=n(97458),a=n(5295),i=n(91587),r=n(83145),l=n.n(r),o=n(52983),c=n(65092);t.Z=e=>{let t,{title:n,description:r,children:d,footer:u,url:m="",linkHref:h="",imgUrl:p,imgAlt:x,icon:f,className:y,loading:g=!1,fixedHeight:v=!0,hideChevron:_=!1,titleClass:j="",containerElement:b,...N}=e,w=m||h||N.onClick,S={},k=b&&o.isValidElement(b)?e=>(0,o.cloneElement)(b,{...e}):void 0;N.onClick?(t=null!=k?k:"button",S=N):h?(t=null!=k?k:l(),S={href:h,...N}):m?(t=null!=k?k:"a",S={href:m,...N}):(t=null!=k?k:"div",S=N);let E=["group relative text-left","bg-surface-100","border border-surface","rounded-md p-5 flex flex-row","transition ease-in-out duration-150"];w&&(E=[...E,"cursor-pointer","hover:bg-surface-200","hover:border-control"]),v&&(E=[...E,"min-h-32 md:min-h-44"]);let C=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"mr-4 flex flex-col","data-sentry-component":"ImageContainer","data-sentry-source-file":"CardButton.tsx",children:t})},T=(0,s.jsxs)(s.Fragment,{children:[p&&(0,s.jsx)(C,{children:(0,s.jsx)("img",{className:" transition-all group-hover:scale-110 ",src:"".concat(p),alt:"".concat(x),width:"26"})}),f&&(0,s.jsx)(C,{children:f}),(0,s.jsxs)("div",{className:"flex h-full w-full flex-col space-y-2",children:["string"==typeof n?(0,s.jsx)("h5",{className:"text-foreground pr-5 ".concat(j),children:n}):n,(d||r)&&(0,s.jsxs)("div",{className:"flex w-full flex-1 flex-col",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:r}),(0,s.jsx)("div",{className:"w-full",children:d&&d})]}),u&&(0,s.jsx)("div",{className:"w-full !mt-auto",children:u})]}),w&&(0,s.jsx)("div",{className:" absolute right-4 top-4 text-foreground-lighter transition-all duration-200 group-hover:right-3 group-hover:text-foreground ",children:g?(0,s.jsx)(a.Z,{className:"animate-spin"}):_?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(i.Z,{})})]});return(0,s.jsx)(t,{...S,className:(0,c.cn)(E,y),"data-sentry-element":"Container","data-sentry-component":"CardButton","data-sentry-source-file":"CardButton.tsx",children:T})}},66318:function(e,t,n){"use strict";var s=n(97458),a=n(62507),i=n(57304),r=n(52983),l=n(45536),o=n(90839),c=n(65092);t.Z=e=>{var t;let{text:n,asyncText:d,iconOnly:u=!1,children:m,onClick:h,copyLabel:p="Copy",copiedLabel:x="Copied",...f}=e,[y,g]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!y)return;let e=setTimeout(()=>g(!1),2e3);return()=>clearTimeout(e)},[y]),(0,s.jsx)(o.z,{onClick:async e=>{let t=d?await d():n;g(!0),await (0,l.vQ)(t),null==h||h(e)},...f,className:(0,c.cn)({"px-1":u},f.className),icon:y?(0,s.jsx)(a.Z,{strokeWidth:2,className:"text-brand"}):null!==(t=f.icon)&&void 0!==t?t:(0,s.jsx)(i.Z,{}),"data-sentry-element":"Button","data-sentry-component":"CopyButton","data-sentry-source-file":"CopyButton.tsx",children:!u&&(0,s.jsx)(s.Fragment,{children:null!=m?m:y?x:p})})}},61767:function(e,t,n){"use strict";var s=n(97458),a=n(44735);t.Z=e=>{let{resourceText:t,isFullPage:n=!1}=e,i=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(a.Z,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return n?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(i,{})})}):(0,s.jsx)(i,{})}},76767:function(e,t,n){"use strict";var s=n(97458),a=n(65092),i=n(90839);t.Z=e=>{let{searchString:t,onResetFilter:n,className:r}=e;return(0,s.jsxs)("div",{className:(0,a.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between",r),"data-sentry-component":"NoSearchResults","data-sentry-source-file":"NoSearchResults.tsx",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',t,'" did not return any results']})]}),void 0!==n&&(0,s.jsx)(i.z,{type:"default",onClick:()=>n(),children:"Reset filter"})]})}},55228:function(e,t,n){"use strict";var s=n(97458),a=n(83145),i=n.n(a),r=n(94059),l=n(73565),o=n(90839);t.Z=e=>{let{name:t="",isActive:n,isExternal:a,icon:c,rightIcon:d,url:u="",target:m="_self",onClick:h,textClassName:p="",hoverText:x="",label:f}=e,y=(0,s.jsx)(r.ZP.Item,{icon:c,rounded:!0,active:n,onClick:h,children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,s.jsxs)("div",{title:x||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+p,children:[(0,s.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,s.jsx)(l.C,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),d&&(0,s.jsx)("div",{children:d})]})});return u?a?(0,s.jsx)(o.z,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,s.jsx)(i(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,s.jsx)(i(),{href:u,className:"block",target:m,children:y}):y}},66902:function(e,t,n){"use strict";var s=n(97458),a=n(198),i=n(50416),r=n(62507),l=n(36950),o=n(52983),c=n(88971),d=n(58015),u=n(90817),m=n(90839),h=n(54135),p=n(10947),x=n(42026),f=n(47482),y=n(64890);t.Z=e=>{let{className:t,disabled:n=!1,size:g="tiny",showError:v=!0,selectedSchemaName:_,supportSelectAll:j=!1,excludedSchemas:b=[],onSelectSchema:N,onSelectCreateSchema:w}=e,[S,k]=(0,o.useState)(!1),E=(0,u.Xo)(a.KA.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:C}=(0,c.d2)(),{data:T,isLoading:L,isSuccess:R,isError:A,error:q,refetch:P}=(0,d.Q1)({projectRef:null==C?void 0:C.ref,connectionString:null==C?void 0:C.connectionString}),Z=(T||[]).filter(e=>!b.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[L&&(0,s.jsx)(m.z,{type:"default",className:"w-full [&>span]:w-full",size:g,disabled:!0,children:(0,s.jsx)(h.O,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),v&&A&&(0,s.jsxs)(p.bZ,{variant:"warning",className:"!px-3 !py-3",children:[(0,s.jsx)(p.Cd,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,s.jsxs)(p.X,{className:"text-xs mb-2 break-words",children:["Error: ",null==q?void 0:q.message]}),(0,s.jsx)(m.z,{type:"default",size:"tiny",onClick:()=>P(),children:"Reload schemas"})]}),R&&(0,s.jsxs)(x.J2,{open:S,onOpenChange:k,modal:!1,children:[(0,s.jsx)(x.xo,{asChild:!0,children:(0,s.jsx)(m.z,{size:g,disabled:n,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,s.jsx)(i.Z,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:_?(0,s.jsxs)("div",{className:"w-full flex gap-1",children:[(0,s.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,s.jsx)("p",{className:"text-foreground",children:"*"===_?"All schemas":_})]}):(0,s.jsx)("div",{className:"w-full flex gap-1",children:(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema…"})})})}),(0,s.jsx)(x.yk,{className:"p-0 min-w-[200px]",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,s.jsxs)(f.mY,{children:[(0,s.jsx)(f.sZ,{placeholder:"Find schema..."}),(0,s.jsxs)(f.e8,{children:[(0,s.jsx)(f.rb,{children:"No schemas found"}),(0,s.jsx)(f.fu,{children:(0,s.jsxs)(y.x,{className:(Z||[]).length>7?"h-[210px]":"",children:[j&&(0,s.jsxs)(f.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{N("*"),k(!1)},onClick:()=>{N("*"),k(!1)},children:[(0,s.jsx)("span",{children:"All schemas"}),"*"===_&&(0,s.jsx)(r.Z,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==Z?void 0:Z.map(e=>(0,s.jsxs)(f.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{N(e.name),k(!1)},onClick:()=>{N(e.name),k(!1)},children:[(0,s.jsx)("span",{children:e.name}),_===e.name&&(0,s.jsx)(r.Z,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==w&&E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.zz,{}),(0,s.jsx)(f.fu,{children:(0,s.jsxs)(f.di,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{w(),k(!1)},onClick:()=>{w(),k(!1)},children:[(0,s.jsx)(l.Z,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},53502:function(e,t,n){"use strict";n.r(t);var s=n(97458),a=n(198),i=n(50663),r=n.n(i),l=n(77270),o=n(52983),c=n(85490),d=n(80066),u=n(30976),m=n(74696),h=n(7539),p=n(88971),x=n(5529),f=n(67096),y=n(61767),g=n(66902),v=n(63621),_=n(92259),j=n(58015),b=n(79581),N=n(90817),w=n(53114),S=n(96444),k=n(51571),E=n(95767),C=n(65921),T=n(86186);let L=(e,t,n)=>{if(!n)return e.slice().sort((e,t)=>e.name.localeCompare(t.name));{let s=n.toLowerCase(),a=e=>e.toLowerCase().includes(s),i=t.filter(e=>a(e.name));return e.slice().filter(e=>e.name.toLowerCase().includes(s)||e.id.toString()===s||i.some(t=>t.table===e.name)).sort((e,t)=>e.name.localeCompare(t.name))}},R=()=>{let[e,t]=(0,w.x)(),{schema:n="public",search:i=""}=e,{project:h}=(0,p.d2)(),{setEditorPanel:E}=(0,T.WZ)(),R=(0,C.uL)(),[A,q]=(0,o.useState)(),[P,Z]=(0,o.useState)(!1),[z,I]=(0,o.useState)(),{data:D}=(0,j.Q1)({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString}),[M]=r()(D,e=>{var t;return(null==e?void 0:e.name)!=="realtime"&&S.s.includes(null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"")}),F=null==D?void 0:D.find(e=>e.name===n),V=M.some(e=>e.id===(null==F?void 0:F.id)),{data:O}=(0,_.r)({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString}),{data:Q,isLoading:B,isSuccess:H,isError:W,error:U}=(0,b.Bj)({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString,schema:n}),X=L(null!=Q?Q:[],null!=O?O:[],i),G=(0,N.Xo)(a.KA.TENANT_SQL_ADMIN_READ,"policies");return(0,N.N4)()&&!G?(0,s.jsx)(y.Z,{isFullPage:!0,resourceText:"view this project's RLS policies"}):(0,s.jsxs)("div",{className:"flex flex-col h-full","data-sentry-component":"AuthPoliciesPage","data-sentry-source-file":"policies.tsx",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("div",{className:"w-full flex flex-col lg:flex-row items-center justify-between gap-2",children:[(0,s.jsx)(g.Z,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:n,onSelectSchema:n=>{t({...e,search:void 0,schema:n})},"data-sentry-element":"SchemaSelector","data-sentry-source-file":"policies.tsx"}),(0,s.jsxs)("div",{className:"w-full flex-grow flex items-center justify-between gap-2 lg:gap-4",children:[(0,s.jsx)(k.Z,{size:"tiny",placeholder:"Filter tables and policies",className:"block w-full lg:w-52",value:i||"",onChange:n=>{let s=n.target.value;t({...e,search:""===s?void 0:s})},icon:(0,s.jsx)(l.Z,{size:14}),"data-sentry-element":"Input","data-sentry-source-file":"policies.tsx"}),(0,s.jsx)(f.G,{href:"https://supabase.com/docs/learn/auth-deep-dive/auth-row-level-security","data-sentry-element":"DocsButton","data-sentry-source-file":"policies.tsx"})]})]})}),B&&(0,s.jsx)(v.A,{}),W&&(0,s.jsx)(x.Z,{error:U,subject:"Failed to retrieve tables"}),H&&(0,s.jsx)(d.Z,{schema:n,tables:X,hasTables:Q.length>0,isLocked:V,onSelectCreatePolicy:e=>{R?E({open:!0,initialValue:'create policy "replace_with_policy_name"\n  on '.concat(n,".").concat(e,"\n  for select\n  to authenticated\n  using (\n    true  -- Write your policy condition here\n);"),label:'Create new RLS policy on "'.concat(e,'"'),saveLabel:"Create policy",initialPrompt:'Create and name a entirely new RLS policy for the "'.concat(e,'" table in the ').concat(n," schema. The policy should...")}):(q(e),Z(!0))},onSelectEditPolicy:e=>{if(R){let t=(0,u.z)(e),n=(0,m.gA)(e.schema,e.table);E({open:!0,initialValue:t,label:'Edit policy "'.concat(e.name,'"'),saveLabel:"Update policy",templates:n.map(e=>({name:e.templateName,description:e.description,content:e.statement})),initialPrompt:'Update the policy with name "'.concat(e.name,'" in the ').concat(e.schema," schema on the ").concat(e.table," table. It should...")})}else I(e),Z(!0)}}),(0,s.jsx)(c.r,{visible:P,schema:n,searchString:i,selectedTable:A,selectedPolicy:z,onSelectCancel:()=>{q(void 0),Z(!1),I(void 0)},authContext:"database","data-sentry-element":"PolicyEditorPanel","data-sentry-source-file":"policies.tsx"})]})};R.getLayout=e=>(0,s.jsx)(E.Z,{children:(0,s.jsx)(h.Z,{title:"Auth",children:(0,s.jsx)("div",{className:"h-full p-4",children:e})})}),t.default=R},32472:function(e,t,n){"use strict";var s=n(97458),a=n(52983),i=n(42155),r=n(19540),l=n(90839);t.Z=e=>{let{visible:t=!1,danger:n=!1,title:o="",description:c="",size:d="small",buttonLabel:u="",buttonLoadingLabel:m="",onSelectCancel:h=()=>{},onSelectConfirm:p=()=>{}}=e;(0,a.useEffect)(()=>{t&&f(!1)},[t]);let[x,f]=(0,a.useState)(!1),y=()=>{f(!0),p()};return(0,s.jsx)(i.Z,{header:o,visible:t,title:o,description:c,size:d,hideFooter:!0,onCancel:h,"data-sentry-element":"Modal","data-sentry-component":"ConfirmModal","data-sentry-source-file":"ConfirmDialog.tsx",children:(0,s.jsx)(r.Z,{initialValues:{},validateOnBlur:!0,onSubmit:()=>y(),validate:()=>[],"data-sentry-element":"Form","data-sentry-source-file":"ConfirmDialog.tsx",children:()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.Z.Content,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.z,{block:!0,htmlType:"button",type:"default",onClick:h,disabled:x,children:"Cancel"}),(0,s.jsx)(l.z,{htmlType:"submit",block:!0,type:n?"danger":"primary",disabled:x,loading:x,children:m&&x?m:u||"Confirm"})]})})})})})}},21775:function(e,t,n){"use strict";n.d(t,{H:function(){return i},a:function(){return r}});var s=n(97458),a=n(98686);let i=e=>{let{name:t}=e;return(0,s.jsx)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex cursor-not-allowed items-center space-x-2 rounded bg-gray-600 py-0.5 px-2 text-sm","data-sentry-component":"BadgeDisabled","data-sentry-source-file":"Badges.tsx",children:(0,s.jsx)("span",{className:"opacity-50",children:t})})},r=e=>{let{name:t,handleRemove:n}=e;return(0,s.jsxs)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex items-center space-x-2 rounded bg-surface-300 py-0.5 px-2 text-sm",onClick:e=>e.preventDefault(),"data-sentry-component":"BadgeSelected","data-sentry-source-file":"Badges.tsx",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)(a.Z,{size:12,className:"cursor-pointer opacity-50 transition hover:opacity-100",onClick:e=>{e.preventDefault(),e.stopPropagation(),n()},"data-sentry-element":"X","data-sentry-source-file":"Badges.tsx"})]})}},6514:function(e,t,n){"use strict";n.d(t,{m:function(){return f}});var s=n(97458),a=n(40916),i=n.n(a),r=n(92238),l=n.n(r),o=n(98601),c=n(62507),d=n(52983),u=n(42026),m=n(65092),h=n(47482),p=n(64890),x=n(21775);let f=e=>{let{options:t,value:n,placeholder:a,searchPlaceholder:r="Search for option",disabled:f=!1,onChange:y=()=>{}}=e,[g,v]=(0,d.useState)(!1),[_,j]=(0,d.useState)(n||[]),b=n||_,N=i()(t,["disabled"],["desc"]),w=e=>void 0!==(b||[]).find(t=>t===e.value),S=e=>{let n=w(e)?[...l()(b,e.value)]:[...b.concat([e.value])],s=t.filter(e=>e.disabled).map(e=>e.name),a=[...new Set(n.concat(s))];j(a),y(a)};return(0,s.jsx)("div",{className:f?"pointer-events-none opacity-50":"","data-sentry-component":"MultiSelectV2","data-sentry-source-file":"MultiSelectV2.tsx",children:(0,s.jsxs)(u.J2,{open:g,onOpenChange:v,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:[(0,s.jsx)(u.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:(0,s.jsxs)("div",{className:(0,m.cn)("relative border border-strong bg-control rounded","flex w-full flex-wrap items-start gap-1.5 p-1.5 cursor-pointer","".concat(0===b.length?"h-9":"")),onClick:()=>v(!0),children:[0===b.length&&a&&(0,s.jsx)("div",{className:"px-2 text-sm text-foreground-light h-full flex items-center",children:a}),b.map((e,t)=>{var n;let a="".concat(e,"-").concat(t),i=N.find(t=>t.value===e),r=null!==(n=null==i?void 0:i.disabled)&&void 0!==n&&n;return i?r?(0,s.jsx)(x.H,{name:i.name},a):(0,s.jsx)(x.a,{name:i.name,handleRemove:()=>S(i)},a):(0,s.jsx)(s.Fragment,{})}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 pl-3 pr-2 flex space-x-1 items-center cursor-pointer ",children:(0,s.jsx)(o.Z,{size:16,strokeWidth:2,className:"text-foreground-lighter","data-sentry-element":"ChevronDown","data-sentry-source-file":"MultiSelectV2.tsx"})})]})}),(0,s.jsx)(u.yk,{className:"p-0 w-96 border-strong",side:"bottom",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:(0,s.jsxs)(h.mY,{"data-sentry-element":"Command_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:[(0,s.jsx)(h.sZ,{placeholder:r,"data-sentry-element":"CommandInput_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx"}),(0,s.jsxs)(h.e8,{"data-sentry-element":"CommandList_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:[(0,s.jsx)(h.rb,{"data-sentry-element":"CommandEmpty_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:"No options found"}),(0,s.jsx)(h.fu,{"data-sentry-element":"CommandGroup_Shadcn_","data-sentry-source-file":"MultiSelectV2.tsx",children:(0,s.jsx)(p.x,{className:(0,m.cn)(N.length>7?"h-[210px]":""),"data-sentry-element":"ScrollArea","data-sentry-source-file":"MultiSelectV2.tsx",children:null==N?void 0:N.map(e=>{let t=!!(b&&b.find(t=>t===e.value));return(0,s.jsx)(h.di,{value:e.value,className:"cursor-pointer w-full",onClick:()=>S(e),onSelect:()=>S(e),children:(0,s.jsxs)("div",{className:"w-full flex items-center justify-between",children:[e.name,t&&(0,s.jsx)(c.Z,{size:14})]})},e.id)})})})]})]})})]})})}},19540:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var s=n(97458),a=n(52983),i=n(68985),r=n(11499);function l(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function o(e){let{validate:t,...n}=e,[o,c]=(0,a.useReducer)(l,null),d=(0,i.TA)({validateOnBlur:!0,...n,validationSchema:n.validationSchema,initialValues:n.initialValues,onSubmit:n.onSubmit,validate:t||function(){return o}});return(0,s.jsx)("form",{id:n.id,name:n.name,onSubmit:d.handleSubmit,className:n.className,style:n.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,s.jsx)(r.o,{values:d.values,errors:d.errors,formContextOnChange:d.handleChange,handleBlur:d.handleBlur,touched:d.touched,fieldLevelValidation:function(e,t){c({key:e,error:t})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:n.children({errors:d.errors,touched:d.touched,isSubmitting:d.isSubmitting,isValidating:d.isValidating,submitCount:d.submitCount,initialValues:d.initialValues,values:d.values,handleReset:d.handleReset,resetForm:d.resetForm,setFieldValue:d.setFieldValue})})})}},94059:function(e,t,n){"use strict";n.d(t,{ZP:function(){return m}});var s=n(97458),a=n(52983),i=n(25843),r=n(65092);function l(e){let{children:t,className:n,tag:a="div",style:i}=e;return(0,s.jsx)("".concat(a),{style:i,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}l.Title=function(e){let{className:t,level:n=1,children:a,style:i}=e;return(0,s.jsx)("h".concat(n),{style:i,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:a})},l.Text=function(e){let{className:t,children:n,style:a,type:i,disabled:r,mark:l,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:h}=e;return o?(0,s.jsx)("code",{style:a,children:n}):l?(0,s.jsx)("mark",{style:a,children:n}):c?(0,s.jsx)("kbd",{style:a,children:n}):m?(0,s.jsx)("strong",{style:a,children:n}):(0,s.jsx)("span",{style:a,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:n})},l.Link=function(e){let{children:t,target:n="_blank",href:a,className:i,onClick:r,style:l}=e;return(0,s.jsx)("a",{onClick:r,href:a,target:n,rel:"noopener noreferrer",style:l,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})};let o=(0,a.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,s.jsx)(o.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:n,ulClassName:a,style:i,type:r="text"}=e;return(0,s.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:n,style:i,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)(c,{type:r,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)("ul",{className:a,children:t})})})}u.Item=function(e){let{children:t,icon:n,active:a,rounded:l,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:m}=e,h=(0,i.Z)("menu"),{type:p}=d(),x=[h.item.base];x.push(h.item.variants[p].base),a?x.push(h.item.variants[p].active):x.push(h.item.variants[p].normal);let f=[h.item.content.base];a?f.push(h.item.content.active):f.push(h.item.content.normal);let y=[h.item.icon.base];return a?y.push(h.item.icon.active):y.push(h.item.icon.normal),(0,s.jsxs)("li",{role:"menuitem",className:(0,r.cn)("outline-none",x),style:m,onClick:o,"aria-current":a?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[n&&(0,s.jsx)("div",{className:"".concat(y.join(" ")," min-w-fit"),children:n}),(0,s.jsx)("span",{className:f.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:n,title:a}=e,r=(0,i.Z)("menu"),{type:l}=d();return(0,s.jsxs)("div",{className:[r.group.base,r.group.variants[l]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[n&&(0,s.jsx)("span",{className:r.group.icon,children:n}),(0,s.jsx)("span",{className:r.group.content,children:a}),t]})},u.Misc=function(e){let{children:t}=e;return(0,s.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)(l.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)("span",{children:t})})})};var m=u},68839:function(e,t,n){"use strict";n.d(t,{Ee:function(){return o},kr:function(){return c}});var s=n(97458),a=n(11908),i=n(17432),r=n(52983),l=n(65092);let o=r.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,s.jsx)(a.fC,{className:(0,l.cn)("grid gap-2",n),...i,ref:t})});o.displayName=a.fC.displayName,r.forwardRef((e,t)=>{let{className:n,children:r,...o}=e;return(0,s.jsx)(a.ck,{ref:t,className:(0,l.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...o,children:(0,s.jsx)(a.z$,{className:"flex items-center justify-center",children:(0,s.jsx)(i.Z,{className:"h-2.5 w-2.5 fill-current text-current"})})})}).displayName=a.ck.displayName;let c=r.forwardRef((e,t)=>{let{image:n,label:i,showIndicator:r=!0,...o}=e;return(0,s.jsxs)(a.ck,{ref:t,...o,className:(0,l.cn)("flex flex-col gap-2","w-48","bg-surface-200","rounded-md border border-strong","p-2","shadow-sm","hover:border-stronger hover:bg-surface-300","data-[state=checked]:border-primary","data-[state=checked]:ring-1 data-[state=checked]:ring-border","data-[state=checked]:bg-selection data-[state=checked]:border-foreground","transition-colors","group",o.className),children:[o.children,(0,s.jsxs)("div",{className:"flex gap-2 w-full",children:[r&&(0,s.jsxs)("div",{className:"relative w-3 h-3 min-w-3 mt-0.5",children:[(0,s.jsx)(a.z$,{className:(0,l.cn)("absolute","w-[10px] h-[10px]","left-[1px] top-[1px]","border border-background-surface-300","rounded-full","data-[state=checked]:border-background-surface-300","data-[state=checked]:ring-foreground","data-[state=checked]:bg-foreground")}),(0,s.jsx)("div",{className:(0,l.cn)("absolute","w-3 h-3","border border-stronger","rounded-full","group-hover:border-foreground-light","group-data-[state=checked]:border-foreground","transition-colors")})]}),(0,s.jsx)("label",{htmlFor:o.value,className:(0,l.cn)("text-xs transition-colors text-left","text-light","group-hover:text-foreground group-data-[state=checked]:text-foreground",o.disabled?"cursor-not-allowed":"cursor-pointer"),children:i})]})]})});c.displayName=a.ck.displayName},77627:function(e){e.exports={"spin-ai-icon-container":"ai-icon-animation-style_spin-ai-icon-container__7sgAA",spinAiIconContainer:"ai-icon-animation-style_spinAiIconContainer__rBP6P","ai-icon__container":"ai-icon-animation-style_ai-icon__container__2aXBS","ai-icon__grid":"ai-icon-animation-style_ai-icon__grid__Qrwxf","ai-icon__grid__square":"ai-icon-animation-style_ai-icon__grid__square__YU8EZ","ai-icon__grid__square--static":"ai-icon-animation-style_ai-icon__grid__square--static__1tOM_","ai-icon__container--allow-hover-effect":"ai-icon-animation-style_ai-icon__container--allow-hover-effect__HrB86","ai-icon__grid__square--step-1":"ai-icon-animation-style_ai-icon__grid__square--step-1__KATlI",step1_square1:"ai-icon-animation-style_step1_square1__BIjL3",step1_square2:"ai-icon-animation-style_step1_square2__QzsE7",step1_square3:"ai-icon-animation-style_step1_square3__ls1SO",step1_square4:"ai-icon-animation-style_step1_square4__Kk8zi","ai-icon__grid__square--step-2":"ai-icon-animation-style_ai-icon__grid__square--step-2__9OoIG",step2_square1:"ai-icon-animation-style_step2_square1__o_hcu",step2_square2:"ai-icon-animation-style_step2_square2__HBZt7",step2_square3:"ai-icon-animation-style_step2_square3__K6E2K",step2_square4:"ai-icon-animation-style_step2_square4__oDGDL","ai-icon__grid__square--step-3":"ai-icon-animation-style_ai-icon__grid__square--step-3__RldL4",step3_square1:"ai-icon-animation-style_step3_square1__Oo6vT",step3_square2:"ai-icon-animation-style_step3_square2__36Os9",step3_square3:"ai-icon-animation-style_step3_square3__Nj5rc",step3_square4:"ai-icon-animation-style_step3_square4__OFVFh","ai-icon__grid__square--step-4":"ai-icon-animation-style_ai-icon__grid__square--step-4__7o69c",step4_square1:"ai-icon-animation-style_step4_square1__G_8pn",step4_square2:"ai-icon-animation-style_step4_square2__KHYf3",step4_square3:"ai-icon-animation-style_step4_square3__XON12",step4_square4:"ai-icon-animation-style_step4_square4__Aq8dV","ai-icon__grid__square--step-5":"ai-icon-animation-style_ai-icon__grid__square--step-5__cF2Rx",step5_square1:"ai-icon-animation-style_step5_square1__me9Ru",step5_square2:"ai-icon-animation-style_step5_square2__0Ydfw",step5_square3:"ai-icon-animation-style_step5_square3__bOHqW",step5_square4:"ai-icon-animation-style_step5_square4__m2l32","ai-icon__grid__square--exiting--step-1":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-1__JYREY",exit_step1_square1:"ai-icon-animation-style_exit_step1_square1__C_GBC",exit_step1_square2:"ai-icon-animation-style_exit_step1_square2__TID0l",exit_step1_square3:"ai-icon-animation-style_exit_step1_square3__ADmUT",exit_step1_square4:"ai-icon-animation-style_exit_step1_square4__kilu_","ai-icon__grid__square--exiting--step-2":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-2__kDUVt",exit_step2_square1:"ai-icon-animation-style_exit_step2_square1__vmYa5",exit_step2_square2:"ai-icon-animation-style_exit_step2_square2__zxv0q",exit_step2_square3:"ai-icon-animation-style_exit_step2_square3__Dhey5",exit_step2_square4:"ai-icon-animation-style_exit_step2_square4__P1UKx","ai-icon__grid__square--exiting--step-3":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-3__h48Ts",exit_step3_square1:"ai-icon-animation-style_exit_step3_square1__l1FKu",exit_step3_square2:"ai-icon-animation-style_exit_step3_square2__4RPQL",exit_step3_square3:"ai-icon-animation-style_exit_step3_square3__s2vMz",exit_step3_square4:"ai-icon-animation-style_exit_step3_square4__Zros9","ai-icon__grid__square--exiting--step-4":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-4__VEmk_",exit_step4_square1:"ai-icon-animation-style_exit_step4_square1__bG99O",exit_step4_square2:"ai-icon-animation-style_exit_step4_square2__1Fxvf",exit_step4_square3:"ai-icon-animation-style_exit_step4_square3__EWeB7",exit_step4_square4:"ai-icon-animation-style_exit_step4_square4__HC5ov","ai-icon__grid__square--exiting--step-5":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-5___9jFB",exit_step5_square1:"ai-icon-animation-style_exit_step5_square1__w4ctB",exit_step5_square2:"ai-icon-animation-style_exit_step5_square2__UZdas",exit_step5_square3:"ai-icon-animation-style_exit_step5_square3__O_mvc",exit_step5_square4:"ai-icon-animation-style_exit_step5_square4__SKL7Z"}},70717:function(e,t,n){"use strict";n.d(t,{Z0:function(){return S},av:function(){return f},ck:function(){return w},rS:function(){return k},v2:function(){return N}});var s,a=n(52983),i=n(14517),r=n(73656);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,s,a={},i=Object.keys(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||(a[n]=e[n]);return a}var c=(0,a.createContext)({});function d(){return(0,a.useContext)(c)}var u=function(e){return a.createElement(c.Provider,{value:e.refTracker},e.children)},m=(s=new Map,{on:function(e,t){var n;return s.has(e)?null==(n=s.get(e))||n.add(t):s.set(e,new Set([t])),this},off:function(e,t){return t?s.get(e).delete(t):s.delete(e),this},emit:function(e,t){return"production"===r.env.NODE||s.has(e)||0===e||console.error("It seems that the menu you are trying to display is not renderer or you have a menu id mismatch.","You used the menu id: "+e),s.has(e)&&s.get(e).forEach(function(e){e(t)}),this}});function h(){return(0,a.useRef)(new Map).current}var p=function(e){var t=e.id,n=e.event,s=e.props,a=e.position;n.preventDefault&&n.preventDefault(),m.emit(0).emit(t,{event:n.nativeEvent||n,props:s,position:a})},x=function(){m.emit(0)};function f(e){return{show:function(t,n){p({id:(null==n?void 0:n.id)||(null==e?void 0:e.id),props:(null==n?void 0:n.props)||(null==e?void 0:e.props),event:t,position:null==n?void 0:n.position})},hideAll:function(){x()}}}var y=function(){};function g(e){return"function"==typeof e}function v(e){return"string"==typeof e}function _(e,t){return a.Children.map(a.Children.toArray(e).filter(Boolean),function(e){return(0,a.cloneElement)(e,t)})}function j(e,t){return g(e)?e(t):e}function b(e,t){return g(t)?l({},e,t(e)):l({},e,t)}var N=function(e){var t,n,s,r,c,d=e.id,p=e.theme,x=e.style,f=e.className,g=e.children,j=e.animation,N=void 0===j?"scale":j,w=e.onHidden,S=void 0===w?y:w,k=e.onShown,E=void 0===k?y:k,C=o(e,["id","theme","style","className","children","animation","onHidden","onShown"]),T=(0,a.useReducer)(b,{x:0,y:0,visible:!1,triggerEvent:{},propsFromTrigger:null,willLeave:!1}),L=T[0],R=T[1],A=(0,a.useRef)(null),q=(0,a.useRef)(!1),P=(t=L.visible,n=(0,a.useRef)(),(0,a.useEffect)(function(){n.current=t},[t]),n.current),Z=h(),z=(0,a.useState)(function(){return function(){var e,t,n,s,a=new Map,i=!1;function r(){s[e].node.focus()}function l(){return -1!==e||(o(),!1)}function o(){e+1<s.length?e++:e+1===s.length&&(e=0),i&&c(),r()}function c(){if(l()&&!n){var o=a.get(t),c=o.isRoot,d=o.items,u=o.focusedIndex,m=o.parentNode;t.classList.remove("react-contexify__submenu--is-open"),s=d,t=m,c&&(n=!0,a.clear()),i||(e=u,r())}}return{init:function(t){s=t,e=-1,n=!0},moveDown:o,moveUp:function(){-1===e||0===e?e=s.length-1:e-1<s.length&&e--,i&&c(),r()},openSubmenu:function(){if(l()&&e>=0&&s[e].isSubmenu){var o=Array.from(s[e].submenuRefTracker.values()),c=s[e].node;return a.set(c,{isRoot:n,focusedIndex:e,parentNode:t||c,items:s}),c.classList.add("react-contexify__submenu--is-open"),t=c,o.length>0?(e=0,s=o):i=!0,n=!1,r(),!0}return!1},closeSubmenu:c}}()})[0];function I(e){var t,n=e.event,s=e.props,a=e.position;n.stopPropagation();var i=a||(t={x:0,y:0},"touchend"===n.type&&n.changedTouches&&n.changedTouches.length>0?(t.x=n.changedTouches[0].clientX,t.y=n.changedTouches[0].clientY):(t.x=n.clientX,t.y=n.clientY),(!t.x||t.x<0)&&(t.x=0),(!t.y||t.y<0)&&(t.y=0),t),r=i.x,l=i.y;setTimeout(function(){R({visible:!0,willLeave:!1,x:r,y:l,triggerEvent:n,propsFromTrigger:s})},0)}function D(e){(void 0===e||2!==e.button&&!0!==e.ctrlKey||"contextmenu"===e.type)&&(N&&(v(N)||"exit"in N&&N.exit)?R(function(e){return{willLeave:e.visible}}):R(function(e){return{visible:!e.visible&&e.visible}}))}(0,a.useEffect)(function(){return q.current=!0,m.on(d,I).on(0,D),function(){m.off(d,I).off(0,D)}},[d]),(0,a.useEffect)(function(){q.current&&L.visible!==P&&(L.visible?E():S())},[L.visible,S,E]),(0,a.useEffect)(function(){L.visible?z.init(Array.from(Z.values())):Z.clear()},[L.visible,z,Z]),(0,a.useEffect)(function(){if(L.visible){var e=window,t=e.innerWidth,n=e.innerHeight,s=A.current,a=s.offsetWidth,i=s.offsetHeight,r=L.x,l=L.y;r+a>t&&(r-=r+a-t),l+i>n&&(l-=l+i-n),R({x:r,y:l})}},[L.visible]),(0,a.useEffect)(function(){function e(e){switch(e.preventDefault(),e.key){case"Enter":z.openSubmenu()||D();break;case"Escape":D();break;case"ArrowUp":z.moveUp();break;case"ArrowDown":z.moveDown();break;case"ArrowRight":z.openSubmenu();break;case"ArrowLeft":z.closeSubmenu()}}return L.visible&&(window.addEventListener("resize",D),window.addEventListener("contextmenu",D),window.addEventListener("click",D),window.addEventListener("scroll",D),window.addEventListener("keydown",e),window.addEventListener("blur",D)),function(){window.removeEventListener("resize",D),window.removeEventListener("contextmenu",D),window.removeEventListener("click",D),window.removeEventListener("scroll",D),window.removeEventListener("keydown",e),window.removeEventListener("blur",D)}},[L.visible,z]);var M=L.visible,F=L.triggerEvent,V=L.propsFromTrigger,O=L.x,Q=L.y,B=L.willLeave,H=(0,i.default)("react-contexify",f,((c={})["react-contexify__theme--"+p]=p,c),N?v(N)?(0,i.default)(((s={})["react-contexify__will-enter--"+N]=N&&M&&!B,s["react-contexify__will-leave--"+N+" react-contexify__will-leave--'disabled'"]=N&&M&&B,s)):"enter"in N&&"exit"in N?(0,i.default)(((r={})["react-contexify__will-enter--"+N.enter]=N.enter&&M&&!B,r["react-contexify__will-leave--"+N.exit+" react-contexify__will-leave--'disabled'"]=N.exit&&M&&B,r)):null:null),W=l({},x,{left:O,top:Q,opacity:1});return a.createElement(u,{refTracker:Z},M&&a.createElement("div",Object.assign({},C,{className:H,onAnimationEnd:function(){L.willLeave&&L.visible&&R({visible:!1,willLeave:!1})},style:W,ref:A,role:"menu"}),_(g,{propsFromTrigger:V,triggerEvent:F})))},w=function(e){var t,n=e.children,s=e.className,r=e.style,l=e.triggerEvent,c=e.data,u=e.propsFromTrigger,m=e.onClick,h=void 0===m?y:m,p=e.disabled,x=e.hidden,f=o(e,["children","className","style","triggerEvent","data","propsFromTrigger","onClick","disabled","hidden"]),g=d(),v={data:c,triggerEvent:l,props:u},_=j(void 0!==p&&p,v);if(j(void 0!==x&&x,v))return null;var b=(0,i.default)("react-contexify__item",s,((t={})["react-contexify__item--disabled"]=_,t));return a.createElement("div",Object.assign({},f,{className:b,style:r,onClick:function(e){v.event=e,_?e.stopPropagation():h(v)},onKeyDown:function(e){"Enter"===e.key&&(v.event=e,h(v))},ref:function(e){e&&!_&&g.set(e,{node:e,isSubmenu:!1})},tabIndex:-1,role:"menuitem","aria-disabled":_}),a.createElement("div",{className:"react-contexify__item__content"},n))};function S(){return a.createElement("div",{className:"react-contexify__separator"})}var k=function(e){var t,n=e.arrow,s=e.children,r=e.disabled,c=e.hidden,m=e.label,p=e.className,x=e.triggerEvent,f=e.propsFromTrigger,y=e.style,g=o(e,["arrow","children","disabled","hidden","label","className","triggerEvent","propsFromTrigger","style"]),v=d(),b=h(),N=(0,a.useRef)(null),w=(0,a.useState)({left:"100%",top:0,bottom:"initial"}),S=w[0],k=w[1],E={triggerEvent:x,props:f},C=j(void 0!==r&&r,E),T=j(void 0!==c&&c,E);if((0,a.useEffect)(function(){if(N.current){var e=window,t=e.innerWidth,n=e.innerHeight,s=N.current.getBoundingClientRect(),a={};s.right<t?(a.left="100%",a.right=void 0):(a.right="100%",a.left=void 0),s.bottom>n?(a.bottom=0,a.top="initial"):a.bottom="initial",k(a)}},[]),T)return null;var L=(0,i.default)("react-contexify__item",p,((t={})["react-contexify__item--disabled"]=C,t)),R=l({},y,S);return a.createElement(u,{refTracker:b},a.createElement("div",Object.assign({},g,{className:L,ref:function(e){e&&!C&&v.set(e,{node:e,isSubmenu:!0,submenuRefTracker:b})},tabIndex:-1,role:"menuitem","aria-haspopup":!0,"aria-disabled":C}),a.createElement("div",{className:"react-contexify__item__content",onClick:function(e){e.stopPropagation()}},m,a.createElement("span",{className:"react-contexify__submenu-arrow"},void 0===n?"▶":n)),a.createElement("div",{className:"react-contexify react-contexify__submenu",ref:N,style:R},_(s,{propsFromTrigger:f,triggerEvent:x}))))}},11908:function(e,t,n){"use strict";n.d(t,{ck:function(){return z},fC:function(){return Z},z$:function(){return I}});var s=n(83573),a=n(52983),i=n(12527),r=n(61031),l=n(95831),o=n(36986),c=n(80671),d=n(29650),u=n(72929),m=n(56807),h=n(87178),p=n(96501);let x="Radio",[f,y]=(0,l.b)(x),[g,v]=f(x),_=(0,a.forwardRef)((e,t)=>{let{__scopeRadio:n,name:l,checked:c=!1,required:d,disabled:u,value:m="on",onCheck:h,...p}=e,[x,f]=(0,a.useState)(null),y=(0,r.e)(t,e=>f(e)),v=(0,a.useRef)(!1),_=!x||!!x.closest("form");return(0,a.createElement)(g,{scope:n,checked:c,disabled:u},(0,a.createElement)(o.WV.button,(0,s.Z)({type:"button",role:"radio","aria-checked":c,"data-state":N(c),"data-disabled":u?"":void 0,disabled:u,value:m},p,{ref:y,onClick:(0,i.M)(e.onClick,e=>{c||null==h||h(),_&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})})),_&&(0,a.createElement)(b,{control:x,bubbles:!v.current,name:l,value:m,checked:c,required:d,disabled:u,style:{transform:"translateX(-100%)"}}))}),j=(0,a.forwardRef)((e,t)=>{let{__scopeRadio:n,forceMount:i,...r}=e,l=v("RadioIndicator",n);return(0,a.createElement)(p.z,{present:i||l.checked},(0,a.createElement)(o.WV.span,(0,s.Z)({"data-state":N(l.checked),"data-disabled":l.disabled?"":void 0},r,{ref:t})))}),b=e=>{let{control:t,checked:n,bubbles:i=!0,...r}=e,l=(0,a.useRef)(null),o=(0,h.D)(n),c=(0,m.t)(t);return(0,a.useEffect)(()=>{let e=l.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==n&&t){let s=new Event("click",{bubbles:i});t.call(e,n),e.dispatchEvent(s)}},[o,n,i]),(0,a.createElement)("input",(0,s.Z)({type:"radio","aria-hidden":!0,defaultChecked:n},r,{tabIndex:-1,ref:l,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function N(e){return e?"checked":"unchecked"}let w=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],S="RadioGroup",[k,E]=(0,l.b)(S,[c.Pc,y]),C=(0,c.Pc)(),T=y(),[L,R]=k(S),A=(0,a.forwardRef)((e,t)=>{let{__scopeRadioGroup:n,name:i,defaultValue:r,value:l,required:m=!1,disabled:h=!1,orientation:p,dir:x,loop:f=!0,onValueChange:y,...g}=e,v=C(n),_=(0,u.gm)(x),[j,b]=(0,d.T)({prop:l,defaultProp:r,onChange:y});return(0,a.createElement)(L,{scope:n,name:i,required:m,disabled:h,value:j,onValueChange:b},(0,a.createElement)(c.fC,(0,s.Z)({asChild:!0},v,{orientation:p,dir:_,loop:f}),(0,a.createElement)(o.WV.div,(0,s.Z)({role:"radiogroup","aria-required":m,"aria-orientation":p,"data-disabled":h?"":void 0,dir:_},g,{ref:t}))))}),q=(0,a.forwardRef)((e,t)=>{let{__scopeRadioGroup:n,disabled:l,...o}=e,d=R("RadioGroupItem",n),u=d.disabled||l,m=C(n),h=T(n),p=(0,a.useRef)(null),x=(0,r.e)(t,p),f=d.value===o.value,y=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{let e=e=>{w.includes(e.key)&&(y.current=!0)},t=()=>y.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,a.createElement)(c.ck,(0,s.Z)({asChild:!0},m,{focusable:!u,active:f}),(0,a.createElement)(_,(0,s.Z)({disabled:u,required:d.required,checked:f},h,o,{name:d.name,ref:x,onCheck:()=>d.onValueChange(o.value),onKeyDown:(0,i.M)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,i.M)(o.onFocus,()=>{var e;y.current&&(null===(e=p.current)||void 0===e||e.click())})})))}),P=(0,a.forwardRef)((e,t)=>{let{__scopeRadioGroup:n,...i}=e,r=T(n);return(0,a.createElement)(j,(0,s.Z)({},r,i,{ref:t}))}),Z=A,z=q,I=P}},function(e){e.O(0,[6665,7623,588,305,6402,1864,8703,1018,4975,4376,9621,3954,659,9911,3760,4637,8069,9344,9192,6739,4098,902,8985,3174,5538,997,4847,1379,272,2047,2728,6976,5767,9903,5210,9774,2888,179],function(){return e(e.s=57724)}),_N_E=e.O()}]);