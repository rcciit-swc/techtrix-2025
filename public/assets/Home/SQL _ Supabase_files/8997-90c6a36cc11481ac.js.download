!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="52fb2c92-bb78-4219-8bd4-c4cee5d1220f",e._sentryDebugIdIdentifier="sentry-dbid-52fb2c92-bb78-4219-8bd4-c4cee5d1220f")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8997,1061],{52417:function(e,t,n){n.d(t,{z:function(){return i}});var s=n(28894),a=n(6464),l=n(77878);async function r(e,t){let{projectRef:n,connectionString:s}=e;if(!n)throw Error("projectRef is required");let l=new Headers;s&&l.set("x-connection-encrypted",s);let{data:r,error:i}=await (0,a.U2)("/platform/pg-meta/{ref}/publications",{params:{header:{"x-connection-encrypted":s},path:{ref:n}},headers:l,signal:t});return i&&(0,a.S3)(i),r}let i=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(l.z.list(t),e=>{let{signal:s}=e;return r({projectRef:t,connectionString:n},s)},{enabled:a&&void 0!==t,...i})}},1575:function(e,t,n){n.d(t,{u:function(){return c}});var s=n(36457),a=n(64618),l=n(34549),r=n(6464),i=n(77878);async function o(e){let{projectRef:t,connectionString:n,id:s,tables:a,publish_insert:l,publish_update:i,publish_delete:o,publish_truncate:c}=e,d=new Headers;n&&d.set("x-connection-encrypted",n);let u={id:s};void 0!==a&&(u.tables=a),void 0!==l&&(u.publish_insert=l),void 0!==i&&(u.publish_update=i),void 0!==o&&(u.publish_delete=o),void 0!==c&&(u.publish_truncate=c);let{data:x,error:m}=await (0,r.r$)("/platform/pg-meta/{ref}/publications",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},body:u,headers:d});return m&&(0,r.S3)(m),x}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(i.z.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?l.Am.error("Failed to update database publication: ".concat(e.message)):t(e,n,s)},...n})}},77878:function(e,t,n){n.d(t,{z:function(){return s}});let s={list:e=>["projects",e,"database-publications"]}},323:function(e,t,n){n.d(t,{k:function(){return i}});var s=n(28894),a=n(6464),l=n(31118);async function r(e,t){let{projectRef:n,connectionString:s}=e;if(!n)throw Error("projectRef is required");let l=new Headers;s&&l.set("x-connection-encrypted",s);let{data:r,error:i}=await (0,a.U2)("/platform/pg-meta/{ref}/types",{params:{header:{"x-connection-encrypted":s},path:{ref:n}},headers:Object.fromEntries(l),signal:t});return i&&(0,a.S3)(i),r}let i=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(l.P.list(t),e=>{let{signal:s}=e;return r({projectRef:t,connectionString:n},s)},{enabled:a&&void 0!==t,...i})}},2115:function(e,t,n){n.d(t,{N:function(){return s}});let s={list:e=>["projects",e,"views"],listBySchema:(e,t)=>[...s.list(e),t]}},17319:function(e,t,n){n.d(t,{B:function(){return o}});var s=n(62213),a=n(52983),l=n(12436),r=n(37756);let i=e=>(0,s.v1)("schema",s.Oi.withDefault(e)),o=()=>{let{ref:e}=(0,l.UO)(),t=e&&e.length>0&&window.localStorage.getItem(r.dA.LAST_SELECTED_SCHEMA(e))||"public",[n,s]=i((0,a.useMemo)(()=>t,[e]));return(0,a.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.dA.LAST_SELECTED_SCHEMA(e),n)},[n,e]),{selectedSchema:n,setSelectedSchema:s}}},52090:function(e,t,n){var s=n(97458),a=n(52983),l=n(54135);let r=(0,a.memo)(function(){return(0,s.jsx)("div",{className:"px-4 flex flex-col gap-0",children:[{width:"w-40",opacity:"opacity-100"},{width:"w-32",opacity:"opacity-100"},{width:"w-20",opacity:"opacity-75"},{width:"w-40",opacity:"opacity-50"},{width:"w-20",opacity:"opacity-25"}].map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-row h-6 items-center gap-3 ".concat(e.opacity),children:[(0,s.jsx)(l.O,{className:"h-4 w-5"}),(0,s.jsx)(l.O,{className:"h-4 ".concat(e.width)})]},t))})});t.Z=r},63165:function(e,t,n){n.d(t,{Z:function(){return ev}});var s=n(97458),a=n(198),l=n(52983),r=n(61767),i=n(90817),o=n(86976),c=n(50663),d=n.n(c),u=n(36950),x=n(41957),m=n(32691),p=n(12436),h=n(41094),f=n(7676),b=n(52090),j=n(5529),v=n(359),y=n(92844),g=n(66902),N=n(58015),w=n(33940),S=n(83402),E=n(39113),k=n(92261),C=n(17319),_=n(96444),L=n(96226),T=n(10947),z=n(90839),A=n(42026),I=n(61893),Z=n(36155),R=n(52114),O=n(88971),P=n(12887),F=n.n(P),M=n(49296),B=n(57304),D=n(3977),W=n(58596),V=n(11024),X=n(29790),Q=n(74304),H=n(61379),q=n(83145),K=n.n(q),G=n(49571),Y=n.n(G),J=n(34549),U=n(6600),$=n(27850),ee=n(99359),et=n(70840),en=n(60025),es=n(97224),ea=n(3671),el=n(65092);let er=e=>{var t,n,a;let{type:l,size:r=15,strokeWidth:i=1.5,isActive:o}=e;return"sql"===l?(0,s.jsx)(ea.KK,{size:r,className:(0,el.cn)("transition-colors","fill-foreground-muted","group-aria-selected:fill-foreground","w-4 h-4","-ml-0.5"),strokeWidth:i}):l===w.l.TABLE?(0,s.jsx)(et.Z,{size:r,strokeWidth:i,className:(0,el.cn)("text-foreground-muted group-hover:text-foreground-lighter group-aria-selected:text-foreground",o&&"text-foreground-light","transition-colors")}):"schema"===l?(0,s.jsx)(en.Z,{size:r,strokeWidth:i}):l===w.l.VIEW?(0,s.jsx)(es.Z,{size:r,strokeWidth:i,className:(0,el.cn)("text-foreground-muted group-hover:text-foreground-lighter",o&&"text-foreground-lighter","transition-colors")}):(0,s.jsx)("div",{className:(0,el.cn)("flex items-center justify-center text-xs h-4 w-4 rounded-[2px] font-bold",l===w.l.FOREIGN_TABLE&&"text-yellow-900 bg-yellow-500",l===w.l.MATERIALIZED_VIEW&&"text-purple-1000 bg-purple-500",l===w.l.PARTITIONED_TABLE&&"text-foreground-light bg-border-stronger"),"data-sentry-component":"EntityTypeIcon","data-sentry-source-file":"EntityTypeIcon.tsx",children:null===(a=Object.entries(w.l).find(e=>{let[,t]=e;return t===l}))||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.toUpperCase()})};var ei=n(44353),eo=n(83462),ec=n(89199),ed=n(38650),eu=n(45536),ex=n(40577),em=n(14500);let ep=e=>{let{entity:t,isActive:n,tableHasLints:a,viewHasLints:l,materializedViewHasLints:r}=e,i="";switch(t.type){case w.l.TABLE:a&&(i="RLS disabled");break;case w.l.VIEW:l&&(i="Security definer view");break;case w.l.MATERIALIZED_VIEW:r&&(i="Security definer view");break;case w.l.FOREIGN_TABLE:i="RLS is not enforced on foreign tables"}return i?(0,s.jsxs)(ex.u,{disableHoverableContent:!0,children:[(0,s.jsx)(ex.aJ,{className:"min-w-4",children:(0,s.jsx)(H.Z,{size:14,strokeWidth:2,className:(0,el.cn)("min-w-4",n?"text-warning-600":"text-warning-500")})}),(0,s.jsx)(ex._v,{side:"bottom",children:(0,s.jsx)("span",{children:i})})]}):null};var eh=e=>{var t,n,a,l,r;let{id:i,projectRef:o,item:c,isLocked:d,isActive:u}=e,{project:x}=(0,O.d2)(),m=(0,L._2)(),{selectedSchema:h}=(0,C.B)(),f=Number(i)===c.id,b=f&&!d,{data:j=[]}=(0,ei.U)({projectRef:null==x?void 0:x.ref}),v=(0,ee.R)(c.name,"rls_disabled_in_public",["ERROR"],j,h).hasLint,y=(0,ee.R)(c.name,"security_definer_view",["ERROR","WARN"],j,h).hasLint,g=(0,ee.R)(c.name,"materialized_view_in_api",["ERROR","WARN"],j,h).hasLint,N=async()=>{if(p.Qy&&!(null==x?void 0:x.connectionString))return console.error("Connection string is required");let e=J.Am.loading("Exporting ".concat(c.name," as CSV..."));try{let t=await (0,E.IV)({id:c.id,projectRef:o,connectionString:null==x?void 0:x.connectionString});if((0,ec.N3)(t)&&t.live_rows_estimate>U.kI)return J.Am.error((0,s.jsx)("div",{className:"text-foreground prose text-sm",children:U.m0}),{id:e});let n=t&&(0,$.NK)(t);if(!n)return J.Am.error("Failed to export table: ".concat(c.name),{id:e});let a=(await (0,ed.wF)({projectRef:o,connectionString:null==x?void 0:x.connectionString,table:n})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(a.length>0){let e=Y().unparse(a,{columns:n.columns.map(e=>e.name)}),t=new Blob([e],{type:"text/csv;charset=utf-8;"});F()(t,"".concat(c.name,"_rows.csv"))}J.Am.success("Successfully exported ".concat(c.name," as CSV"),{id:e})}catch(t){J.Am.error("Failed to export table: ".concat(t.message),{id:e})}},S=async()=>{if(p.Qy&&!(null==x?void 0:x.connectionString))return console.error("Connection string is required");let e=J.Am.loading("Exporting ".concat(c.name," as SQL..."));try{let t=await (0,E.IV)({id:c.id,projectRef:o,connectionString:null==x?void 0:x.connectionString});if((0,ec.N3)(t)&&t.live_rows_estimate>U.kI)return J.Am.error((0,s.jsx)("div",{className:"text-foreground prose text-sm",children:U.m0}),{id:e});let n=t&&(0,$.NK)(t);if(!n)return J.Am.error("Failed to export table: ".concat(c.name),{id:e});let a=(await (0,ed.wF)({projectRef:o,connectionString:null==x?void 0:x.connectionString,table:n})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(a.length>0){let e=(0,ee.k)(n,a),t=new Blob([e],{type:"text/sql;charset=utf-8;"});F()(t,"".concat(c.name,"_rows.sql"))}J.Am.success("Successfully exported ".concat(c.name," as SQL"),{id:e})}catch(t){J.Am.error("Failed to export table: ".concat(t.message),{id:e})}};return(0,s.jsx)(eo.Sf,{title:c.name,id:String(c.id),href:"/project/".concat(o,"/editor/").concat(c.id,"?schema=").concat(h),role:"button","aria-label":"View ".concat(c.name),className:(0,el.cn)((0,ea.RK)({isSelected:f}),"px-4"),"data-sentry-element":"EditorTablePageLink","data-sentry-component":"EntityListItem","data-sentry-source-file":"EntityListItem.tsx",children:(0,s.jsxs)(s.Fragment,{children:[f&&(0,s.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),(0,s.jsxs)(ex.u,{disableHoverableContent:!0,"data-sentry-element":"Tooltip","data-sentry-source-file":"EntityListItem.tsx",children:[(0,s.jsx)(ex.aJ,{className:"min-w-4","data-sentry-element":"TooltipTrigger","data-sentry-source-file":"EntityListItem.tsx",children:(0,s.jsx)(er,{type:c.type,isActive:f,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"EntityListItem.tsx"})}),(0,s.jsx)(ex._v,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"EntityListItem.tsx",children:(t=c.type,null===(r=Object.entries(w.l).find(e=>{let[,n]=e;return n===t}))||void 0===r?void 0:null===(l=r[0])||void 0===l?void 0:null===(a=l.toLowerCase())||void 0===a?void 0:null===(n=a.split("_"))||void 0===n?void 0:n.join(" "))})]}),(0,s.jsxs)("div",{className:(0,el.cn)("truncate","overflow-hidden text-ellipsis whitespace-nowrap flex items-center gap-2 relative w-full",f&&"text-foreground"),children:[(0,s.jsx)("span",{className:(0,el.cn)(f?"text-foreground":"text-foreground-light group-hover:text-foreground","text-sm","transition","truncate"),children:c.name}),(0,s.jsx)(ep,{entity:c,isActive:f,tableHasLints:v,viewHasLints:y,materializedViewHasLints:g,"data-sentry-element":"EntityTooltipTrigger","data-sentry-source-file":"EntityListItem.tsx"})]}),b&&(0,s.jsxs)(em.h_,{children:[(0,s.jsx)(em.$F,{className:"text-foreground-lighter transition-all text-transparent group-hover:text-foreground data-[state=open]:text-foreground",children:(0,s.jsx)(M.Z,{size:14,strokeWidth:2})}),(0,s.jsxs)(em.AW,{side:"bottom",align:"start",className:"w-44",children:[(0,s.jsxs)(em.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),(0,eu.vQ)(c.name)},children:[(0,s.jsx)(B.Z,{size:12}),(0,s.jsx)("span",{children:"Copy name"})]},"copy-name"),c.type===w.l.TABLE&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(em.VD,{}),(0,s.jsxs)(em.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),m.onEditTable()},children:[(0,s.jsx)(D.Z,{size:12}),(0,s.jsx)("span",{children:"Edit table"})]},"edit-table"),(0,s.jsxs)(em.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),m.onDuplicateTable()},children:[(0,s.jsx)(W.Z,{size:12}),(0,s.jsx)("span",{children:"Duplicate table"})]},"duplicate-table"),(0,s.jsx)(em.Xi,{className:"space-x-2",asChild:!0,children:(0,s.jsxs)(K(),{href:"/project/".concat(o,"/auth/policies?schema=").concat(h,"&search=").concat(c.id),children:[(0,s.jsx)(V.Z,{size:12}),(0,s.jsx)("span",{children:"View policies"})]},"view-policies")},"view-policies"),(0,s.jsxs)(em.Ph,{children:[(0,s.jsxs)(em.kt,{className:"gap-x-2",children:[(0,s.jsx)(X.Z,{size:12}),"Export data"]}),(0,s.jsxs)(em.TG,{children:[(0,s.jsx)(em.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),N()},children:(0,s.jsx)("span",{children:"Export table as CSV"})},"download-table-csv"),(0,s.jsx)(em.Xi,{className:"gap-x-2",onClick:e=>{e.stopPropagation(),S()},children:(0,s.jsx)("span",{children:"Export table as SQL"})},"download-table-sql")]})]}),(0,s.jsx)(em.VD,{}),(0,s.jsxs)(em.Xi,{className:"gap-x-2",onClick:e=>{e.stopPropagation(),m.onDeleteTable()},children:[(0,s.jsx)(Q.Z,{size:12}),(0,s.jsx)("span",{children:"Delete table"})]},"delete-table")]})]})]})]})})},ef=n(39057);let eb=()=>(0,s.jsx)(R.Cf,{title:"No tables or views",description:"Any tables or views you create will be listed here.",className:"mx-4","data-sentry-element":"InnerSideBarEmptyPanel","data-sentry-component":"TableMenuEmptyState","data-sentry-source-file":"TableMenuEmptyState.tsx",children:(0,s.jsx)("div",{className:"top-0 left-6 flex flex-col opacity-50 cursor-not-allowed bg-dash-sidebar h-content -mb-7 pointer-events-none scale-75",children:(0,s.jsxs)("div",{className:"relative h-content",children:[(0,s.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-10",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-transparent from-80% to-100% to-background-surface-100 dark:to-background-surface-75"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent from-50% to-100% to-background-surface-100 dark:to-background-surface-75"})]}),(0,s.jsx)("div",{className:"absolute left-[150px] bottom-[21px] text-foreground-muted z-10 pointer-events-none",children:(0,s.jsx)(ef.Z,{size:16,className:"text-foreground-light",strokeWidth:1.5,"data-sentry-element":"Pointer","data-sentry-source-file":"TableMenuEmptyState.tsx"})}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"border-l pointer-events-none",children:(0,s.jsxs)("div",{className:(0,el.cn)("group",(0,ea.RK)({isSelected:2===t,isOpened:2===t,isPreview:!1}),"px-4 min-w-40"),"aria-selected":2===t,children:[2===t&&(0,s.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),(0,s.jsx)(er,{type:"r"}),"postgres_table_".concat(t)]})},"some-".concat(t)))]})})});var ej=()=>{var e,t,n;let{id:r}=(0,p.UO)(),o=(0,m.useRouter)(),c=r?Number(r):void 0,P=(0,L._2)(),{selectedSchema:F,setSelectedSchema:M}=(0,C.B)(),B=(0,h.G)(),[D,W]=(0,l.useState)(!1),[V,X]=(0,l.useState)(""),[Q,H]=(0,l.useState)(Object.values(w.l)),[q,K]=(0,k._)("table-editor-sort","alphabetical"),{project:G}=(0,O.d2)(),{data:Y,isLoading:J,isSuccess:U,isError:$,error:ee,hasNextPage:et,isFetchingNextPage:en,fetchNextPage:es}=(0,S.Hp)({projectRef:null==G?void 0:G.ref,connectionString:null==G?void 0:G.connectionString,schemas:[F],search:V.trim()||void 0,sort:q,filterTypes:Q},{keepPreviousData:!!V}),ea=(0,l.useMemo)(()=>null==Y?void 0:Y.pages.flatMap(e=>e.data.entities),[null==Y?void 0:Y.pages]),{data:el}=(0,N.Q1)({projectRef:null==G?void 0:G.ref,connectionString:null==G?void 0:G.connectionString}),er=null==el?void 0:el.find(e=>e.name===F),ei=(0,i.Xo)(a.KA.TENANT_SQL_ADMIN_WRITE,"tables"),[eo]=d()((null!=el?el:[]).sort((e,t)=>e.name.localeCompare(t.name)),e=>{var t;return _.s.includes(null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"")}),ec=eo.some(e=>e.id===(null==er?void 0:er.id)),{data:ed}=(0,E.iB)({projectRef:null==G?void 0:G.ref,connectionString:null==G?void 0:G.connectionString,id:c});return(0,l.useEffect)(()=>{(null==ed?void 0:ed.schema)&&M(ed.schema)},[null==ed?void 0:ed.schema]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col flex-grow gap-5 pt-5 h-full",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-1.5",children:[(0,s.jsx)(g.Z,{className:"mx-4",selectedSchemaName:F,onSelectSchema:e=>{X(""),M(e),o.push("/project/".concat(null==G?void 0:G.ref,"/editor?schema=").concat(e))},onSelectCreateSchema:()=>P.onAddSchema(),"data-sentry-element":"SchemaSelector","data-sentry-source-file":"TableEditorMenu.tsx"}),(0,s.jsx)("div",{className:"grid gap-3 mx-4",children:ec?(0,s.jsxs)(T.bZ,{children:[(0,s.jsx)(T.Cd,{className:"text-sm",children:"Viewing protected schema"}),(0,s.jsxs)(T.X,{className:"text-xs",children:[(0,s.jsx)("p",{className:"mb-2",children:"This schema is managed by Supabase and is read-only through the table editor"}),(0,s.jsx)(z.z,{type:"default",size:"tiny",onClick:()=>W(!0),children:"Learn more"})]})]}):(0,s.jsx)(v.u,{block:!0,title:"Create a new table",name:"New table",disabled:!ei,size:"tiny",icon:(0,s.jsx)(u.Z,{size:14,strokeWidth:1.5,className:"text-foreground-muted"}),type:"default",className:"justify-start",onClick:P.onAddTable,tooltip:{content:{side:"bottom",text:ei?void 0:"You need additional permissions to create tables"}},children:"New table"})})]}),(0,s.jsxs)("div",{className:"flex flex-auto flex-col gap-2 pb-4",children:[(0,s.jsxs)(R.nM,{className:"mx-2","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,s.jsx)(R.nn,{autoFocus:!B,name:"search-tables","aria-labelledby":"Search tables",onChange:e=>{X(e.target.value)},value:V,placeholder:"Search tables...","data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,s.jsxs)(R.ZY,{value:q,onValueChange:e=>K(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,s.jsx)(R.IR,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"TableEditorMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,s.jsx)(R.IR,{value:"grouped-alphabetical","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"TableEditorMenu.tsx",children:"Entity Type"},"grouped-alphabetical")]})}),(0,s.jsxs)(A.J2,{"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,s.jsx)(A.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,s.jsx)(z.z,{type:5!==Q.length?"default":"dashed",className:"h-[32px] md:h-[28px] px-1.5",icon:(0,s.jsx)(x.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"TableEditorMenu.tsx"})}),(0,s.jsx)(A.yk,{className:"p-0 w-56",side:"bottom",align:"center","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,s.jsxs)("div",{className:"px-3 pt-3 pb-2 flex flex-col gap-y-2",children:[(0,s.jsx)("p",{className:"text-xs",children:"Show entity types"}),(0,s.jsx)("div",{className:"flex flex-col",children:Object.entries(w.l).map(e=>{let[t,n]=e;return(0,s.jsxs)("div",{className:"group flex items-center justify-between py-0.5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(I.X,{id:t,name:t,checked:Q.includes(n),onCheckedChange:()=>{Q.includes(n)?H(Q.filter(e=>e!==n)):H(Q.concat([n]))}}),(0,s.jsx)(Z._,{htmlFor:t,className:"capitalize text-xs",children:t.toLowerCase().replace("_"," ")})]}),(0,s.jsx)(z.z,{size:"tiny",type:"default",onClick:()=>H([n]),className:"transition opacity-0 group-hover:opacity-100 h-auto px-1 py-0.5",children:"Select only"})]},t)})})]})})]})]}),J&&(0,s.jsx)(b.Z,{}),$&&(0,s.jsx)("div",{className:"mx-4",children:(0,s.jsx)(j.Z,{error:null!=ee?ee:null,subject:"Failed to retrieve tables"})}),U&&(0,s.jsxs)(s.Fragment,{children:[0===V.length&&(null!==(e=null==ea?void 0:ea.length)&&void 0!==e?e:0)<=0&&(0,s.jsx)(eb,{}),V.length>0&&(null!==(t=null==ea?void 0:ea.length)&&void 0!==t?t:0)<=0&&(0,s.jsx)(R.Cf,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(V,'" did not return any results')}),(null!==(n=null==ea?void 0:ea.length)&&void 0!==n?n:0)>0&&(0,s.jsx)("div",{className:"flex flex-1 flex-grow","data-testid":"tables-list",children:(0,s.jsx)(y.Z,{items:ea,ItemComponent:eh,itemProps:{projectRef:null==G?void 0:G.ref,id:Number(c),isLocked:ec},getItemSize:()=>28,hasNextPage:et,isLoadingNextPage:en,onLoadNextPage:()=>es()})})]})]})]}),(0,s.jsx)(f.b,{visible:D,onClose:()=>W(!1),"data-sentry-element":"ProtectedSchemaModal","data-sentry-source-file":"TableEditorMenu.tsx"})]})},ev=e=>{let{children:t}=e,n=(0,i.N4)(),c=(0,i.Xo)(a.KA.TENANT_SQL_ADMIN_READ,"tables"),d=(0,l.useMemo)(()=>(0,s.jsx)(ej,{}),[]);return n&&!c?(0,s.jsx)(o.$,{isBlocking:!1,children:(0,s.jsx)(r.Z,{isFullPage:!0,resourceText:"view tables from this project"})}):(0,s.jsx)(o.$,{product:"Table Editor",productMenu:d,isBlocking:!1,resizableSidebar:!0,"data-sentry-element":"ProjectLayoutWithAuth","data-sentry-component":"TableEditorLayout","data-sentry-source-file":"TableEditorLayout.tsx",children:t})}},61767:function(e,t,n){var s=n(97458),a=n(44735);t.Z=e=>{let{resourceText:t,isFullPage:n=!1}=e,l=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(a.Z,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return n?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(l,{})})}):(0,s.jsx)(l,{})}},66902:function(e,t,n){var s=n(97458),a=n(198),l=n(50416),r=n(62507),i=n(36950),o=n(52983),c=n(88971),d=n(58015),u=n(90817),x=n(90839),m=n(54135),p=n(10947),h=n(42026),f=n(47482),b=n(64890);t.Z=e=>{let{className:t,disabled:n=!1,size:j="tiny",showError:v=!0,selectedSchemaName:y,supportSelectAll:g=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:S}=e,[E,k]=(0,o.useState)(!1),C=(0,u.Xo)(a.KA.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:_}=(0,c.d2)(),{data:L,isLoading:T,isSuccess:z,isError:A,error:I,refetch:Z}=(0,d.Q1)({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString}),R=(L||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[T&&(0,s.jsx)(x.z,{type:"default",className:"w-full [&>span]:w-full",size:j,disabled:!0,children:(0,s.jsx)(m.O,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),v&&A&&(0,s.jsxs)(p.bZ,{variant:"warning",className:"!px-3 !py-3",children:[(0,s.jsx)(p.Cd,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,s.jsxs)(p.X,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,s.jsx)(x.z,{type:"default",size:"tiny",onClick:()=>Z(),children:"Reload schemas"})]}),z&&(0,s.jsxs)(h.J2,{open:E,onOpenChange:k,modal:!1,children:[(0,s.jsx)(h.xo,{asChild:!0,children:(0,s.jsx)(x.z,{size:j,disabled:n,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,s.jsx)(l.Z,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:y?(0,s.jsxs)("div",{className:"w-full flex gap-1",children:[(0,s.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,s.jsx)("p",{className:"text-foreground",children:"*"===y?"All schemas":y})]}):(0,s.jsx)("div",{className:"w-full flex gap-1",children:(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,s.jsx)(h.yk,{className:"p-0 min-w-[200px]",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,s.jsxs)(f.mY,{children:[(0,s.jsx)(f.sZ,{placeholder:"Find schema..."}),(0,s.jsxs)(f.e8,{children:[(0,s.jsx)(f.rb,{children:"No schemas found"}),(0,s.jsx)(f.fu,{children:(0,s.jsxs)(b.x,{className:(R||[]).length>7?"h-[210px]":"",children:[g&&(0,s.jsxs)(f.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),k(!1)},onClick:()=>{w("*"),k(!1)},children:[(0,s.jsx)("span",{children:"All schemas"}),"*"===y&&(0,s.jsx)(r.Z,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==R?void 0:R.map(e=>(0,s.jsxs)(f.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),k(!1)},onClick:()=>{w(e.name),k(!1)},children:[(0,s.jsx)("span",{children:e.name}),y===e.name&&(0,s.jsx)(r.Z,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==S&&C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.zz,{}),(0,s.jsx)(f.fu,{children:(0,s.jsxs)(f.di,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{S(),k(!1)},onClick:()=>{S(),k(!1)},children:[(0,s.jsx)(i.Z,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},23078:function(e,t,n){var s=n(97458),a=n(65092);t.Z=e=>{let{max:t=100,value:n=0,barClass:l="bg-foreground",bgClass:r="",type:i="vertical",borderClass:o="",labelBottom:c="",labelBottomClass:d="tabular-nums",labelTop:u="",labelTopClass:x=""}=e;if("horizontal"===i){let e=Number(n/t*100),i=c||u;return(0,s.jsxs)("div",{className:"flex flex-col w-full",children:[i&&(0,s.jsxs)("div",{className:"flex align-baseline justify-between pb-1 space-x-8",children:[(0,s.jsx)("p",{className:(0,a.cn)("text-foreground text-sm truncate capitalize-sentence",u.length>0&&"max-w-[75%]",d),children:c}),(0,s.jsx)("p",{className:(0,a.cn)("text-foreground-light text-sm",x),children:u})]}),(0,s.jsx)("div",{className:"relative rounded h-1 overflow-hidden w-full border p-0 ".concat(r||"bg-surface-400"," ").concat(o||"border-none"),children:(0,s.jsx)("div",{className:"absolute rounded inset-x-0 bottom-0 h-1 ".concat(l," transition-all"),style:{width:"".concat(e,"%")}})})]})}{let e=Number(n/t*35);return e<2&&(e=2),(0,s.jsx)("div",{className:"relative rounded w-5 overflow-hidden border p-1 ".concat(r||"bg-gray-400"," ").concat(o||"border-none"),style:{height:35},children:(0,s.jsx)("div",{className:"absolute inset-x-0 bottom-0 w-5 ".concat(l),style:{height:e}})})}}},10046:function(e,t,n){n.d(t,{Z:function(){return d}});var s=n(97458),a=n(52983),l=n(68249),r=n(25843),i=n(11499);let o=(0,a.createContext)({parentCallback:e=>{},parentSize:""});function c(e){let{className:t,id:n="",name:a="",label:l,afterLabel:c,beforeLabel:d,description:u,checked:x,value:m,onChange:p,onBlur:h,size:f="medium",disabled:b=!1,...j}=e,{formContextOnChange:v,values:y,handleBlur:g}=(0,i.G)(),N=(0,r.Z)("checkbox");return(0,s.jsx)(o.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"Checkbox","data-sentry-source-file":"Checkbox.tsx",children:e=>{let{parentCallback:r,parentSize:i}=e,o=n||a||(l?l.toLowerCase().replace(/^[^A-Z0-9]+/gi,"").replace(/ /g,"-"):void 0);f=i||f;let w=a||o,S=null!=x?x:void 0,E=[N.container];return t&&E.push(t),y&&void 0===x&&(S=y[n||a]),(0,s.jsxs)("div",{className:E.join(" "),children:[(0,s.jsx)("input",{id:o,name:w,type:"checkbox",className:[N.base,N.size[f]].join(" "),onChange:function(e){r&&r(e),p&&p(e),v&&v(e)},onBlur:function(e){g&&setTimeout(()=>{g(e)},100),h&&h(e)},checked:S,value:m||o,disabled:b,...j}),(0,s.jsxs)("label",{className:[N.label.base,N.label[f]].join(" "),htmlFor:o,children:[(0,s.jsxs)("span",{children:[d&&(0,s.jsx)("span",{className:[N.label_before.base,N.label_before[f]].join(" "),children:d}),l,c&&(0,s.jsx)("span",{className:[N.label_after.base,N.label_after[f]].join(" "),children:c})]}),u&&(0,s.jsx)("p",{className:[N.description.base,N.description[f]].join(" "),children:u})]})]})}})}c.Group=function(e){let{id:t,layout:n="vertical",error:a,descriptionText:i,label:d,afterLabel:u,beforeLabel:x,labelOptional:m,children:p,className:h,options:f,onChange:b,size:j="medium"}=e,v=(0,r.Z)("checkbox");return(0,s.jsx)(l.l,{label:d,afterLabel:u,beforeLabel:x,labelOptional:m,layout:n,id:t,error:a,descriptionText:i,className:h,size:j,"data-sentry-element":"FormLayout","data-sentry-component":"Group","data-sentry-source-file":"Checkbox.tsx",children:(0,s.jsx)(o.Provider,{value:{parentCallback:e=>{b&&b(e)},parentSize:j},"data-sentry-element":"unknown","data-sentry-source-file":"Checkbox.tsx",children:(0,s.jsx)("div",{className:v.group,children:f?f.map(e=>(0,s.jsx)(c,{id:e.id,value:e.value,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,checked:e.checked,name:e.name,description:e.description,defaultChecked:e.defaultChecked},e.id)):p})})})};var d=c},9450:function(e,t,n){var s=n(97458),a=n(99517);n(52983);var l=n(25843);let r=e=>{let{open:t,children:n,className:l,...r}=e;return(0,s.jsx)(a.fC,{asChild:r.asChild,defaultOpen:r.defaultOpen,open:t,onOpenChange:r.onOpenChange,disabled:r.disabled,className:l,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:n})};r.Trigger=function(e){let{children:t,asChild:n}=e;return(0,s.jsx)(a.xz,{asChild:n,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},r.Content=function(e){let{asChild:t,children:n,className:r}=e,i=(0,l.Z)("collapsible");return(0,s.jsx)(a.VY,{asChild:t,className:[i.content,r].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:n})},t.ZP=r},85818:function(e,t,n){n.d(t,{Z:function(){return b}});var s=n(97458),a=n(44809),l=n(62923),r=n.n(l),i=n(52983),o=n(68249),c=n(51487),d=n(16720),u=n(25843),x=n(65092),m=n(11499);let p=(0,i.createContext)({onChange:e=>{},selected:void 0});var h=n(62507);function f(e){let{children:t,className:n,buttonClassName:l,descriptionText:h,error:f,icon:b,id:j="",name:v="",label:y,labelOptional:g,layout:N,value:w,onChange:S,onFocus:E,onBlur:k,style:C,size:_="medium",defaultValue:L,validation:T,disabled:z,optionsWidth:A}=e,[I,Z]=(0,i.useState)(void 0),[R,O]=(0,i.useState)({}),P=(0,u.Z)("listbox"),F=(0,i.useRef)(null),{formContextOnChange:M,values:B,errors:D,handleBlur:W,touched:V,fieldLevelValidation:X}=(0,m.G)();B&&!w&&(w=B[j||v],L=B[j||v]),f||(D&&!f&&(f=D[j||v]),f=V&&V[j||v]?f:void 0),(0,i.useEffect)(()=>{void 0!==w&&Z(w)},[w]),(0,i.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(A||(null===(e=F.current)||void 0===e?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{var e;let n=r()(t);function s(e){return n.find(t=>t.props.value===e)}if(w){Z(w);let e=s(w);O((null==e?void 0:e.props)?e.props:void 0);return}if(I){let e=s(I);O((null==e?void 0:e.props)?e.props:void 0);return}if(L){Z(L);let e=s(I);O((null==e?void 0:e.props)?e.props:void 0);return}O(null===(e=n[0])||void 0===e?void 0:e.props)},[I]);let Q=[P.container,P.base,l],H=[P.addOnBefore];return f&&Q.push(P.variants.error),f||Q.push(P.variants.standard),b&&H.push(P.with_icon),_&&Q.push(P.size[_]),z&&Q.push(P.disabled),(0,s.jsx)(o.l,{label:y,labelOptional:g,layout:N,id:j,error:f,descriptionText:h,className:n,style:C,size:_,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsxs)(a.fC,{"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:[(0,s.jsx)(a.xz,{asChild:!0,disabled:z,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsxs)("button",{"data-size":_,ref:F,className:(0,x.cn)(Q),onBlur:function(e){W&&W(e),k&&k(e)},onFocus:E,name:v,id:j,children:[(0,s.jsxs)("span",{className:(0,x.cn)(H),children:[b&&(0,s.jsx)(d.Z,{size:_,icon:b}),(null==R?void 0:R.addOnBefore)&&(0,s.jsx)(R.addOnBefore,{}),(0,s.jsx)("span",{className:P.label,children:null==R?void 0:R.label})]}),(0,s.jsx)("span",{className:P.chevron_container,children:(0,s.jsx)("svg",{className:P.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,s.jsx)("div",{className:P.actions_container,children:f&&(0,s.jsx)(c.Z,{size:_})})]})}),(0,s.jsx)(a.VY,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:P.options_container,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsx)("div",{children:(0,s.jsx)(p.Provider,{value:{onChange:function(e){S&&S(e),Z(e);let t={};t.target={type:"select",name:v,id:j,value:e,checked:void 0},M&&M(t),T&&X(j,T(e))},selected:I},"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:n,label:l,disabled:r=!1,children:i,className:o="",addOnBefore:c}=e,d=(0,u.Z)("listbox");return(0,s.jsx)(p.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:l,selected:u}=e,m=u===n;return(0,s.jsxs)(a.ck,{className:(0,x.cn)(d.option,m?d.option_active:" ",r?d.option_disabled:" ",o),onSelect:()=>r?{}:l(n),children:[(0,s.jsxs)("div",{className:d.option_inner,children:[c&&c({active:m,selected:u}),(0,s.jsx)("span",{children:"function"==typeof i?i({active:m,selected:u}):i})]}),m?(0,s.jsx)("span",{className:(0,x.cn)(d.option_check,m?d.option_check_active:""),children:(0,s.jsx)(h.Z,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};var b=f}}]);