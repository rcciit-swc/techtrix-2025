!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c465b739-c291-4ebc-9447-a13933860df8",e._sentryDebugIdIdentifier="sentry-dbid-c465b739-c291-4ebc-9447-a13933860df8")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5294],{29456:function(e,t,n){n.d(t,{z:function(){return d}});var a=n(36457),s=n(64618),r=n(34549),i=n(6464),l=n(84437);async function o(e,t){let{projectRef:n,ids:a}=e,{data:s,error:r}=await (0,i.IV)("/platform/projects/{ref}/content",{headers:{Version:"2"},params:{path:{ref:n},query:{ids:a}},signal:t});return r&&(0,i.S3)(r),s.map(e=>e.id)}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.NL)();return(0,s.D)(e=>o(e),{async onSuccess(t,n,a){let{projectRef:s}=n;await i.invalidateQueries(l.$.allContentLists(s)),await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?r.Am.error("Failed to delete contents: ".concat(e.message)):t(e,n,a)},...n})}},71484:function(e,t,n){n.d(t,{A:function(){return i},N:function(){return l}});var a=n(28894),s=n(6464),r=n(84437);async function i(e,t){let{projectRef:n,id:a}=e;if(void 0===n)throw Error("projectRef is required");if(void 0===a)throw Error("Content ID is required");let{data:r,error:i}=await (0,s.U2)("/platform/projects/{ref}/content/item/{id}",{params:{path:{ref:n,id:a}},signal:t});if(i)throw(0,s.S3)(i);return r}let l=function(e){let{projectRef:t,id:n}=e,{enabled:s=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.a)(r.$.resource(t,n),e=>{let{signal:a}=e;return i({projectRef:t,id:n},a)},{enabled:s&&void 0!==t&&void 0!==n,...l})}},62099:function(e,t,n){n.d(t,{KJ:function(){return i},md:function(){return o}});var a=n(90688),s=n(6464),r=n(84437);let i=100;async function l(e,t){let{projectRef:n,cursor:a,sort:r,name:l}=e;if(void 0===n)throw Error("projectRef is required");let{data:o,error:d}=await (0,s.U2)("/platform/projects/{ref}/content/folders",{params:{path:{ref:n},query:{type:"sql",cursor:a,limit:i.toString(),sort_by:r,sort_order:"name"===r?"asc":"desc",name:l,visibility:"user"}},signal:t});return d&&(0,s.S3)(d),{...o.data,cursor:o.cursor}}let o=function(e){let{projectRef:t,name:n,sort:s}=e,{enabled:i=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.N)(r.$.folders(t,{name:n,sort:s}),e=>{let{signal:a,pageParam:r}=e;return l({projectRef:t,cursor:r,name:n,sort:s},a)},{enabled:i&&void 0!==t,getNextPageParam:e=>e.cursor,...o})}},81277:function(e,t,n){n.d(t,{v:function(){return o}});var a=n(90688),s=n(6464),r=n(84437),i=n(62099);async function l(e,t){let{projectRef:n,cursor:a,visibility:r,favorite:l,name:o,sort:d}=e;if(void 0===n)throw Error("projectRef is required for getSqlSnippets");let{data:c,error:u}=await (0,s.U2)("/platform/projects/{ref}/content",{params:{path:{ref:n},query:{type:"sql",cursor:a,visibility:r,favorite:l,name:o,limit:i.KJ.toString(),sort_by:d,sort_order:"name"===d?"asc":"desc"}},signal:t});if(u)throw u;return{cursor:c.cursor,contents:c.data}}let o=function(e){let{projectRef:t,sort:n,name:s,visibility:i,favorite:o}=e,{enabled:d=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.N)(r.$.sqlSnippets(t,{sort:n,name:s,visibility:i,favorite:o}),e=>{let{signal:a,pageParam:r}=e;return l({projectRef:t,cursor:r,sort:n,name:s,visibility:i,favorite:o},a)},{enabled:d&&void 0!==t,getNextPageParam:e=>e.cursor,...c})}},5294:function(e,t,n){n.d(t,{Z:function(){return tv}});var a=n(97458),s=n(28977),r=n.n(s),i=n(5211),l=n(68769),o=n(52983),d=n(34549),c=n(5529),u=n(2343),p=n(36457),m=n(64618),f=n(25878),x=n(52791);async function h(e){let{pid:t,projectRef:n,connectionString:a}=e,{result:s}=await (0,f.R)({projectRef:n,connectionString:a,sql:"select pg_terminate_backend(".concat(t,")")});return s}let y=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,p.NL)();return(0,m.D)(e=>h(e),{async onSuccess(t,n,s){let{projectRef:r}=n;await a.invalidateQueries(x.M.ongoingQueries(r)),await (null==e?void 0:e(t,n,s))},async onError(e,n,a){void 0===t?d.Am.error("Failed to abort query: ".concat(e.message)):t(e,n,a)},...n})};var v=n(28894);let g=()=>"\nselect pid, query, query_start from pg_stat_activity where state = 'active' and datname = 'postgres';\n".trim();async function j(e,t){let{projectRef:n,connectionString:a}=e,s=g().trim(),{result:r}=await (0,f.R)({projectRef:n,connectionString:a,sql:s,queryKey:["ongoing-queries"]},t);return(null!=r?r:[]).filter(e=>!e.query.startsWith(s))}let S=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(x.M.ongoingQueries(t),e=>{let{signal:a}=e;return j({projectRef:t,connectionString:n},a)},{enabled:a&&void 0!==t,...s})};var b=n(62432),w=n(53114),N=n(37756),C=n(619),M=n(72271),L=n(90839),q=n(49935),Q=n(65092),E=n(40577),_=n(32002),P=n(86186),Z=n(12436);let k=()=>{let[e,t]=(0,w.x)({replace:!0}),{viewOngoingQueries:n}=(0,Z.UO)(),s=(0,b.Vm)(),p=(0,C.TF)(),m=(0,P.WZ)(),[f,x]=(0,o.useState)(),{data:h}=(0,u.bN)({projectRef:null==s?void 0:s.ref}),v=(null!=h?h:[]).find(e=>e.identifier===p.selectedDatabaseId),{data:g,error:j,isError:k,isLoading:D,isFetching:I,refetch:F}=S({projectRef:null==s?void 0:s.ref,connectionString:null==v?void 0:v.connectionString},{enabled:!N.Qy||N.Qy&&(null==v?void 0:v.connectionString)!==void 0,staleTime:5e3}),O=null!=g?g:[];(0,o.useEffect)(()=>{n&&(m.setOnGoingQueriesPanelOpen(!0),t({viewOngoingQueries:void 0}))},[n]);let{mutate:z,isLoading:A}=y({onSuccess:()=>{d.Am.success("Successfully aborted query (ID: ".concat(f,")")),x(void 0)}}),R=()=>{t({viewOngoingQueries:void 0}),m.setOnGoingQueriesPanelOpen(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(M.yo,{open:m.ongoingQueriesPanelOpen,onOpenChange:()=>R(),"data-sentry-element":"Sheet","data-sentry-source-file":"OngoingQueriesPanel.tsx",children:(0,a.jsxs)(M.ue,{size:"lg","data-sentry-element":"SheetContent","data-sentry-source-file":"OngoingQueriesPanel.tsx",children:[(0,a.jsxs)(M.Tu,{"data-sentry-element":"SheetHeader","data-sentry-source-file":"OngoingQueriesPanel.tsx",children:[(0,a.jsxs)(M.bC,{className:"flex items-center gap-x-2","data-sentry-element":"SheetTitle","data-sentry-source-file":"OngoingQueriesPanel.tsx",children:["Running queries on"," ",(null==v?void 0:v.identifier)===(null==s?void 0:s.ref)?"primary database":"read replica",(0,a.jsx)(L.z,{type:"default",className:"px-1.5",loading:D||I,icon:(0,a.jsx)(i.Z,{}),onClick:()=>F(),"data-sentry-element":"Button","data-sentry-source-file":"OngoingQueriesPanel.tsx"})]}),(0,a.jsxs)(M.Ei,{"data-sentry-element":"SheetDescription","data-sentry-source-file":"OngoingQueriesPanel.tsx",children:["There ",1===O.length?"is":"are"," ",(0,a.jsx)("span",{className:"text-foreground-light",children:O.length})," quer",1===O.length?"y":"ies"," currently running"," ",(null==v?void 0:v.identifier)!==(null==s?void 0:s.ref)?"on replica ".concat(null==v?void 0:v.identifier):""]})]}),(0,a.jsxs)("div",{className:"max-h-full h-full divide-y overflow-y-auto",children:[k&&(0,a.jsx)("div",{className:"flex items-center justify-center h-full px-16",children:(0,a.jsx)(c.Z,{subject:"Failed to retrieve ongoing queries",error:j})}),0===O.length&&(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 items-center justify-center h-full text-foreground-light text-sm",children:[(0,a.jsxs)("span",{children:["No queries are currently running on the"," ",(null==v?void 0:v.identifier)!==(null==s?void 0:s.ref)?"read replica ".concat(null==v?void 0:v.identifier):(null!=h?h:[]).length>1?"primary database":"database"]}),(0,a.jsx)(L.z,{type:"default",loading:D||I,icon:(0,a.jsx)(i.Z,{}),onClick:()=>F(),children:"Refresh"})]}),O.map(e=>(0,a.jsxs)(M.DN,{className:"flex justify-between gap-x-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 w-full",children:[(0,a.jsx)(q.d,{hideLineNumbers:!0,value:e.query,language:"sql",className:(0,Q.cn)("max-w-none max-h-52 w-full","!bg-transparent !py-3 !px-3.5 prose dark:prose-dark","[&>code]:m-0 [&>code>span]:flex [&>code>span]:flex-wrap")}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("p",{className:"text-foreground-light text-xs",children:["PID: ",e.pid]}),(0,a.jsx)("p",{className:"text-foreground-light text-xs",children:"â€¢"}),(0,a.jsxs)("p",{className:"text-foreground-light text-xs",children:["Started since: ",r()(e.query_start).format("DD MMM YYYY HH:mm (ZZ)")]})]})]}),(0,a.jsxs)(E.u,{children:[(0,a.jsx)(E.aJ,{asChild:!0,children:(0,a.jsx)(L.z,{type:"warning",className:"px-1.5",icon:(0,a.jsx)(l.Z,{}),onClick:()=>x(e.pid)})}),(0,a.jsx)(E._v,{side:"bottom",children:"Abort query"})]})]},e.pid))]})]})}),(0,a.jsx)(_.Z,{loading:A,variant:"warning",title:"Confirm to abort this query? (ID: ".concat(f,")"),visible:void 0!==f,onCancel:()=>x(void 0),onConfirm:()=>{void 0!==f&&z({pid:f,projectRef:null==s?void 0:s.ref,connectionString:null==v?void 0:v.connectionString})},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"OngoingQueriesPanel.tsx",children:(0,a.jsx)("p",{className:"text-sm",children:"This will force the query to stop running."})})]})};var D=n(58326),I=n(86976),F=n(198),O=n(23382),z=n(90817),A=n(92261),R=n(81514),T=n(98686),U=n(36950),B=n(22702),V=n(47697),G=n(32691),K=n(49825),W=n(14500),$=n(52114);let Y=["templates","quickstarts"];function J(){let{ref:e}=(0,Z.UO)(),t=(0,G.useRouter)();return(0,a.jsx)("div",{"data-sentry-component":"SqlEditorMenuStaticLinks","data-sentry-source-file":"SqlEditorMenuStaticLinks.tsx",children:Y.map(n=>{let s=t.asPath==="/project/".concat(e,"/sql/").concat(n);return(0,a.jsx)($.G,{title:"Templates",isActive:s,isOpened:!1,href:"/project/".concat(e,"/sql/").concat(n),className:"capitalize",children:n},n)})})}var X=n(52675),H=n(83145),ee=n.n(H),et=n(92844),en=n(6464),ea=n(84437);async function es(e,t){let{projectRef:n,cumulative:a,type:s,name:r}=e;if(void 0===n)throw Error("projectRef is required");let{data:i,error:l}=await (0,en.U2)("/platform/projects/{ref}/content/count",{params:{path:{ref:n},query:{...s&&{type:s},...r&&{name:r}}},...a?{}:{headers:{Version:"2"}},signal:t});if(l)throw(0,en.S3)(l);return i}let er=function(e){let{projectRef:t,cumulative:n,type:a,name:s}=e,{enabled:r=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(ea.$.count(t,a,{cumulative:n,name:s}),e=>{let{signal:r}=e;return es({projectRef:t,cumulative:n,type:a,name:s},r)},{enabled:r&&void 0!==t,...i})};var ei=n(90688);async function el(e,t){let{projectRef:n,type:a,name:s,limit:r=10,sort:i,cursor:l}=e;if(void 0===n)throw Error("projectRef is required for getContent");let{data:o,error:d}=await (0,en.U2)("/platform/projects/{ref}/content",{params:{path:{ref:n},query:{type:a,name:s,sort_by:i,limit:r.toString(),cursor:l}},signal:t});return d&&(0,en.S3)(d),{cursor:o.cursor,content:o.data}}let eo=function(e){let{projectRef:t,type:n,name:a,limit:s,sort:r}=e,{enabled:i=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ei.N)(ea.$.infiniteList(t,{type:n,name:a,limit:s,sort:r}),e=>{let{signal:i,pageParam:l}=e;return el({projectRef:t,type:n,name:a,limit:s,sort:r,cursor:l},i)},{enabled:i&&void 0!==t,getNextPageParam:e=>e.cursor,...l})};var ed=n(62099),ec=n(3671),eu=n(89129);let ep=e=>{var t;let{search:n}=e,{ref:s}=(0,Z.UO)(),{data:r,isLoading:i,hasNextPage:l,fetchNextPage:d,isFetchingNextPage:c}=eo({projectRef:s,type:"sql",limit:ed.KJ,name:0===n.length?void 0:n},{keepPreviousData:!0}),{data:u,isLoading:p}=er({projectRef:s,cumulative:!0,type:"sql",name:n},{keepPreviousData:!0}),m=null!==(t=null==u?void 0:u.count)&&void 0!==t?t:0,f=(0,o.useMemo)(()=>null==r?void 0:r.pages.flatMap(e=>e.content),[null==r?void 0:r.pages]);return(0,a.jsxs)("div",{className:"flex flex-col flex-grow","data-sentry-component":"SearchList","data-sentry-source-file":"SearchList.tsx",children:[i?(0,a.jsx)("div",{className:"px-4 py-1 pb-2.5",children:(0,a.jsx)(X.Z,{className:"animate-spin",size:14})}):u?(0,a.jsxs)("p",{className:"px-4 pb-2 text-sm text-foreground-lighter",children:[m," result",m>1?"s":""," found"]}):null,i?(0,a.jsxs)("div",{className:"px-4 flex flex-col gap-y-1",children:[(0,a.jsx)(eu.Z,{className:"py-2.5"}),(0,a.jsx)(eu.Z,{className:"py-2.5 w-5/6"}),(0,a.jsx)(eu.Z,{className:"py-2.5 w-3/4"})]}):(0,a.jsx)(et.Z,{items:f,ItemComponent:e=>(0,a.jsx)(em,{snippet:e.item}),itemProps:{},getItemSize:()=>28,hasNextPage:l,isLoadingNextPage:c,onLoadNextPage:()=>d()})]})},em=e=>{let{snippet:t}=e,{ref:n,id:s}=(0,Z.UO)(),r=t.id===s;return(0,a.jsxs)(ee(),{className:(0,Q.cn)("h-full flex items-center gap-x-3 pl-4 hover:bg-control transition",r&&"!bg-selection [&>svg]:fill-foreground [&>p]:text-foreground"),href:"/project/".concat(n,"/sql/").concat(t.id),"data-sentry-element":"Link","data-sentry-component":"SearchListItem","data-sentry-source-file":"SearchList.tsx",children:[(0,a.jsx)(ec.KK,{size:16,strokeWidth:1.5,className:"w-5 h-5 -ml-0.5 transition-colors fill-foreground-muted group-aria-selected:fill-foreground","data-sentry-element":"SQL_ICON","data-sentry-source-file":"SearchList.tsx"}),(0,a.jsx)("p",{className:"transition text-sm text-foreground-light truncate",children:t.name})]})};var ef=n(34216),ex=n(97224),eh=n(61379),ey=n(50963),ev=n(97687),eg=n.n(ev),ej=n(4839),eS=n(75308),eb=n(42155),ew=n(95526),eN=n(49996),eC=n(76689),eM=e=>{var t;let{id:n,...s}=e,r=null===(t=(0,K.B0)().snippets[n])||void 0===t?void 0:t.snippet,i=eg()(null==r?void 0:r.name),[l,d]=(0,o.useState)("CLI"),c=[{id:"migration",label:"Migration",title:"Download as migration",description:"Download the snippet in a new migration named `".concat(i,"`"),cli:(0,eC.kL)(n,i),npm:(0,eC.kL)(n,i,!0)},{id:"seed",label:"Seed file",title:"Download as seed file",description:"If your query consists of sample data, append the snippet to the end of `supabase/seed.sql`",cli:(0,eC.YI)(n),npm:(0,eC.YI)(n,!0)},{id:"sql",label:"SQL file",title:"Download as SQL file",description:"Download the snippet directly into a new SQL file named `".concat(i,".sql`"),cli:(0,eC.y4)(n,i),npm:(0,eC.y4)(n,i,!0)}];return(0,a.jsx)(eb.Z,{hideFooter:!0,showCloseButton:!0,size:"xlarge",header:(0,a.jsx)("p",{children:"Download snippet as local migration file via the Supabase CLI."}),...s,"data-sentry-element":"Modal","data-sentry-component":"DownloadSnippetModal","data-sentry-source-file":"DownloadSnippetModal.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col items-start justify-between gap-4 relative pt-2",children:[(0,a.jsx)(ew.Z,{type:"underlined",listClassNames:"pl-5","data-sentry-element":"Tabs","data-sentry-source-file":"DownloadSnippetModal.tsx",children:c.map(e=>(0,a.jsx)(ew.Z.Panel,{id:e.id,label:e.label,children:(0,a.jsxs)(eb.Z.Content,{className:"!py-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,a.jsx)("p",{className:"text-base",children:e.title}),(0,a.jsx)(eN.U,{className:"text-sm text-scale-1000 [&>p>code]:!break-normal",content:e.description})]}),(0,a.jsx)(eS.Z,{width:50,options:["CLI","NPM"],activeOption:l,borderOverride:"border-muted",onClickOption:()=>"CLI"===l?d("NPM"):d("CLI")})]}),(0,a.jsx)("pre",{children:(0,a.jsx)(q.d,{language:"bash",className:"language-bash prose dark:prose-dark max-w-none",children:"CLI"===l?e.cli:e.npm})})]})},e.id))}),(0,a.jsxs)(eb.Z.Content,{className:"w-full flex items-center justify-between pt-0","data-sentry-element":"unknown","data-sentry-source-file":"DownloadSnippetModal.tsx",children:[(0,a.jsx)("p",{className:"text-xs text-lighter",children:"Run this command from your project directory"}),(0,a.jsxs)("div",{className:"flex justify-between items-center gap-x-2",children:[(0,a.jsx)(L.z,{asChild:!0,type:"default",icon:(0,a.jsx)(ej.Z,{strokeWidth:1.5}),"data-sentry-element":"Button","data-sentry-source-file":"DownloadSnippetModal.tsx",children:(0,a.jsx)(ee(),{href:"https://supabase.com/docs/guides/deployment/database-migrations",target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"DownloadSnippetModal.tsx",children:"About migrations"})}),(0,a.jsx)(L.z,{asChild:!0,type:"default",icon:(0,a.jsx)(ej.Z,{strokeWidth:1.5}),"data-sentry-element":"Button","data-sentry-source-file":"DownloadSnippetModal.tsx",children:(0,a.jsx)(ee(),{href:"https://supabase.com/docs/guides/cli/local-development",target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"DownloadSnippetModal.tsx",children:"About CLI"})})]})]})]})})},eL=n(78751),eq=n(10839),eQ=n(62507),eE=n(86848),e_=n(5394),eP=n(71484),eZ=n(52521),ek=n(85843),eD=n(36210),eI=n(49142),eF=n(36155),eO=n(42026),ez=n(47482),eA=n(64890),eR=n(56740);let eT=e=>{var t;let{visible:n,snippets:s=[],onClose:r}=e,{ref:i}=(0,Z.UO)(),l=(0,K.B0)(),[c,u]=(0,o.useState)(!1),[p,m]=(0,o.useState)(),{mutateAsync:f,isLoading:x}=(0,ek.P)(),{mutateAsync:h,isLoading:y}=(0,eZ.R)({onError:e=>{d.Am.error("Failed to move query: ".concat(e.message))}}),v="new-folder"===p?e_.Ry({name:e_.Z_().min(1,"Please provide a name for the folder")}).refine(e=>!l.allFolderNames.includes(e.name),{message:"This folder name already exists",path:["name"]}):e_.Ry({}),g=(0,eE.cI)({mode:"onSubmit",reValidateMode:"onSubmit",resolver:(0,eL.F)(v),defaultValues:{name:""}}),j=(0,K.Gd)(i),S="root"===p?"Root of the editor":"new-folder"===p?"Create a new folder":null===(t=j.find(e=>e.id===p))||void 0===t?void 0:t.name,b=1===s.length&&(!s[0].folder_id&&"root"===p||s[0].folder_id===p),w=1===s.length&&(!s[0].folder_id&&"root"===p||s[0].folder_id===p),N=async e=>{if(!i)return console.error("Project ref is required");try{let t=p;if("new-folder"===p&&"name"in e){let{id:n}=await f({projectRef:i,name:e.name});t=n}await Promise.all(s.map(async e=>{let n=null==e?void 0:e.content;if(void 0===n){let{content:t}=await (0,eP.A)({projectRef:i,id:e.id});"sql"in t&&(n=t)}if(void 0===n)return d.Am.error("Failed to save snippet: Unable to retrieve snippet contents");await h({projectRef:i,payload:{id:e.id,type:"sql",name:e.name,description:e.description,visibility:e.visibility,project_id:e.project_id,owner_id:e.owner_id,folder_id:"root"===p?null:t,content:n}})})),d.Am.success("Successfully moved ".concat(1===s.length?'"'.concat(s[0].name,'"'):"".concat(s.length," snippets")," to ").concat("root"===p?"the root of the editor":S)),s.forEach(e=>{l.updateSnippet({id:e.id,snippet:{...e,folder_id:"root"===p?null:t},skipSave:!0})}),r()}catch(e){d.Am.error("Failed to create new folder: ".concat(e.message))}};return(0,o.useEffect)(()=>{if(n&&void 0!==s){if(1===s.length){var e;m(null!==(e=s[0].folder_id)&&void 0!==e?e:"root")}else m("root");g.reset({name:""})}},[n,s]),(0,a.jsx)(eD.Vq,{open:n,onOpenChange:()=>r(),"data-sentry-element":"Dialog","data-sentry-component":"MoveQueryModal","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsx)(eD.cZ,{"data-sentry-element":"DialogContent","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsx)(eI.l0,{...g,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsxs)("form",{id:"move-snippet",onSubmit:g.handleSubmit(N),children:[(0,a.jsxs)(eD.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsxs)(eD.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"MoveQueryModal.tsx",children:["Move ",1===s.length?'"'.concat(s[0].name,'"'):"".concat(s.length)," ","snippet",s.length>1?"s":""," to a folder"]}),(0,a.jsxs)(eD.Be,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"MoveQueryModal.tsx",children:["Select which folder to move your quer",s.length>1?"ies":"y"," to"]})]}),(0,a.jsx)(eD.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"MoveQueryModal.tsx"}),(0,a.jsxs)(eD.VO,{className:"py-5 flex flex-col gap-y-4","data-sentry-element":"DialogSection","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,a.jsx)(eF._,{className:"text-foreground-light","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:"Select a folder"}),(0,a.jsxs)(eO.J2,{open:c,onOpenChange:u,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsx)(eO.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsx)(L.z,{block:!0,size:"small",type:"default",className:"pr-2 justify-between",iconRight:(0,a.jsx)(eq.Z,{className:"text-foreground-light rotate-90",strokeWidth:2,size:12}),"data-sentry-element":"Button","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[S,b&&" (Current)"]})})}),(0,a.jsx)(eO.yk,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsxs)(ez.mY,{"data-sentry-element":"Command_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsx)(ez.sZ,{placeholder:"Find folder...","data-sentry-element":"CommandInput_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx"}),(0,a.jsxs)(ez.e8,{"data-sentry-element":"CommandList_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsx)(ez.rb,{"data-sentry-element":"CommandEmpty_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:"No folders found"}),(0,a.jsx)(ez.fu,{"data-sentry-element":"CommandGroup_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsxs)(eA.x,{className:(j||[]).length>6?"h-[210px]":"","data-sentry-element":"ScrollArea","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsxs)(ez.di,{value:"root",className:"cursor-pointer w-full justify-between",onSelect:()=>{u(!1),m("root")},onClick:()=>{u(!1),m("root")},"data-sentry-element":"CommandItem_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsxs)("span",{children:["Root of the editor",1===s.length&&null===s[0].folder_id&&" (Current)"]}),"root"===p&&(0,a.jsx)(eQ.Z,{size:14})]},"root"),null==j?void 0:j.map(e=>(0,a.jsxs)(ez.di,{value:e.id,className:"cursor-pointer w-full justify-between",onSelect:()=>{u(!1),m(e.id)},onClick:()=>{u(!1),m(e.id)},children:[(0,a.jsxs)("span",{children:[e.name,1===s.length&&s[0].folder_id===e.id&&" (Current)"]}),e.id===p&&(0,a.jsx)(eQ.Z,{size:14})]},e.id))]})}),(0,a.jsx)(ez.zz,{"data-sentry-element":"CommandSeparator_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx"}),(0,a.jsx)(ez.fu,{"data-sentry-element":"CommandGroup_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:(0,a.jsxs)(ez.di,{className:"cursor-pointer w-full justify-start gap-x-2",onSelect:e=>{u(!1),m("new-folder")},onClick:()=>{u(!1),m("new-folder")},"data-sentry-element":"CommandItem_Shadcn_","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsx)(U.Z,{size:14,strokeWidth:1.5,"data-sentry-element":"Plus","data-sentry-source-file":"MoveQueryModal.tsx"}),(0,a.jsx)("p",{children:"New folder"})]})})]})]})})]})]}),"new-folder"===p&&(0,a.jsx)("div",{className:"flex flex-col gap-y-2",children:(0,a.jsx)(eI.Wi,{name:"name",control:g.control,render:e=>{let{field:t}=e;return(0,a.jsxs)(eI.xJ,{className:"flex flex-col gap-y-2",children:[(0,a.jsx)(eI.lX,{children:"Provide a name for your new folder"}),(0,a.jsx)(eI.NI,{children:(0,a.jsx)(eR.I,{autoFocus:!0,...t,autoComplete:"off",disabled:y||x})}),(0,a.jsx)(eI.zG,{})]})}})})]}),(0,a.jsxs)(eD.cN,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"MoveQueryModal.tsx",children:[(0,a.jsx)(L.z,{type:"default",disabled:y||x,onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"MoveQueryModal.tsx",children:"Cancel"}),(0,a.jsx)(L.z,{type:"primary",htmlType:"submit",disabled:w,loading:y||x,"data-sentry-element":"Button","data-sentry-source-file":"MoveQueryModal.tsx",children:"Move file"})]})]})})})})};var eU=n(92797),eB=n(69951),eV=n(75541),eG=n(19540),eK=n(51571),eW=n(77060),e$=n(45437),eY=e=>{let{snippet:t={},visible:n,onCancel:s,onComplete:r}=e,{ref:i}=(0,Z.UO)(),l=(0,eV.l)(),c=(0,K.B0)(),{data:u}=(0,eB.Gl)({orgSlug:null==l?void 0:l.slug}),p="sql"===t.type,m=(0,e$.$w)(u),{id:f,name:x,description:h}=t,[y,v]=(0,o.useState)(x),[g,j]=(0,o.useState)(h),{mutate:S,isLoading:b}=(0,eU.g)({onSuccess:e=>{let{title:t,description:n}=e;v(t),g||j(n)},onError:e=>{d.Am.error("Failed to rename query: ".concat(e.message))}}),w=async()=>{if("content"in t&&p)S({sql:t.content.sql});else try{let{content:e}=await (0,eP.A)({projectRef:i,id:t.id});"sql"in e&&S({sql:e.sql})}catch(e){d.Am.error("Unable to generate title based on query contents")}},{mutateAsync:N}=(0,eZ.R)(),C=async(e,n)=>{let{setSubmitting:a}=n;if(!i)return console.error("Project ref is required");if(!f)return console.error("Snippet ID is required");a(!0);try{let e=t;"content"in e||(e=await (0,eP.A)({projectRef:i,id:f}),c.addSnippet({projectRef:i,snippet:e})),await N({projectRef:i,payload:{...e,name:y,description:g}}),c.renameSnippet({id:f,name:y,description:g}),d.Am.success("Successfully renamed snippet!"),r&&r()}catch(e){a(!1),d.Am.error("Failed to rename snippet: ".concat(e.message))}};return(0,o.useEffect)(()=>{v(x),j(h)},[t.id]),(0,a.jsx)(eb.Z,{visible:n,onCancel:s,hideFooter:!0,header:"Rename",size:"small","data-sentry-element":"Modal","data-sentry-component":"RenameQueryModal","data-sentry-source-file":"RenameQueryModal.tsx",children:(0,a.jsx)(eG.Z,{onReset:s,validateOnBlur:!0,initialValues:{name:null!=x?x:"",description:null!=h?h:""},validate:()=>{let e={};return y||(e.name="Please enter a query name"),e},onSubmit:C,"data-sentry-element":"Form","data-sentry-source-file":"RenameQueryModal.tsx",children:e=>{let{isSubmitting:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eb.Z.Content,{className:"space-y-4",children:[(0,a.jsx)(eK.Z,{label:"Name",id:"name",name:"name",value:y,onChange:e=>v(e.target.value)}),(0,a.jsx)("div",{className:"flex w-full justify-end mt-2",children:!m&&(0,a.jsx)(L.z,{type:"default",onClick:()=>w(),size:"tiny",disabled:b,children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"scale-75",children:(0,a.jsx)(eW.c,{loading:b})}),(0,a.jsx)("span",{children:"Rename with Supabase AI"})]})})}),(0,a.jsx)(eK.Z.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none",value:g,onChange:e=>j(e.target.value)})]}),(0,a.jsx)(eb.Z.Separator,{}),(0,a.jsxs)(eb.Z.Content,{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)(L.z,{htmlType:"reset",type:"default",onClick:s,disabled:t,children:"Cancel"}),(0,a.jsx)(L.z,{htmlType:"submit",loading:t,disabled:t,children:"Rename query"})]})]})}})})},eJ=n(44840),eX=n(39057);let eH=()=>(0,a.jsx)($.Cf,{title:"No private queries created yet",description:"Queries will be automatically saved once you start writing in the editor",className:"mx-4","data-sentry-element":"InnerSideBarEmptyPanel","data-sentry-component":"EmptyPrivateQueriesPanel","data-sentry-source-file":"PrivateSqlSnippetEmpty.tsx",children:(0,a.jsx)("div",{className:"top-0 left-6 flex flex-col opacity-50 cursor-not-allowed bg-dash-sidebar h-content -mb-7 pointer-events-none scale-75",children:(0,a.jsxs)("div",{className:"relative h-content",children:[(0,a.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-10",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-transparent from-80% to-100% to-background-surface-100 dark:to-background-surface-75"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent from-50% to-100% to-background-surface-100 dark:to-background-surface-75"})]}),(0,a.jsx)("div",{className:"absolute left-[128px] bottom-[21px] text-foreground-muted z-10 pointer-events-none",children:(0,a.jsx)(eX.Z,{size:16,className:"text-foreground-light",strokeWidth:1.5,"data-sentry-element":"Pointer","data-sentry-source-file":"PrivateSqlSnippetEmpty.tsx"})}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"border-l pointer-events-none",children:(0,a.jsx)(ec.A7,{isSelected:2===t,id:"dummy-".concat(t+1),name:"dummy_query_".concat(t+1),level:1,xPadding:16})},"dummy-".concat(t+1)))]})})});var e0=n(52090),e1=n(29456);async function e4(e,t){let{projectRef:n,ids:a}=e,{data:s,error:r}=await (0,en.IV)("/platform/projects/{ref}/content/folders",{params:{path:{ref:n},query:{ids:a}},signal:t});if(r)throw(0,en.S3)(r);return s}let e2=function(){let{onError:e,onSuccess:t,invalidateQueriesOnSuccess:n=!0,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,p.NL)();return(0,m.D)(e=>e4(e),{async onSuccess(e,a,r){let{projectRef:i}=a;n&&await s.invalidateQueries(ea.$.folders(i)),await (null==t?void 0:t(e,a,r))},async onError(t,n,a){void 0===e?d.Am.error("Failed to delete folder: ".concat(t.message)):e(t,n,a)},...a})};var e5=n(81277),e3=n(38872),e6=n(11221),e9=n(54135),e7=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row h-6 px-3 items-center gap-3",children:[(0,a.jsx)(e9.O,{className:"h-4 w-5","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"}),(0,a.jsx)(e9.O,{className:"w-40 h-4","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"})]}),(0,a.jsxs)("div",{className:"flex flex-row h-6 px-3 items-center gap-3",children:[(0,a.jsx)(e9.O,{className:"h-4 w-5","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"}),(0,a.jsx)(e9.O,{className:"w-32 h-4","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"})]}),(0,a.jsxs)("div",{className:"flex flex-row h-6 px-3 items-center gap-3 opacity-75",children:[(0,a.jsx)(e9.O,{className:"h-4 w-5","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"}),(0,a.jsx)(e9.O,{className:"w-20 h-4","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"})]}),(0,a.jsxs)("div",{className:"flex flex-row h-6 px-3 items-center gap-3 opacity-50",children:[(0,a.jsx)(e9.O,{className:"h-4 w-5","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"}),(0,a.jsx)(e9.O,{className:"w-40 h-4","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"})]}),(0,a.jsxs)("div",{className:"flex flex-row h-6 px-3 items-center gap-3 opacity-25",children:[(0,a.jsx)(e9.O,{className:"h-4 w-5","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"}),(0,a.jsx)(e9.O,{className:"w-20 h-4","data-sentry-element":"Skeleton","data-sentry-source-file":"SQLEditorLoadingSnippets.tsx"})]})]});let e8={id:0,name:"",parent:null,children:[]},te=e=>{var t,n;if(void 0===e)return[e8];let{folders:a,contents:s}=e,r=(null==a?void 0:a.map(e=>{var t;let{id:n,name:a}=e;return{id:n,name:a,parent:0,isBranch:!0,children:null!==(t=null==s?void 0:s.filter(e=>e.folder_id===n).map(e=>e.id))&&void 0!==t?t:[],metadata:e}}))||[],i=(null==s?void 0:s.map(e=>{let{id:t,name:n,folder_id:a}=e;return{id:t,name:n,parent:null!=a?a:0,children:[],metadata:e}}))||[];return[{id:0,name:"",parent:null,children:[...null===(t=a||[])||void 0===t?void 0:t.map(e=>e.id),...null===(n=(s||[]).filter(e=>!e.folder_id))||void 0===n?void 0:n.map(e=>e.id)]},...r,...i]};function tt(e){let t=new Set,n=e.filter(e=>0===e.parent);if(n.length>0){let e=n[n.length-1];"string"==typeof e.id&&t.add(e.id),n.forEach(e=>{if(e.children.length>0){let n=e.children[e.children.length-1];"string"==typeof n&&t.add(n)}})}return t}var tn=n(3977),ta=n(74304),ts=n(3374),tr=n(5027),ti=n(11024),tl=n(58596),to=n(29790),td=n(34243);async function tc(e,t){let{projectRef:n,folderId:a,cursor:s,sort:r,name:i}=e;if(void 0===n)throw Error("projectRef is required");if(void 0===a)throw Error("folderId is required");let{data:l,error:o}=await (0,en.U2)("/platform/projects/{ref}/content/folders/{id}",{params:{path:{ref:n,id:a},query:{cursor:s,limit:ed.KJ.toString(),sort_by:r,sort_order:"name"===r?"asc":"desc",name:i}},signal:t});return o&&(0,en.S3)(o),{...l.data,cursor:l.cursor}}let tu=function(e){let{projectRef:t,folderId:n,name:a,sort:s}=e,{enabled:r=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ei.N)(ea.$.folderContents(t,n,{name:a,sort:s}),e=>{let{signal:r,pageParam:i}=e;return tc({projectRef:t,folderId:n,cursor:i,name:a,sort:s},r)},{enabled:r&&void 0!==t&&void 0!==n,getNextPageParam:e=>e.cursor,...i})};var tp=n(72048),tm=n(94669);let tf=e=>{let{element:t,isBranch:n,isExpanded:s,level:r,status:i,isSelected:l,isMultiSelected:d,getNodeProps:c,onSelectCreate:u,onSelectDelete:p,onSelectRename:m,onSelectMove:f,onSelectShare:x,onSelectUnshare:h,onSelectDownload:y,onSelectDuplicate:v,onEditSave:g,onMultiSelect:j,isLastItem:S,hasNextPage:b,fetchNextPage:w,isFetchingNextPage:N,sort:C,name:M,onFolderContentsChange:q}=e,Q=(0,G.useRouter)(),{id:E,ref:_}=(0,td.U)(),{profile:P}=(0,R.Un)(),{className:k,onClick:D}=c(),I=(0,K.B0)(),O=(null==P?void 0:P.id)===(null==t?void 0:t.metadata.owner_id),A="project"===t.metadata.visibility,T="editing"===i,B=(0,z.Xo)(F.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null==P?void 0:P.id},subject:{id:null==P?void 0:P.id}}),V=0===t.parent?void 0:t.parent,W=n&&s,{data:$,isSuccess:Y,isLoading:J,isFetchingNextPage:X,hasNextPage:H,fetchNextPage:et,isPreviousData:en,isFetching:ea}=tu({projectRef:_,folderId:null!=V?V:t.id,name:M,sort:C},{enabled:W,keepPreviousData:!0});(0,o.useEffect)(()=>{_&&Y&&$.pages.forEach(e=>{var t;null===(t=e.contents)||void 0===t||t.forEach(e=>{I.addSnippet({projectRef:_,snippet:e})})})},[_,null==$?void 0:$.pages]);let es=(0,tp.Z)(q);(0,o.useEffect)(()=>{if(W){var e;null===(e=es.current)||void 0===e||e.call(es,{isLoading:J||en&&ea,snippets:null==$?void 0:$.pages.flatMap(e=>{var t;return null!==(t=e.contents)&&void 0!==t?t:[]})})}},[null==$?void 0:$.pages,ea,J,en,W]);let er=void 0!==V;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(tm.xV,{modal:!1,"data-sentry-element":"ContextMenu_Shadcn_","data-sentry-source-file":"SQLEditorTreeViewItem.tsx",children:[(0,a.jsx)(tm.W4,{asChild:!0,"data-sentry-element":"ContextMenuTrigger_Shadcn_","data-sentry-source-file":"SQLEditorTreeViewItem.tsx",children:(0,a.jsx)(ec.A7,{className:k,level:r,isExpanded:s,isBranch:n,isSelected:l,isEditing:T,isLoading:W&&J||"saving"===i,onEditSubmit:e=>{void 0!==g&&g(e)},onClick:e=>{n?T||D(e):e.shiftKey&&"new"!==E?null==j||j(t.id):Q.push("/project/".concat(_,"/sql/").concat(t.id))},name:t.name,xPadding:16,"data-sentry-element":"TreeViewItem","data-sentry-source-file":"SQLEditorTreeViewItem.tsx"})}),(0,a.jsx)(tm.h_,{onCloseAutoFocus:e=>e.stopPropagation(),"data-sentry-element":"ContextMenuContent_Shadcn_","data-sentry-source-file":"SQLEditorTreeViewItem.tsx",children:n?(0,a.jsxs)(a.Fragment,{children:[void 0!==u&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>u(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(U.Z,{size:14}),"Create new snippet"]}),void 0!==m&&O&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>m(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(tn.Z,{size:14}),"Rename folder"]}),void 0!==p&&O&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tm.uP,{}),(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>p(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(ta.Z,{size:14}),"Delete folder"]})]})]}):d?(0,a.jsxs)(a.Fragment,{children:[void 0!==f&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>f(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(ts.Z,{size:14}),"Move selected queries"]}),(0,a.jsx)(tm.uP,{}),void 0!==p&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>p(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(ta.Z,{size:14}),"Delete selected queries"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tm.Zo,{asChild:!0,className:"gap-x-2",onSelect:()=>{},onFocusCapture:e=>e.stopPropagation(),children:(0,a.jsxs)(ee(),{href:"/project/".concat(_,"/sql/").concat(t.id),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(ej.Z,{size:14}),"Open in new tab"]})}),(0,a.jsx)(tm.uP,{}),void 0!==m&&O&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>m(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(tn.Z,{size:14}),"Rename query"]}),void 0!==f&&O&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>f(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(ts.Z,{size:14}),"Move query"]}),void 0!==x&&!A&&B&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>x(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(tr.Z,{size:14}),"Share query with team"]}),void 0!==h&&A&&O&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>h(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(ti.Z,{size:14}),"Unshare query with team"]}),void 0!==v&&B&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>v(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(tl.Z,{size:14}),"Duplicate query"]}),void 0!==y&&Z.Qy&&(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>y(),onFocusCapture:e=>e.stopPropagation(),children:[(0,a.jsx)(to.Z,{size:14}),"Download as migration file"]}),void 0!==p&&O&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tm.uP,{}),(0,a.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>p(),children:[(0,a.jsx)(ta.Z,{size:14}),"Delete query"]})]})]})})]}),(er?H:b)&&"string"==typeof t.id&&S&&(0,a.jsx)("div",{className:"px-4 py-1",style:{paddingLeft:!t.isBranch&&t.level>1?48*(t.level-1):void 0},children:(0,a.jsx)(L.z,{type:"outline",size:"tiny",block:!0,loading:er?X:N,disabled:er?X:N,onClick:function(){er?et():"function"==typeof w&&w()},children:"Load More"})})]})},tx={shared:!1,favorite:!1,private:!0},th=e=>{var t,n,s,r,i,l,c;let{sort:u="inserted_at"}=e,p=(0,G.useRouter)(),{profile:m}=(0,R.Un)(),f=(0,b.Vm)(),{ref:x,id:h}=(0,Z.UO)(),y=(0,K.B0)(),[v,g]=(0,A._)(N.dA.SQL_EDITOR_SECTION_STATE(null!=x?x:""),tx),{shared:j,favorite:S,private:w}=v,[C,M]=(0,o.useState)(!1),[L,q]=(0,o.useState)(!1),[Q,E]=(0,o.useState)(!1),[P,k]=(0,o.useState)([]),[D,I]=(0,o.useState)([]),[F,O]=(0,o.useState)(),[z,T]=(0,o.useState)(),[U,B]=(0,o.useState)(),[V,W]=(0,o.useState)(),[Y,J]=(0,o.useState)(),X=null===(t=y.snippets[h])||void 0===t?void 0:t.snippet,{data:H,isSuccess:ee,isLoading:et,isPreviousData:en,isFetching:ea,hasNextPage:es,fetchNextPage:ei,isFetchingNextPage:el}=(0,ed.md)({projectRef:x,sort:u},{keepPreviousData:!0}),[eo,eu]=(0,o.useState)({}),ep=(0,o.useMemo)(()=>{var e;let t=null!==(e=null==H?void 0:H.pages.flatMap(e=>{var t;return null!==(t=e.contents)&&void 0!==t?t:[]}))&&void 0!==e?e:[],n=Object.values(eo).reduce((e,t)=>{var n;let a=(null!==(n=t.snippets)&&void 0!==n?n:[]).filter(t=>!e.snippetIds.has(t.id)),s=new Set(a.map(e=>e.id));return{snippets:[...e.snippets,...a],isLoading:e.isLoading||t.isLoading,snippetIds:new Set([...e.snippetIds,...s])}},{snippets:t,isLoading:et||en&&ea,snippetIds:new Set(t.map(e=>e.id))});return X&&"user"===X.visibility&&!n.snippetIds.has(X.id)&&(n.snippetIds.add(X.id),n.snippets=[...n.snippets,X]),n},[null==H?void 0:H.pages,eo,et,en,ea,X]),em=(0,o.useMemo)(()=>{var e,t;return null!==(t=null===(e=ep.snippets)||void 0===e?void 0:e.filter(e=>"user"===e.visibility).sort((e,t)=>"name"===u?e.name.localeCompare(t.name):new Date(t.inserted_at).valueOf()-new Date(e.inserted_at).valueOf()))&&void 0!==t?t:[]},[ep.snippets,u]),ev=(0,K.Gd)(x),{data:eg}=er({projectRef:x,type:"sql"}),ej=null!==(r=null==eg?void 0:eg.private)&&void 0!==r?r:0,eS=(0,o.useMemo)(()=>0===ev.length&&0===em.length?[e8]:te({folders:ev,contents:em}),[ev,em]),eb=(0,o.useMemo)(()=>tt(eS),[eS]),{data:ew,isLoading:eN,hasNextPage:eL,fetchNextPage:eq,isFetchingNextPage:eQ,isSuccess:eE}=(0,e5.v)({projectRef:x,favorite:!0,sort:u},{enabled:S,keepPreviousData:!0}),e_=(0,o.useMemo)(()=>{var e,t;let n=null!==(e=null==ew?void 0:ew.pages.flatMap(e=>{var t;return null!==(t=e.contents)&&void 0!==t?t:[]}))&&void 0!==e?e:[];return X&&X.favorite&&!n.find(e=>e.id===X.id)&&n.push(X),null!==(t=n.map(e=>({...e,folder_id:void 0})).sort((e,t)=>"name"===u?e.name.localeCompare(t.name):new Date(t.inserted_at).valueOf()-new Date(e.inserted_at).valueOf()))&&void 0!==t?t:[]},[null==ew?void 0:ew.pages,X,u]),ek=null!==(i=null==eg?void 0:eg.favorites)&&void 0!==i?i:0,eD=(0,o.useMemo)(()=>0===e_.length?[e8]:te({contents:e_}),[e_]),eI=(0,o.useMemo)(()=>tt(eD),[eD]),{data:eF,isLoading:eO,hasNextPage:ez,fetchNextPage:eA,isFetchingNextPage:eR,isSuccess:eU}=(0,e5.v)({projectRef:x,visibility:"project",sort:u},{enabled:j,keepPreviousData:!0}),eB=(0,o.useMemo)(()=>{var e,t;let n=null!==(e=null==eF?void 0:eF.pages.flatMap(e=>{var t;return null!==(t=e.contents)&&void 0!==t?t:[]}))&&void 0!==e?e:[];return X&&"project"===X.visibility&&!n.find(e=>e.id===X.id)&&n.push(X),null!==(t=n.sort((e,t)=>"name"===u?e.name.localeCompare(t.name):new Date(t.inserted_at).valueOf()-new Date(e.inserted_at).valueOf()))&&void 0!==t?t:[]},[null==eF?void 0:eF.pages,X,u]),eV=null!==(l=null==eg?void 0:eg.shared)&&void 0!==l?l:0,eG=(0,o.useMemo)(()=>0===eB.length?[e8]:te({contents:eB}),[eB]),eK=(0,o.useMemo)(()=>tt(eG),[eG]),{mutate:eW,isLoading:e$}=(0,eZ.R)({onError:e=>{d.Am.error("Failed to update query: ".concat(e.message))}}),{mutate:eX,isLoading:e4}=(0,e1.z)({onError:(e,t)=>{e.message.includes("Contents not found")?ta(t.ids):d.Am.error("Failed to delete query: ".concat(e.message))}}),{mutate:e9,isLoading:tn}=e2({onSuccess:(e,t)=>{d.Am.success("Successfully deleted folder");let{ids:n}=t;y.removeFolder(n[0]),J(void 0)}}),ta=e=>{q(!1),I([]);let t=Object.keys(y.snippets).filter(t=>!e.includes(t));0===t.length?p.push("/project/".concat(x,"/sql/new")):e.includes(h)&&p.push("/project/".concat(x,"/sql/").concat(t[0])),e.length>0&&e.forEach(e=>y.removeSnippet(e))},ts=async e=>{var t;let n="share"===e?F:z;if(!x)return console.error("Project ref is required");if(!n)return console.error("Snippet ID is required");let a=y.snippets[n.id],s=null==a?void 0:null===(t=a.snippet)||void 0===t?void 0:t.content;if(void 0===s){let{content:e}=await (0,eP.A)({projectRef:x,id:n.id});s=e}if(void 0===s)return d.Am.error("Unable to update snippet visibility: Content is missing");let r="share"===e?"project":"user";eW({projectRef:x,payload:{...n,visibility:r,folder_id:null,content:s}},{onSuccess:()=>{O(void 0),T(void 0),g({...v,shared:!0}),y.updateSnippet({id:n.id,snippet:{visibility:r,folder_id:null},skipSave:!0}),d.Am.success("share"===e?"Snippet is now shared to the project":"Snippet is now unshared from the project")}})},tr=async e=>{if(!m)return console.error("Profile is required");if(!f)return console.error("Project is required");if(!x)return console.error("Project ref is required");if(!h)return console.error("Snippet ID is required");let t="";if(e.content&&e.content.sql)t=e.content.sql;else{let{content:n}=await (0,eP.A)({projectRef:x,id:e.id});"sql"in n&&(t=n.sql)}let n=(0,eC.wI)({id:(0,e3.Z)(),name:"".concat(e.name," (Duplicate)"),sql:t,owner_id:null==m?void 0:m.id,project_id:null==f?void 0:f.id});y.addSnippet({projectRef:x,snippet:n}),y.addNeedsSaving(n.id),p.push("/project/".concat(x,"/sql/").concat(n.id))},ti=async()=>{if(!x)return console.error("Project ref is required");if(void 0===Y)return console.error("No folder is selected");let e=em.filter(e=>e.folder_id===Y.id);if(e.length>0){let t=e.map(e=>e.id);eX({projectRef:x,ids:t},{onSuccess:()=>{t.forEach(e=>y.removeSnippet(e)),ta(t),e9({projectRef:x,ids:[null==Y?void 0:Y.id]})}})}else e9({projectRef:x,ids:[null==Y?void 0:Y.id]})},tl=e=>{let t=em.map(e=>e.id),n=t.indexOf(h),a=t.indexOf(e),s=Math.min(n,a),r=Math.max(n,a),i=[],l=em[s].folder_id===em[r].folder_id;for(let e=s;e<=r;e++)l&&em[e].folder_id===em[s].folder_id&&i.push(em[e]);I(i)};return(0,o.useEffect)(()=>{void 0!==X&&ee&&("project"===X.visibility?g({...v,shared:!0}):"user"===X.visibility&&g({...v,private:!0}),X.folder_id&&!P.includes(X.folder_id)&&k([...P,X.folder_id]))},[X,u,ee]),(0,o.useEffect)(()=>{I([])},[h]),(0,o.useEffect)(()=>{x&&H&&H.pages.forEach(e=>{var t,n;null===(t=e.contents)||void 0===t||t.forEach(e=>{y.addSnippet({projectRef:x,snippet:e})}),null===(n=e.folders)||void 0===n||n.forEach(e=>y.addFolder({projectRef:x,folder:e}))})},[x,null==H?void 0:H.pages]),(0,o.useEffect)(()=>{void 0!==x&&eE&&ew.pages.forEach(e=>{var t;null===(t=e.contents)||void 0===t||t.forEach(e=>{y.addSnippet({projectRef:x,snippet:e})})})},[x,null==H?void 0:H.pages]),(0,o.useEffect)(()=>{void 0!==x&&eU&&eF.pages.forEach(e=>{var t;null===(t=e.contents)||void 0===t||t.forEach(e=>{y.addSnippet({projectRef:x,snippet:e})})})},[x,null==H?void 0:H.pages]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)($.GZ,{className:"px-0",open:j,onOpenChange:e=>{g({...null!=v?v:tx,shared:e})},"data-sentry-element":"InnerSideMenuCollapsible","data-sentry-source-file":"SQLEditorNav.tsx",children:[(0,a.jsx)($.Qn,{title:"Shared ".concat(eV>0?" (".concat(eV,")"):""),"data-sentry-element":"InnerSideMenuCollapsibleTrigger","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)($.rt,{className:"group-data-[state=open]:pt-2","data-sentry-element":"InnerSideMenuCollapsibleContent","data-sentry-source-file":"SQLEditorNav.tsx",children:0===eV?(0,a.jsx)($.Cf,{className:"mx-2",title:"No shared queries",description:"Share queries with your team by right-clicking on the query."}):(0,a.jsx)(ec.LQ,{data:eG,"aria-label":"project-level-snippets",nodeRenderer:e=>{var t;let{element:n,...s}=e,r=(null===(t=n.metadata)||void 0===t?void 0:t.id)===h;return(0,a.jsx)(tf,{...s,isSelected:r,element:n,onSelectDelete:()=>{q(!0),I([n.metadata])},onSelectRename:()=>{E(!0),B(n.metadata)},onSelectDownload:()=>{W(n.metadata)},onSelectDuplicate:()=>{tr(n.metadata)},onSelectUnshare:()=>{T(n.metadata)},isLastItem:eK.has(n.id),hasNextPage:ez,fetchNextPage:eA,isFetchingNextPage:eR})}})})]}),(0,a.jsx)($.qs,{"data-sentry-element":"InnerSideMenuSeparator","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsxs)($.GZ,{className:"px-0",open:S,onOpenChange:e=>{g({...null!=v?v:tx,favorite:e})},"data-sentry-element":"InnerSideMenuCollapsible","data-sentry-source-file":"SQLEditorNav.tsx",children:[(0,a.jsx)($.Qn,{title:"Favorites ".concat(ek>0?" (".concat(ek,")"):""),"data-sentry-element":"InnerSideMenuCollapsibleTrigger","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)($.rt,{className:"group-data-[state=open]:pt-2","data-sentry-element":"InnerSideMenuCollapsibleContent","data-sentry-source-file":"SQLEditorNav.tsx",children:eN?(0,a.jsx)(e7,{}):0===ek?(0,a.jsx)($.Cf,{title:"No favorite queries",className:"mx-2 px-3",description:(0,a.jsxs)(a.Fragment,{children:["Save a query to favorites for easy accessibility by clicking the"," ",(0,a.jsx)(ef.Z,{size:12,className:"inline-block relative align-center -top-[1px]"})," ","icon."]})}):(0,a.jsx)(ec.LQ,{data:eD,"aria-label":"favorite-snippets",nodeRenderer:e=>{var t;let{element:n,...s}=e,r=(null===(t=n.metadata)||void 0===t?void 0:t.id)===h;return(0,a.jsx)(tf,{...s,isSelected:r,element:n,onSelectDelete:()=>{q(!0),I([n.metadata])},onSelectRename:()=>{E(!0),B(n.metadata)},onSelectDownload:()=>{W(n.metadata)},onSelectDuplicate:()=>{tr(n.metadata)},onSelectShare:()=>O(n.metadata),onSelectUnshare:()=>{T(n.metadata)},isLastItem:eI.has(n.id),hasNextPage:eL,fetchNextPage:eq,isFetchingNextPage:eQ})}})})]}),(0,a.jsx)($.qs,{"data-sentry-element":"InnerSideMenuSeparator","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsxs)($.GZ,{open:w,onOpenChange:e=>{g({...null!=v?v:tx,private:e})},className:"px-0","data-sentry-element":"InnerSideMenuCollapsible","data-sentry-source-file":"SQLEditorNav.tsx",children:[(0,a.jsx)($.Qn,{title:"PRIVATE\n            ".concat(ej>0?" (".concat(ej,")"):""),"data-sentry-element":"InnerSideMenuCollapsibleTrigger","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)($.rt,{className:"group-data-[state=open]:pt-2","data-sentry-element":"InnerSideMenuCollapsibleContent","data-sentry-source-file":"SQLEditorNav.tsx",children:et?(0,a.jsx)(e0.Z,{}):0===ev.length&&0===ej?(0,a.jsx)(eH,{}):(0,a.jsx)(ec.LQ,{multiSelect:!0,togglableSelect:!0,clickAction:"EXCLUSIVE_SELECT",data:eS,selectedIds:D.map(e=>e.id),"aria-label":"private-snippets",onExpand:e=>{let t=e.element.id.toString();e.isExpanded&&!P.includes(t)&&k([...P,t]),!e.isExpanded&&P.includes(t)&&k(P.filter(e=>e!==t))},expandedIds:P,nodeRenderer:e=>{var t;let{element:n,...s}=e,r=(null===(t=n.metadata)||void 0===t?void 0:t.id)===h;return(0,a.jsx)(tf,{...s,element:n,isSelected:r,isMultiSelected:D.length>1,isLastItem:eb.has(n.id),status:s.isBranch?y.folders[n.id].status:"idle",onMultiSelect:tl,onSelectCreate:()=>{if(m&&f){let e=(0,eC.wI)({id:(0,e3.Z)(),name:eJ.$C,owner_id:null==m?void 0:m.id,project_id:null==f?void 0:f.id,folder_id:n.id,sql:""});y.addSnippet({projectRef:f.ref,snippet:e}),p.push("/project/".concat(x,"/sql/").concat(e.id))}},onSelectDelete:()=>{s.isBranch?J(n.metadata):(q(!0),0===D.length&&I([n.metadata]))},onSelectRename:()=>{s.isBranch?y.editFolder(n.id):(E(!0),B(n.metadata))},onSelectMove:()=>{M(!0),0===D.length&&I([n.metadata])},onSelectDownload:()=>W(n.metadata),onSelectDuplicate:()=>tr(n.metadata),onSelectShare:()=>O(n.metadata),onEditSave:e=>{0===e.length&&"new-folder"===n.id?y.removeFolder(n.id):e.length>0&&y.saveFolder({id:n.id,name:e})},hasNextPage:es,fetchNextPage:ei,isFetchingNextPage:el,sort:u,onFolderContentsChange:e=>{let{isLoading:t,snippets:a}=e;eu(e=>({...e,[n.id]:{snippets:a,isLoading:t}}))}})}})})]}),(0,a.jsx)(e6.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)(eY,{snippet:U,visible:Q,onCancel:()=>E(!1),onComplete:()=>E(!1),"data-sentry-element":"RenameQueryModal","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)(eT,{snippets:D,visible:C,onClose:()=>{M(!1),I([])},"data-sentry-element":"MoveQueryModal","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)(eM,{id:null!==(c=null==V?void 0:V.id)&&void 0!==c?c:"",visible:void 0!==V,onCancel:()=>W(void 0),"data-sentry-element":"DownloadSnippetModal","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)(_.Z,{size:"medium",loading:e$,title:"Confirm to share query: ".concat(null==F?void 0:F.name),confirmLabel:"Share query",confirmLabelLoading:"Sharing query",visible:void 0!==F,onCancel:()=>O(void 0),onConfirm:()=>ts("share"),alert:{title:"This SQL query will become public to all team members",description:"Anyone with access to the project can view it"},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SQLEditorNav.tsx",children:(0,a.jsxs)("ul",{className:"text-sm text-foreground-light space-y-5",children:[(0,a.jsxs)("li",{className:"flex gap-3 items-center",children:[(0,a.jsx)(ex.Z,{size:16,"data-sentry-element":"Eye","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)("span",{children:"Project members will have read-only access to this query."})]}),(0,a.jsxs)("li",{className:"flex gap-3 items-center",children:[(0,a.jsx)(eh.Z,{size:16,"data-sentry-element":"Unlock","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)("span",{children:"Anyone will be able to duplicate it to their personal snippets."})]})]})}),(0,a.jsx)(_.Z,{size:"medium",title:"Confirm to unshare query: ".concat(null==z?void 0:z.name),confirmLabel:"Unshare query",confirmLabelLoading:"Unsharing query",visible:void 0!==z,onCancel:()=>T(void 0),onConfirm:()=>ts("unshare"),alert:{title:"This SQL query will no longer be public to all team members",description:"Only you will have access to this query"},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SQLEditorNav.tsx",children:(0,a.jsx)("ul",{className:"text-sm text-foreground-light space-y-5",children:(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsx)(ey.Z,{"data-sentry-element":"EyeOffIcon","data-sentry-source-file":"SQLEditorNav.tsx"}),(0,a.jsx)("span",{children:"Project members will no longer be able to view this query."})]})})}),(0,a.jsx)(_.Z,{size:"small",title:"Confirm to delete ".concat(1===D.length?"query":"".concat(D.length.toLocaleString()," quer").concat(D.length>1?"ies":"y")),confirmLabel:"Delete ".concat(D.length.toLocaleString()," quer").concat(D.length>1?"ies":"y"),confirmLabelLoading:"Deleting query",loading:e4,visible:L,variant:"destructive",onCancel:()=>{q(!1),I([])},onConfirm:()=>{if(!x)return console.error("Project ref is required");eX({projectRef:x,ids:D.map(e=>e.id)},{onSuccess:e=>{d.Am.success("Successfully deleted ".concat(D.length.toLocaleString()," quer").concat(D.length>1?"ies":"y")),ta(e)}})},alert:(null===(n=D[0])||void 0===n?void 0:n.visibility)==="project"?{title:"This SQL snippet will be lost forever",description:"Deleting this query will remove it for all members of the project team."}:void 0,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SQLEditorNav.tsx",children:(0,a.jsxs)("p",{className:"text-sm",children:["This action cannot be undone."," ",1===D.length?"Are you sure you want to delete '".concat(null===(s=D[0])||void 0===s?void 0:s.name,"'?"):"Are you sure you want to delete the selected ".concat(D.length," quer").concat(D.length>1?"ies":"y","?")]})}),(0,a.jsx)(_.Z,{size:"small",title:"Confirm to delete folder",confirmLabel:"Delete folder",confirmLabelLoading:"Deleting folder",loading:tn,visible:void 0!==Y,variant:"destructive",onCancel:()=>J(void 0),onConfirm:ti,alert:{title:"This action cannot be undone",description:"All SQL snippets within the folder will be permanently removed, and cannot be recovered."},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SQLEditorNav.tsx",children:(0,a.jsxs)("p",{className:"text-sm",children:["Are you sure you want to delete the folder '",null==Y?void 0:Y.name,"'?"]})})]})},ty=()=>{let e=(0,G.useRouter)(),{profile:t}=(0,R.Un)(),n=(0,b.Vm)(),{ref:s}=(0,Z.UO)(),r=(0,K.B0)(),[i,l]=(0,o.useState)(""),[c,u]=(0,o.useState)(!1),[p,m]=(0,A._)(N.dA.SQL_EDITOR_SORT(null!=s?s:""),"inserted_at"),f=(0,P.Mb)(),x=(0,O.Nr)(i,500),h=(0,z.Xo)(F.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null==t?void 0:t.id},subject:{id:null==t?void 0:t.id}}),y=()=>{if(!s)return console.error("Project ref is required");l(""),u(!1),r.addNewFolder({projectRef:s})},v=async()=>{if(!s)return console.error("Project ref is required");if(!n)return console.error("Project is required");if(!t)return console.error("Profile is required");if(!h)return(0,d.Am)("Your queries will not be saved as you do not have sufficient permissions");try{e.push("/project/".concat(s,"/sql/new?skip=true")),l(""),u(!1)}catch(e){d.Am.error("Failed to create new query: ".concat(e.message))}};return(0,o.useEffect)(()=>{u(x.length>0)},[x]),(0,a.jsxs)("div",{className:"h-full flex flex-col justify-between","data-sentry-component":"SQLEditorMenu","data-sentry-source-file":"SQLEditorMenu.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 flex-grow",children:[(0,a.jsxs)("div",{className:"mt-4 mx-4 flex items-center justify-between gap-x-2",children:[(0,a.jsx)($.nM,{className:"w-full p-0 gap-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"SQLEditorMenu.tsx",children:(0,a.jsx)($.nn,{name:"search-queries",placeholder:"Search queries...","aria-labelledby":"Search queries",value:i,onChange:e=>{let t=e.target.value;l(t),0===t.length&&u(!1)},onKeyDown:e=>{"Escape"===e.code&&(l(""),u(!1))},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"SQLEditorMenu.tsx",children:c?(0,a.jsxs)(E.u,{children:[(0,a.jsx)(E.aJ,{className:"absolute right-1 top-[.4rem] md:top-[.3rem] transition-colors text-foreground-light hover:text-foreground",onClick:()=>{l(""),u(!1)},children:(0,a.jsx)(T.Z,{size:18})}),(0,a.jsx)(E._v,{children:"Clear search"})]}):(0,a.jsxs)($.ZY,{value:p,onValueChange:e=>m(e),children:[(0,a.jsx)($.IR,{value:"name",children:"Alphabetical"},"name"),(0,a.jsx)($.IR,{value:"inserted_at",children:"Created At"},"inserted_at")]})})}),(0,a.jsxs)(W.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"SQLEditorMenu.tsx",children:[(0,a.jsx)(W.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"SQLEditorMenu.tsx",children:(0,a.jsx)(L.z,{type:"default",icon:(0,a.jsx)(U.Z,{className:"text-foreground"}),className:"w-[26px]","data-sentry-element":"Button","data-sentry-source-file":"SQLEditorMenu.tsx"})}),(0,a.jsxs)(W.AW,{align:"end",side:"bottom",className:"w-48","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"SQLEditorMenu.tsx",children:[(0,a.jsxs)(W.Xi,{className:"gap-x-2",onClick:()=>v(),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"SQLEditorMenu.tsx",children:[(0,a.jsx)(B.Z,{size:14,"data-sentry-element":"FilePlus","data-sentry-source-file":"SQLEditorMenu.tsx"}),"Create a new snippet"]}),(0,a.jsxs)(W.Xi,{className:"gap-x-2",onClick:()=>y(),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"SQLEditorMenu.tsx",children:[(0,a.jsx)(V.Z,{size:14,"data-sentry-element":"FolderPlus","data-sentry-source-file":"SQLEditorMenu.tsx"}),"Create a new folder"]})]})]})]}),c?(0,a.jsx)(ep,{search:x}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(J,{}),(0,a.jsx)(th,{sort:p})]})]}),(0,a.jsx)("div",{className:"p-4 border-t sticky bottom-0 bg-studio",children:(0,a.jsx)(L.z,{block:!0,type:"default",onClick:()=>f.setOnGoingQueriesPanelOpen(!0),"data-sentry-element":"Button","data-sentry-source-file":"SQLEditorMenu.tsx",children:"View running queries"})})]})};var tv=(0,D.Q)(e=>{let{title:t,children:n}=e,s=(0,o.useMemo)(()=>(0,a.jsx)(ty,{},"sql-editor-menu"),[]);return(0,a.jsxs)(I.Z,{title:t||"SQL",product:"SQL Editor",productMenu:s,isBlocking:!1,resizableSidebar:!0,"data-sentry-element":"ProjectLayout","data-sentry-component":"SQLEditorLayout","data-sentry-source-file":"SQLEditorLayout.tsx",children:[n,(0,a.jsx)(k,{"data-sentry-element":"OngoingQueriesPanel","data-sentry-source-file":"SQLEditorLayout.tsx"})]})})},52090:function(e,t,n){var a=n(97458),s=n(52983),r=n(54135);let i=(0,s.memo)(function(){return(0,a.jsx)("div",{className:"px-4 flex flex-col gap-0",children:[{width:"w-40",opacity:"opacity-100"},{width:"w-32",opacity:"opacity-100"},{width:"w-20",opacity:"opacity-75"},{width:"w-40",opacity:"opacity-50"},{width:"w-20",opacity:"opacity-25"}].map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-row h-6 items-center gap-3 ".concat(e.opacity),children:[(0,a.jsx)(r.O,{className:"h-4 w-5"}),(0,a.jsx)(r.O,{className:"h-4 ".concat(e.width)})]},t))})});t.Z=i},95526:function(e,t,n){var a=n(97458),s=n(77317),r=n(52983),i=n(25843);let l=e=>{var t,n,l;let{defaultActiveId:o,activeId:d,type:c="pills",size:u="tiny",block:p,onChange:m,onClick:f,scrollable:x,wrappable:h,addOnBefore:y,addOnAfter:v,listClassNames:g,baseClassNames:j,refs:S,children:b}=e,w=r.Children.toArray(b),[N,C]=(0,r.useState)(null!==(l=null!=d?d:o)&&void 0!==l?l:null==w?void 0:null===(n=w[0])||void 0===n?void 0:null===(t=n.props)||void 0===t?void 0:t.id);(0,r.useMemo)(()=>{d&&d!==N&&C(d)},[d]);let M=(0,i.Z)("tabs");function L(e){null==f||f(e),e!==N&&(null==m||m(e),C(e))}let q=[M[c].list];return x&&q.push(M.scrollable),h&&q.push(M.wrappable),g&&q.push(g),(0,a.jsxs)(s.fC,{value:N,className:[M.base,j].join(" "),ref:null==S?void 0:S.base,"data-sentry-element":"unknown","data-sentry-component":"Tabs","data-sentry-source-file":"Tabs.tsx",children:[(0,a.jsxs)(s.aV,{className:q.join(" "),ref:null==S?void 0:S.list,"data-sentry-element":"unknown","data-sentry-source-file":"Tabs.tsx",children:[y,w.map(e=>{let t=N===e.props.id,n=[M[c].base,M.size[u]];return t?n.push(M[c].active):n.push(M[c].inactive),p&&n.push(M.block),(0,a.jsxs)(s.xz,{onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),L(e.props.id))},onClick:()=>L(e.props.id),value:e.props.id,className:n.join(" "),children:[e.props.icon,(0,a.jsx)("span",{children:e.props.label}),e.props.iconRight]},"".concat(e.props.id,"-tab-button"))}),v]}),w]})};l.Panel=e=>{let{children:t,id:n,className:r}=e,l=(0,i.Z)("tabs");return(0,a.jsx)(s.VY,{value:n,className:[l.content,r].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Panel","data-sentry-source-file":"Tabs.tsx",children:t})},t.Z=l}}]);